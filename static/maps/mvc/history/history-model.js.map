{"version":3,"sources":["../../../src/mvc/history/history-model.js"],"names":["define","HISTORY_CONTENTS","HISTORY_PREFS","CONTROLLED_FETCH_COLLECTION","UTILS","BASE_MVC","_l","History","Backbone","Model","extend","LoggableMixin","mixin","SearchableModelMixin","_logNamespace","UPDATE_DELAY","defaults","model_class","id","name","state","deleted","contents_active","contents_states","urlRoot","Galaxy","root","contentsClass","HistoryContents","searchAttributes","searchAliases","title","tag","initialize","historyJSON","options","this","logger","log","contents","history","historyId","get","order","_setUpListeners","_setUpCollectionListeners","updateTimeoutId","on","error","model","xhr","msg","details","clearUpdateTimeout","change:id","newId","listenTo","trigger","apply","jQuery","makeArray","arguments","contentsShown","contentsActive","shown","active","includeDeleted","includeHidden","hidden","nice_size","size","bytesToString","toJSON","_","prototype","call","key","ownedByCurrUser","user","isAnonymous","numOfUnfinishedJobs","unfinishedJobIds","length","numOfUnfinishedShownContents","runningAndActive","_fetchContentRelatedAttributes","contentRelatedAttrs","fetch","data","$","param","keys","join","refresh","self","lastUpdateTime","allFetched","fetchFn","currentPage","fetchPage","fetchUpdated","done","response","status","serverResponseDatetime","Date","getResponseHeader","err","checkForUpdates","_delayThenUpdate","setTimeout","delay","nonReadyContentCount","historyData","clearTimeout","parse","parsed","create_time","update_time","fetchWithContents","contentsOptions","view","then","setHistoryId","fetchContents","fetchCurrentPage","_delete","when","save","purge","purged","undelete","copy","current","allDatasets","undefined","Error","postData","history_id","all_datasets","post","newHistory","setAsCurrent","getJSON","toString","_collectionSuper","InfinitelyScrollingCollection","HistoryCollection","limitOnFirstFetch","limitPerFetch","models","currentHistoryId","setUpListeners","url","change:deleted","debug","remove","copied","original","newData","setCurrent","set-as-current","oldCurrentId","_buildFetchData","_buildFetchFilters","superFilters","filters","fetchFirst","silent","limit","encoded_id-in","offset","fetchMore","comparators","clone","buildComparator","ascending","name-dsc","size-asc","sort","currentHistory","unshift","create","hdas","historyOptions","xhrOptions","collection"],"mappings":"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","file":"history-model.js"}