define(["mvc/base-mvc","utils/localization","mvc/history/history-model","libs/d3","libs/plotly"],function(a,b,c,d,e){"use strict";var f=Backbone.View.extend({initialize:function(){var a=this;this.setElement("<div/>"),this.model=new c.HistoryCollection(null,{includeDeleted:!0}),this.model.fetch({success:function(){a.render()},error:function(){console.error("Failed to fetch usage information.")}})},render:function(){var a=_.template(["<h2>Galaxy Quota Usage</h2>","<p>Really descriptive text about the display you'll see below!</p>","<p>Might even include a summary of deleted vs purged, etc.</p>"].join(""));this.$el.html(a({histories:this.model.models}));var b=$("<div/>").attr("id","historyTreeview");$(this.$el).append(b);var c=[],f=d.scale.category20c(),g=d.interpolateRgb("#808080","#E0E0E0");_.each(this.model.models,function(a){if(a.attributes.size>0){var b={name:a.attributes.name,value:a.attributes.size,history:a};b.color=a.attributes.deleted===!0?g(Math.random()):f(a.attributes.name),c.push(b)}});var h={name:"tree",children:c},i=d.layout.treemap().size([400,400]).nodes(h),j=[],k=[],l=[],m=[],n=[];_.each(i,function(a){if(void 0!==a.history){var b=a.x+a.dx/2,c=a.y+a.dy/2,d={type:"rect",x0:a.x,y0:a.y,x1:a.x+a.dx,y1:a.y+a.dy,line:{width:2},fillcolor:a.color};j.push(d);var e={x:b,y:c,text:a.history.attributes.name,showarrow:!1};k.push(e),l.push(b),m.push(c),n.push(a.history.attributes.name)}});var o={x:l,y:m,text:n,mode:"text",type:"scatter"},p={autorange:!0,showgrid:!1,zeroline:!1,showline:!1,showticklabels:!1},q={height:700,width:700,shapes:j,hovermode:"closest",annotations:k,xaxis:p,yaxis:p};e.newPlot("historyTreeview",[o],q,{showLink:!1,displayModeBar:!1,showLegend:!1})}});return{UserQuotaGraph:f}});
//# sourceMappingURL=../../../maps/mvc/user/quotagraph.js.map