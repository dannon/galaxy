define("mvc/visualization/chart/views/editor",["exports","mvc/ui/ui-portlet","mvc/ui/ui-misc","utils/utils","mvc/ui/ui-tabs","mvc/visualization/chart/views/groups","mvc/visualization/chart/views/settings","mvc/visualization/chart/views/description"],function(t,e,i,a,s,n,l,o){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(t,"__esModule",{value:!0});var h=r(e),u=r(i),c=r(a),p=r(s),d=r(n),f=r(l),v=r(o);t.default=Backbone.View.extend({initialize:function(t,e){var i=this;this.app=t,this.chart=this.app.chart,this.description=new v.default(this.app),this.message=new u.default.Message({cls:"ui-margin-bottom"}),this.portlet=new h.default.View({icon:"fa-bar-chart-o",title:"Editor",operations:{draw:new u.default.ButtonIcon({icon:"fa-line-chart",tooltip:"Render Visualization",title:"Visualize",onclick:function(){i._drawChart()}}),back:new u.default.ButtonIcon({icon:"fa-caret-left",tooltip:"Return to Viewer",title:"Cancel",onclick:function(){i.app.go("viewer"),i.chart.load()}})}}),this.title=new u.default.Input({placeholder:"Chart title",onchange:function(){i.chart.set("title",i.title.value())}}),this.tabs=new p.default.View({}),this.tabs.add({id:"settings",title:"Customize",icon:"fa fa-bars",tooltip:"Start by selecting a visualization.",$el:$("<div/>").append(this.description.$el).append(new u.default.Label({title:"Provide a title:"}).$el).append(this.title.$el).append($("<div/>").addClass("ui-form-info ui-margin-bottom").html("This title will appear in the list of 'Saved Visualizations'.")).append(new f.default(this.app).$el)}),this.tabs.add({id:"groups",title:"Select data",icon:"fa-database",tooltip:"Specify data options.",$el:new d.default(this.app).$el}),this.portlet.append(this.message.$el),this.portlet.append(this.tabs.$el.addClass("ui-margin-top-large")),this.portlet.hideOperation("back"),this.setElement(this.portlet.$el),this.listenTo(this.chart,"change:title",function(t){i._refreshTitle()}),this.listenTo(this.chart,"redraw",function(t){i.portlet.showOperation("back")}),this.chart.reset()},show:function(){this.$el.show()},hide:function(){this.$el.hide()},_refreshTitle:function(){var t=this.chart.get("title");this.portlet.title(t),this.title.value(t)},_drawChart:function(){var t=this;if(this.chart.set({type:this.types.value(),title:this.title.value(),date:c.default.time()}),0==this.chart.groups.length)return this.message.update({message:"Please specify data options before rendering the visualization.",persistent:!1}),void this.tabs.show("groups");var e=!0;this.chart.definition;this.chart.groups.each(function(i){e&&_.each(i.get("__data_columns"),function(a,s){null===i.attributes[s]&&(t.message.update({status:"danger",message:"This visualization type requires column types not found in your tabular file.",persistent:!1}),t.tabs.show("groups"),e=!1)})}),e&&(this.app.go("viewer"),this.app.deferred.execute(function(){t.chart.trigger("redraw")}))}})});