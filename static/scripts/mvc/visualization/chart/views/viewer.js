define("mvc/visualization/chart/views/viewer",["exports","mvc/ui/ui-portlet","mvc/ui/ui-misc","utils/utils","mvc/visualization/chart/views/viewport","mvc/visualization/chart/components/screenshot"],function(t,e,i,a,o,n){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(t,"__esModule",{value:!0});var r=s(e),u=s(i),c=(s(a),s(o)),l=s(n);t.default=Backbone.View.extend({initialize:function(t,e){var i=this;this.app=t,this.chart=this.app.chart,this.viewport=new c.default(t),this.message=new u.default.Message,this.export_button=new u.default.ButtonMenu({icon:"fa-camera",title:"Export",tooltip:"Export/Download Visualization"}),this.export_button.addMenu({key:"png",title:"Save as PNG",icon:"fa-file",onclick:function(){i._wait(i.chart,function(){l.default.createPNG({$el:i.viewport.$el,title:i.chart.get("title"),error:function(t){i.message.update({message:t,status:"danger"})}})})}}),this.export_button.addMenu({key:"svg",title:"Save as SVG",icon:"fa-file-text-o",onclick:function(){i._wait(i.chart,function(){l.default.createSVG({$el:i.viewport.$el,title:i.chart.get("title"),error:function(t){i.message.update({message:t,status:"danger"})}})})}}),this.export_button.addMenu({key:"pdf",title:"Save as PDF",icon:"fa-file-o",onclick:function(){i.app.modal.show({title:"Send visualization data for PDF creation",body:"Galaxy does not provide integrated PDF export scripts. You may click 'Continue' to create the PDF by using a 3rd party service (https://export.highcharts.com).",buttons:{Cancel:function(){i.app.modal.hide()},Continue:function(){i.app.modal.hide(),i._wait(i.chart,function(){l.default.createPDF({$el:i.viewport.$el,title:i.chart.get("title"),error:function(t){i.message.update({message:t,status:"danger"})}})})}}})}}),this.portlet=new r.default.View({icon:"fa-bar-chart-o",title:"Viewport",cls:"ui-portlet charts-viewer",operations:{edit_button:new u.default.ButtonIcon({icon:"fa-edit",tooltip:"Customize this Visualization",title:"Editor",onclick:function(){i._wait(i.chart,function(){i.app.go("editor")})}}),export_button:this.export_button,save_button:new u.default.ButtonIcon({icon:"fa-save",tooltip:"Save this Visualization",title:"Save",onclick:function(){i.message.update({message:"Saving '"+i.chart.get("title")+"'. It will appear in the list of 'Saved Visualizations'.",status:"success"}),i.chart.save({error:function(){i.message.update({message:"Could not save visualization.",status:"danger"})}})}})}}),this.portlet.append(this.message.$el),this.portlet.append(this.viewport.$el.addClass("ui-margin-top")),this.setElement(this.portlet.$el),this.listenTo(this.chart,"change",function(){i.render()})},show:function(){this.$el.show(),$(window).trigger("resize")},hide:function(){this.$el.hide()},render:function(){var t=this.chart.get("title");this.portlet.title(t);var e=this.chart.plugin&&this.chart.plugin.exports||[];this.export_button.collection.each(function(t){t.set("visible",-1!==e.indexOf(t.get("key")))})},_wait:function(t,e){this.app.deferred.ready()?e():this.message.update({message:"Your visualization is currently being processed. Please wait and try again."})}})});