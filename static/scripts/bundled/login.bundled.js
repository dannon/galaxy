webpackJsonp([3],[,,,,,function(t,e,i){"use strict";(function(t){function n(t){return t&&t.__esModule?t:{default:t}}function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function a(t,e){var i=Array.prototype.slice.call(arguments,0),n=i.pop();return i.unshift(n),c.defaults.apply(c,i)}function o(t,e){e=e||"model";var i=c.template(t.join(""));return function(t,n){var r={view:n||{},_l:_.default};return r[e]=t||{},i(r)}}function s(t,e){e=e||{};var i=e.ascending?1:-1;return function(e,n){return e=e.get(t),n=n.get(t),(e<n?-1:e>n?1:0)*i}}Object.defineProperty(e,"__esModule",{value:!0});var l=i(1),c=r(l),u=i(2),d=r(u),h=i(26),f=n(h),p=i(3),_=n(p),m={logger:null,_logNamespace:"."};(0,f.default)(m);var g=d.Model.extend({initialize:function(t){if(this._checkEnabledSessionStorage(),!t.id)throw new Error("SessionStorageModel requires an id in the initial attributes");this.id=t.id;var e=this.isNew()?{}:this._read(this);this.clear({silent:!0}),this.save(c.extend({},this.defaults,e,t),{silent:!0}),this.on("change",function(){this.save()})},_checkEnabledSessionStorage:function(){try{return window.sessionStorage.length>=0}catch(t){return alert("Please enable cookies in your browser for this Galaxy site"),!1}},sync:function(t,e,i){i.silent||e.trigger("request",e,{},i);var n={};switch(t){case"create":n=this._create(e);break;case"read":n=this._read(e);break;case"update":n=this._update(e);break;case"delete":n=this._delete(e)}return void 0!==n||null!==n?i.success&&i.success():i.error&&i.error(),n},_create:function(t){try{var e=t.toJSON(),i=sessionStorage.setItem(t.id,JSON.stringify(e));return null===i?i:e}catch(t){if(!(t instanceof DOMException&&navigator.userAgent.indexOf("Safari")>-1))throw t}return null},_read:function(t){return JSON.parse(sessionStorage.getItem(t.id))},_update:function(t){return t._create(t)},_delete:function(t){return sessionStorage.removeItem(t.id)},isNew:function(){return!sessionStorage.hasOwnProperty(this.id)},_log:function(){return JSON.stringify(this.toJSON(),null,"  ")},toString:function(){return"SessionStorageModel("+this.id+")"}});!function(){g.prototype=c.omit(g.prototype,"url","urlRoot")}();var v={searchAttributes:[],searchAliases:{},searchAttribute:function(t,e){var i=this.get(t);return!(!e||void 0===i||null===i)&&(c.isArray(i)?this._searchArrayAttribute(i,e):-1!==i.toString().toLowerCase().indexOf(e.toLowerCase()))},_searchArrayAttribute:function(t,e){return e=e.toLowerCase(),c.any(t,function(t){return-1!==t.toString().toLowerCase().indexOf(e.toLowerCase())})},search:function(t){var e=this;return c.filter(this.searchAttributes,function(i){return e.searchAttribute(i,t)})},matches:function(t){var e=t.split("=");if(e.length>=2){var i=e[0];return i=this.searchAliases[i]||i,this.searchAttribute(i,e[1])}return!!this.search(t).length},matchesAll:function(t){var e=this;return t=t.match(/(".*"|\w*=".*"|\S*)/g).filter(function(t){return!!t}),c.all(t,function(t){return t=t.replace(/"/g,""),e.matches(t)})}},w={hiddenUntilActivated:function(e,i){if(i=i||{},this.HUAVOptions={$elementShown:this.$el,showFn:t.prototype.toggle,showSpeed:"fast"},c.extend(this.HUAVOptions,i||{}),this.HUAVOptions.hasBeenShown=this.HUAVOptions.$elementShown.is(":visible"),this.hidden=this.isHidden(),e){var n=this;e.on("click",function(t){n.toggle(n.HUAVOptions.showSpeed)})}},isHidden:function(){return this.HUAVOptions.$elementShown.is(":hidden")},toggle:function(){return this.hidden?(this.HUAVOptions.hasBeenShown||c.isFunction(this.HUAVOptions.onshowFirstTime)&&(this.HUAVOptions.hasBeenShown=!0,this.HUAVOptions.onshowFirstTime.call(this)),c.isFunction(this.HUAVOptions.onshow)&&(this.HUAVOptions.onshow.call(this),this.trigger("hiddenUntilActivated:shown",this)),this.hidden=!1):(c.isFunction(this.HUAVOptions.onhide)&&(this.HUAVOptions.onhide.call(this),this.trigger("hiddenUntilActivated:hidden",this)),this.hidden=!0),this.HUAVOptions.showFn.apply(this.HUAVOptions.$elementShown,arguments)}},y={initialize:function(t){this.draggable=t.draggable||!1},$dragHandle:function(){return this.$(".title-bar")},toggleDraggable:function(){this.draggable?this.draggableOff():this.draggableOn()},draggableOn:function(){this.draggable=!0,this.dragStartHandler=c.bind(this._dragStartHandler,this),this.dragEndHandler=c.bind(this._dragEndHandler,this);var t=this.$dragHandle().attr("draggable",!0).get(0);t.addEventListener("dragstart",this.dragStartHandler,!1),t.addEventListener("dragend",this.dragEndHandler,!1)},draggableOff:function(){this.draggable=!1;var t=this.$dragHandle().attr("draggable",!1).get(0);t.removeEventListener("dragstart",this.dragStartHandler,!1),t.removeEventListener("dragend",this.dragEndHandler,!1)},_dragStartHandler:function(t){return t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text",JSON.stringify(this.model.toJSON())),this.trigger("draggable:dragstart",t,this),!1},_dragEndHandler:function(t){return this.trigger("draggable:dragend",t,this),!1}},b={initialize:function(t){this.selectable=t.selectable||!1,this.selected=t.selected||!1},$selector:function(){return this.$(".selector")},_renderSelected:function(){this.$selector().find("span").toggleClass("fa-check-square-o",this.selected).toggleClass("fa-square-o",!this.selected)},toggleSelector:function(){this.$selector().is(":visible")?this.hideSelector():this.showSelector()},showSelector:function(t){t=void 0!==t?t:this.fxSpeed,this.selectable=!0,this.trigger("selectable",!0,this),this._renderSelected(),t?this.$selector().show(t):this.$selector().show()},hideSelector:function(t){t=void 0!==t?t:this.fxSpeed,this.selectable=!1,this.trigger("selectable",!1,this),t?this.$selector().hide(t):this.$selector().hide()},toggleSelect:function(t){this.selected?this.deselect(t):this.select(t)},select:function(t){return this.selected||(this.trigger("selected",this,t),this.selected=!0,this._renderSelected()),!1},deselect:function(t){return this.selected&&(this.trigger("de-selected",this,t),this.selected=!1,this._renderSelected()),!1}};e.default={LoggableMixin:m,SessionStorageModel:g,mixin:a,SearchableModelMixin:v,HiddenUntilActivatedViewMixin:w,DraggableViewMixin:y,SelectableViewMixin:b,wrapTemplate:o,buildComparator:s}}).call(e,i(0))},function(t,e,i){"use strict";function n(t){return"[object Array]"===C.call(t)}function r(t){return"[object ArrayBuffer]"===C.call(t)}function a(t){return"undefined"!=typeof FormData&&t instanceof FormData}function o(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer}function s(t){return"string"==typeof t}function l(t){return"number"==typeof t}function c(t){return void 0===t}function u(t){return null!==t&&"object"==typeof t}function d(t){return"[object Date]"===C.call(t)}function h(t){return"[object File]"===C.call(t)}function f(t){return"[object Blob]"===C.call(t)}function p(t){return"[object Function]"===C.call(t)}function _(t){return u(t)&&p(t.pipe)}function m(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams}function g(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")}function v(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)}function w(t,e){if(null!==t&&void 0!==t)if("object"==typeof t||n(t)||(t=[t]),n(t))for(var i=0,r=t.length;i<r;i++)e.call(null,t[i],i,t);else for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.call(null,t[a],a,t)}function y(){function t(t,i){"object"==typeof e[i]&&"object"==typeof t?e[i]=y(e[i],t):e[i]=t}for(var e={},i=0,n=arguments.length;i<n;i++)w(arguments[i],t);return e}function b(t,e,i){return w(e,function(e,n){t[n]=i&&"function"==typeof e?x(e,i):e}),t}var x=i(31),k=i(83),C=Object.prototype.toString;t.exports={isArray:n,isArrayBuffer:r,isBuffer:k,isFormData:a,isArrayBufferView:o,isString:s,isNumber:l,isObject:u,isUndefined:c,isDate:d,isFile:h,isBlob:f,isFunction:p,isStream:_,isURLSearchParams:m,isStandardBrowserEnv:v,forEach:w,merge:y,extend:b,trim:g}},,function(t,e,i){"use strict";function n(t,e){return function(i){if(t.hasOwnProperty(i))return t[i];if(!e)throw new Error("I do not know how to modify the following string: "+i+". Change your TeX file or submit a feature request at https://github.com/digitalheir/tex-to-unicode/issues.");return i+e}}Object.defineProperty(e,"__esModule",{value:!0}),e.lookupOrAppend=n},function(t,e,i){"use strict";function n(t){return"("+t+")"}Object.defineProperty(e,"__esModule",{value:!0}),e.simpleSuffix=function(t){return function(e){return e+t}},e.isSingleTerm=/^.$|^[0-9]+$/,e.addParenthesis=n},function(t,e,i){"use strict";(function(t,n,r){function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(3),s=a(o),l=i(24),c=a(l),u=t.Model.extend({}),d=t.Model.extend({defaults:{id:"",type:"",name:"",hda_ldda:"hda",metadata:null},initialize:function(){this.get("metadata")||this._set_metadata(),this.on("change",this._set_metadata,this)},_set_metadata:function(){var t=new u;n.each(n.keys(this.attributes),function(e){if(0===e.indexOf("metadata_")){var i=e.split("metadata_")[1];t.set(i,this.attributes[e]),delete this.attributes[e]}},this),this.set("metadata",t,{silent:!0})},get_metadata:function(t){return this.attributes.metadata.get(t)},urlRoot:Galaxy.root+"api/datasets"}),h=d.extend({defaults:n.extend({},d.prototype.defaults,{chunk_url:null,first_data_chunk:null,offset:0,at_eof:!1}),initialize:function(t){d.prototype.initialize.call(this),this.attributes.first_data_chunk&&(this.attributes.offset=this.attributes.first_data_chunk.offset),this.attributes.chunk_url=Galaxy.root+"dataset/display?dataset_id="+this.id,this.attributes.url_viz=Galaxy.root+"visualization"},get_next_chunk:function(){if(this.attributes.at_eof)return null;var t=this,e=r.Deferred();return r.getJSON(this.attributes.chunk_url,{offset:t.attributes.offset}).success(function(i){var n;""!==i.ck_data?(n=i,t.attributes.offset=i.offset):(t.attributes.at_eof=!0,n=null),e.resolve(n)}),e}}),f=t.Collection.extend({model:d}),p=t.View.extend({initialize:function(t){this.row_count=0,this.loading_chunk=!1,new g({model:t.model,$el:this.$el})},expand_to_container:function(){this.$el.height()<this.scroll_elt.height()&&this.attempt_to_fetch()},attempt_to_fetch:function(t){var e=this;!this.loading_chunk&&this.scrolled_to_bottom()&&(this.loading_chunk=!0,this.loading_indicator.show(),r.when(e.model.get_next_chunk()).then(function(t){t&&(e._renderChunk(t),e.loading_chunk=!1),e.loading_indicator.hide(),e.expand_to_container()}))},render:function(){this.loading_indicator=r("<div/>").attr("id","loading_indicator"),this.$el.append(this.loading_indicator);var t=r("<table/>").attr({id:"content_table",cellpadding:0});this.$el.append(t);var e=this.model.get_metadata("column_names"),i=r("<thead/>").appendTo(t),n=r("<tr/>").appendTo(i);if(e)n.append("<th>"+e.join("</th><th>")+"</th>");else for(var a=1;a<=this.model.get_metadata("columns");a++)n.append("<th>"+a+"</th>");var o=this,s=this.model.get("first_data_chunk");s?this._renderChunk(s):r.when(o.model.get_next_chunk()).then(function(t){o._renderChunk(t)}),this.scroll_elt.scroll(function(){o.attempt_to_fetch()})},scrolled_to_bottom:function(){return!1},_renderCell:function(t,e,i){var n=r("<td>").text(t),a=this.model.get_metadata("column_types");return void 0!==i?n.attr("colspan",i).addClass("stringalign"):a&&e<a.length&&("str"!==a[e]&&"list"!==a[e]||n.addClass("stringalign")),n},_renderRow:function(t){var e=t.split("\t"),i=r("<tr>"),a=this.model.get_metadata("columns");return this.row_count%2!=0&&i.addClass("dark_row"),e.length===a?n.each(e,function(t,e){i.append(this._renderCell(t,e))},this):e.length>a?(n.each(e.slice(0,a-1),function(t,e){i.append(this._renderCell(t,e))},this),i.append(this._renderCell(e.slice(a-1).join("\t"),a-1))):1===e.length?i.append(this._renderCell(t,0,a)):(n.each(e,function(t,e){i.append(this._renderCell(t,e))},this),n.each(n.range(a-e.length),function(){i.append(r("<td>"))})),this.row_count++,i},_renderChunk:function(t){var e=this.$el.find("table");n.each(t.ck_data.split("\n"),function(t,i){""!==t&&e.append(this._renderRow(t))},this)}}),_=p.extend({initialize:function(t){p.prototype.initialize.call(this,t);var e=n.find(this.$el.parents(),function(t){return"auto"===r(t).css("overflow")});e||(e=window),this.scroll_elt=r(e)},scrolled_to_bottom:function(){return this.$el.height()-this.scroll_elt.scrollTop()-this.scroll_elt.height()<=0}}),m=p.extend({initialize:function(t){p.prototype.initialize.call(this,t),this.scroll_elt=this.$el.css({position:"relative",overflow:"scroll",height:t.height||"500px"})},scrolled_to_bottom:function(){return this.$el.scrollTop()+this.$el.innerHeight()>=this.el.scrollHeight}}),g=t.View.extend({col:{chrom:null,start:null,end:null},url_viz:null,dataset_id:null,genome_build:null,file_ext:null,initialize:function(t){var e=parent.Galaxy;if(e&&e.modal&&(this.modal=e.modal),e&&e.frame&&(this.frame=e.frame),this.modal&&this.frame){var i=t.model,n=i.get("metadata");if(i.get("file_ext")){if(this.file_ext=i.get("file_ext"),"bed"==this.file_ext){if(!(n.get("chromCol")&&n.get("startCol")&&n.get("endCol")))return void console.log("TabularButtonTrackster : Bed-file metadata incomplete.");this.col.chrom=n.get("chromCol")-1,this.col.start=n.get("startCol")-1,this.col.end=n.get("endCol")-1}if("vcf"==this.file_ext){var r=function(t,e){for(var i=0;i<e.length;i++)if(e[i].match(t))return i;return-1};if(this.col.chrom=r("Chrom",n.get("column_names")),this.col.start=r("Pos",n.get("column_names")),this.col.end=null,-1==this.col.chrom||-1==this.col.start)return void console.log("TabularButtonTrackster : VCF-file metadata incomplete.")}if(void 0!==this.col.chrom){if(!i.id)return void console.log("TabularButtonTrackster : Dataset identification is missing.");if(this.dataset_id=i.id,!i.get("url_viz"))return void console.log("TabularButtonTrackster : Url for visualization controller is missing.");this.url_viz=i.get("url_viz"),i.get("genome_build")&&(this.genome_build=i.get("genome_build"));var a=new c.default.IconButtonView({model:new c.default.IconButton({title:(0,s.default)("Visualize"),icon_class:"chart_curve",id:"btn_viz"})});this.setElement(t.$el),this.$el.append(a.render().$el),this.hide()}}}},events:{"mouseover tr":"show",mouseleave:"hide"},show:function(t){var e=this;if(null!==this.col.chrom){var i=r(t.target).parent(),n=i.children().eq(this.col.chrom).html(),a=i.children().eq(this.col.start).html(),o=this.col.end?i.children().eq(this.col.end).html():a;if(!n.match("^#")&&""!==n&&function(t){return!isNaN(parseFloat(t))&&isFinite(t)}(a)){var l={dataset_id:this.dataset_id,gene_region:n+":"+a+"-"+o},c=i.offset(),u=c.left-10,d=c.top-r(window).scrollTop()+3;r("#btn_viz").css({position:"fixed",top:d+"px",left:u+"px"}),r("#btn_viz").off("click"),r("#btn_viz").click(function(){e.frame.add({title:(0,s.default)("Trackster"),url:e.url_viz+"/trackster?"+r.param(l)})}),r("#btn_viz").show()}else r("#btn_viz").hide()}},hide:function(){this.$("#btn_viz").hide()}}),v=function(t){t.model||(t.model=new h(t.dataset_config));var e=t.parent_elt,i=t.embedded;delete t.embedded,delete t.parent_elt,delete t.dataset_config;var n=i?new m(t):new _(t);return n.render(),e&&(e.append(n.$el),n.expand_to_container()),n};e.default={Dataset:d,TabularDataset:h,DatasetCollection:f,TabularDatasetChunkedView:p,createTabularDatasetChunkedView:v}}).call(e,i(2),i(1),i(0))},function(t,e,i){"use strict";(function(t,n){function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=i(3),o=r(a),s=i(1),l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(s),c=i(10),u=r(c),d=i(13),h=r(d),f=i(15),p=r(f),_=i(17),m=r(_),g=i(55),v=r(g),w=i(7),y=(r(w),{toJSON:function(){var t=this,e={};return l.each(t.constructor.to_json_keys,function(i){var n=t.get(i);i in t.constructor.to_json_mappers&&(n=t.constructor.to_json_mappers[i](n,t)),e[i]=n}),e}}),b=function(e,i){var n=new m.default({url_base:Galaxy.root+"visualization/list_history_datasets",filters:e,embedded:!0}),r=new m.default({url_base:Galaxy.root+"visualization/list_library_datasets",embedded:!0}),a=new v.default.View;a.add({id:"histories",title:(0,o.default)("Histories"),$el:t("<div/>").append(n.$el)}),a.add({id:"libraries",title:(0,o.default)("Libraries"),$el:t("<div/>").append(r.$el)}),Galaxy.modal.show({title:(0,o.default)("Select datasets for new tracks"),body:a.$el,closing_events:!0,buttons:{Cancel:function(){Galaxy.modal.hide()},Add:function(){var e=[];a.$("input.grid-row-select-checkbox[name=id]:checked").each(function(){window.console.log(t(this).val()),e[e.length]=t.ajax({url:Galaxy.root+"api/datasets/"+t(this).val(),dataType:"json",data:{data_type:"track_config",hda_ldda:"histories"==a.current()?"hda":"ldda"}})}),t.when.apply(t,e).then(function(){var e=arguments[0]instanceof Array?t.map(arguments,function(t){return t[0]}):[arguments[0]];i(e)}),Galaxy.modal.hide()}}})},x=function(t){this.default_font=void 0!==t?t:"9px Monaco, Lucida Console, monospace",this.dummy_canvas=this.new_canvas(),this.dummy_context=this.dummy_canvas.getContext("2d"),this.dummy_context.font=this.default_font,this.char_width_px=this.dummy_context.measureText("A").width,this.patterns={},this.load_pattern("right_strand","/visualization/strand_right.png"),this.load_pattern("left_strand","/visualization/strand_left.png"),this.load_pattern("right_strand_inv","/visualization/strand_right_inv.png"),this.load_pattern("left_strand_inv","/visualization/strand_left_inv.png")};l.extend(x.prototype,{load_pattern:function(t,e){var i=this.patterns,n=this.dummy_context,r=new Image;r.src=Galaxy.root+"static/images"+e,r.onload=function(){i[t]=n.createPattern(r,"repeat")}},get_pattern:function(t){return this.patterns[t]},new_canvas:function(){var e=t("<canvas/>")[0];return e.manager=this,e}});var k=n.Model.extend({defaults:{num_elements:20,obj_cache:null,key_ary:null},initialize:function(t){this.clear()},get_elt:function(t){var e=this.attributes.obj_cache,i=this.attributes.key_ary,n=t.toString(),r=l.indexOf(i,function(t){return t.toString()===n});return-1!==r&&(e[n].stale?(i.splice(r,1),delete e[n]):this.move_key_to_end(t,r)),e[n]},set_elt:function(t,e){var i=this.attributes.obj_cache,n=this.attributes.key_ary,r=t.toString(),a=this.attributes.num_elements;if(!i[r]){if(n.length>=a){delete i[n.shift().toString()]}n.push(t)}return i[r]=e,e},move_key_to_end:function(t,e){this.attributes.key_ary.splice(e,1),this.attributes.key_ary.push(t)},clear:function(){this.attributes.obj_cache={},this.attributes.key_ary=[]},size:function(){return this.attributes.key_ary.length},most_recently_added:function(){return 0===this.size()?null:this.attributes.key_ary[this.attributes.key_ary.length-1]}}),C=k.extend({defaults:l.extend({},k.prototype.defaults,{dataset:null,genome:null,init_data:null,min_region_size:200,filters_manager:null,data_type:"data",data_mode_compatible:function(t,e){return!0},can_subset:function(t){return!1}}),initialize:function(t){k.prototype.initialize.call(this);var e=this.get("init_data");e&&this.add_data(e)},add_data:function(t){this.get("num_elements")<t.length&&this.set("num_elements",t.length);var e=this;l.each(t,function(t){e.set_data(t.region,t)})},data_is_ready:function(){var e=this.get("dataset"),i=t.Deferred(),n="raw_data"===this.get("data_type")?"state":"data"===this.get("data_type")?"converted_datasets_state":"error",r=new h.default.ServerStateDeferred({ajax_settings:{url:this.get("dataset").url(),data:{hda_ldda:e.get("hda_ldda"),data_type:n},dataType:"json"},interval:5e3,success_fn:function(t){return"pending"!==t}});return t.when(r.go()).then(function(t){i.resolve("ok"===t||"data"===t)}),i},search_features:function(e){var i=this.get("dataset"),n={query:e,hda_ldda:i.get("hda_ldda"),data_type:"features"};return t.getJSON(i.url(),n)},load_data:function(e,i,n,r){var a=this.get("dataset"),o={data_type:this.get("data_type"),chrom:e.get("chrom"),low:e.get("start"),high:e.get("end"),mode:i,resolution:n,hda_ldda:a.get("hda_ldda")};t.extend(o,r);var s=this.get("filters_manager");if(s){for(var l=[],c=s.filters,u=0;u<c.length;u++)l.push(c[u].name);o.filter_cols=JSON.stringify(l)}var d=this,h=t.getJSON(a.url(),o,function(t){t.region=e,d.set_data(e,t)});return this.set_data(e,h),h},get_data:function(t,e,i,n){var r=this.get_elt(t);if(r&&(h.default.is_deferred(r)||this.get("data_mode_compatible")(r,e)))return r;for(var a,o,s=this.get("key_ary"),l=this.get("obj_cache"),c=0;c<s.length;c++)if(a=s[c],a.contains(t)&&(o=!0,r=l[a.toString()],h.default.is_deferred(r)||this.get("data_mode_compatible")(r,e)&&this.get("can_subset")(r))){if(this.move_key_to_end(a,c),!h.default.is_deferred(r)){var u=this.subset_entry(r,t);this.set_data(t,u),r=u}return r}if(!o&&t.length()<this.attributes.min_region_size){t=t.copy();var d=this.most_recently_added();!d||t.get("start")>d.get("start")?t.set("end",t.get("start")+this.attributes.min_region_size):t.set("start",t.get("end")-this.attributes.min_region_size),t.set("genome",this.attributes.genome),t.trim()}return this.load_data(t,e,i,n)},set_data:function(t,e){this.set_elt(t,e)},DEEP_DATA_REQ:"deep",BROAD_DATA_REQ:"breadth",get_more_data:function(e,i,n,r,a){var o=this._mark_stale(e);if(!o||!this.get("data_mode_compatible")(o,i))return void console.log("ERROR: problem with getting more data: current data is not compatible");var s=e.get("start");a===this.DEEP_DATA_REQ?t.extend(r,{start_val:o.data.length+1}):a===this.BROAD_DATA_REQ&&(s=(o.max_high?o.max_high:o.data[o.data.length-1][2])+1);var l=e.copy().set("start",s),c=this,u=this.load_data(l,i,n,r),d=t.Deferred();return this.set_data(e,d),t.when(u).then(function(t){t.data&&(t.data=o.data.concat(t.data),t.max_low&&(t.max_low=o.max_low),t.message&&(t.message=t.message.replace(/[0-9]+/,t.data.length))),c.set_data(e,t),d.resolve(t)}),d},can_get_more_detailed_data:function(t){var e=this.get_elt(t);return"bigwig"===e.dataset_type&&e.data.length<8e3},get_more_detailed_data:function(t,e,i,n,r){var a=this._mark_stale(t);return a?(r||(r={}),"bigwig"===a.dataset_type&&(r.num_samples=1e3*n),this.load_data(t,e,i,r)):void console.log("ERROR getting more detailed data: no current data")},_mark_stale:function(t){var e=this.get_elt(t);return e||console.log("ERROR: no data to mark as stale: ",this.get("dataset"),t.toString()),e.stale=!0,e},get_genome_wide_data:function(e){var i=this,n=!0,r=l.map(e.get("chroms_info").chrom_info,function(t){var e=i.get_elt(new M({chrom:t.chrom,start:0,end:t.len}));return e||(n=!1),e});if(n)return r;var a=t.Deferred();return t.getJSON(this.get("dataset").url(),{data_type:"genome_data"},function(t){i.add_data(t.data),a.resolve(t.data)}),a},subset_entry:function(t,e){var i={bigwig:function(t,e){return l.filter(t,function(t){return t[0]>=e.get("start")&&t[0]<=e.get("end")})},refseq:function(e,i){var n=i.get("start")-t.region.get("start");return t.data.slice(n,n+i.length())}},n=t.data;return!t.region.same(e)&&t.dataset_type in i&&(n=i[t.dataset_type](t.data,e)),{region:e,data:n,dataset_type:t.dataset_type}}}),S=C.extend({initialize:function(t){var e=new n.Model;e.urlRoot=t.data_url,this.set("dataset",e)},load_data:function(t,e,i,n){return t.length()<=1e5?C.prototype.load_data.call(this,t,e,i,n):{data:null,region:t}}}),T=n.Model.extend({defaults:{name:null,key:null,chroms_info:null},initialize:function(t){this.id=t.dbkey},get_chroms_info:function(){return this.attributes.chroms_info.chrom_info},get_chrom_region:function(t){var e=l.find(this.get_chroms_info(),function(e){return e.chrom===t});return new M({chrom:e.chrom,end:e.len})},get_chrom_len:function(t){return l.find(this.get_chroms_info(),function(e){return e.chrom===t}).len}}),M=n.Model.extend({defaults:{chrom:null,start:0,end:0,str_val:null,genome:null},same:function(t){return this.attributes.chrom===t.get("chrom")&&this.attributes.start===t.get("start")&&this.attributes.end===t.get("end")},initialize:function(t){if(t.from_str){var e=t.from_str.split(":"),i=e[0],n=e[1].split("-");this.set({chrom:i,start:parseInt(n[0],10),end:parseInt(n[1],10)})}this.attributes.str_val=this.get("chrom")+":"+this.get("start")+"-"+this.get("end"),this.on("change",function(){this.attributes.str_val=this.get("chrom")+":"+this.get("start")+"-"+this.get("end")},this)},copy:function(){return new M({chrom:this.get("chrom"),start:this.get("start"),end:this.get("end")})},length:function(){return this.get("end")-this.get("start")},toString:function(){return this.attributes.str_val},toJSON:function(){return{chrom:this.get("chrom"),start:this.get("start"),end:this.get("end")}},compute_overlap:function(t){var e=this.get("chrom"),i=t.get("chrom"),n=this.get("start"),r=t.get("start"),a=this.get("end"),o=t.get("end");return e&&i&&e!==i?M.overlap_results.DIF_CHROMS:n<r?a<r?M.overlap_results.BEFORE:a<o?M.overlap_results.OVERLAP_START:M.overlap_results.CONTAINS:n>r?n>o?M.overlap_results.AFTER:a<=o?M.overlap_results.CONTAINED_BY:M.overlap_results.OVERLAP_END:a>=o?M.overlap_results.CONTAINS:M.overlap_results.CONTAINED_BY},trim:function(t){if(this.attributes.start<0&&(this.attributes.start=0),this.attributes.genome){var e=this.attributes.genome.get_chrom_len(this.attributes.chrom);this.attributes.end>e&&(this.attributes.end=e-1)}return this},contains:function(t){return this.compute_overlap(t)===M.overlap_results.CONTAINS},overlaps:function(t){return 0===l.intersection([this.compute_overlap(t)],[M.overlap_results.DIF_CHROMS,M.overlap_results.BEFORE,M.overlap_results.AFTER]).length}},{overlap_results:{DIF_CHROMS:1e3,BEFORE:1001,CONTAINS:1002,OVERLAP_START:1003,OVERLAP_END:1004,CONTAINED_BY:1005,AFTER:1006}}),O=n.Collection.extend({model:M}),A=n.Model.extend({defaults:{region:null,note:""},initialize:function(t){this.set("region",new M(t.region))}}),R=n.Collection.extend({model:A}),E=n.Model.extend(y).extend({defaults:{mode:"Auto"},initialize:function(t){this.set("dataset",new u.default.Dataset(t.dataset));var e=[{key:"name",default_value:this.get("dataset").get("name")},{key:"color"},{key:"min_value",label:"Min Value",type:"float",default_value:0},{key:"max_value",label:"Max Value",type:"float",default_value:1}];this.set("config",p.default.ConfigSettingCollection.from_models_and_saved_values(e,t.prefs));var i=this.get("preloaded_data");i=i?i.data:[],this.set("data_manager",new C({dataset:this.get("dataset"),init_data:i}))}},{to_json_keys:["track_type","dataset","prefs","mode","filters","tool_state"],to_json_mappers:{prefs:function(t,e){return 0===l.size(t)&&(t={name:e.get("config").get("name").get("value"),color:e.get("config").get("color").get("value")}),t},dataset:function(t){return{id:t.id,hda_ldda:t.get("hda_ldda")}}}}),z=n.Collection.extend({model:E}),P=n.Model.extend({defaults:{title:"",type:""},urlRoot:Galaxy.root+"api/visualizations",save:function(){return t.ajax({url:this.url(),type:"POST",dataType:"json",data:{vis_json:JSON.stringify(this)}})}}),j=P.extend(y).extend({defaults:l.extend({},P.prototype.defaults,{dbkey:"",drawables:null,bookmarks:null,viewport:null}),initialize:function(t){this.set("drawables",new z(t.tracks));var e=[];this.set("config",p.default.ConfigSettingCollection.from_models_and_saved_values(e,t.prefs)),this.unset("tracks"),this.get("drawables").each(function(t){t.unset("preloaded_data")})},add_tracks:function(t){this.get("drawables").add(t)}},{to_json_keys:["view","viewport","bookmarks"],to_json_mappers:{view:function(t,e){return{obj_type:"View",prefs:{name:e.get("title"),content_visible:!0},drawables:e.get("drawables")}}}}),q=n.Router.extend({initialize:function(t){this.view=t.view,this.route(/([\w]+)$/,"change_location"),this.route(/([\w\+]+\:[\d,]+-[\d,]+)$/,"change_location");var e=this;e.view.on("navigate",function(t){e.navigate(t)})},change_location:function(t){this.view.go_to(t)}});e.default={BackboneTrack:E,BrowserBookmark:A,BrowserBookmarkCollection:R,Cache:k,CanvasManager:x,Genome:T,GenomeDataManager:C,GenomeRegion:M,GenomeRegionCollection:O,GenomeVisualization:j,GenomeReferenceDataManager:S,TrackBrowserRouter:q,Visualization:P,select_datasets:b}}).call(e,i(0),i(2))},,function(t,e,i){"use strict";(function(t,i){function n(t){t+="";for(var e=/(\d+)(\d{3})/;e.test(t);)t=t.replace(e,"$1,$2");return t}Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){return"promise"in t},a=t.Model.extend({defaults:{ajax_settings:{},interval:1e3,success_fn:function(t){return!0}},go:function(){var t=i.Deferred(),e=this,n=e.get("ajax_settings"),r=e.get("success_fn"),a=e.get("interval");return function e(){i.ajax(n).success(function(i){r(i)?t.resolve(i):setTimeout(e,a)})}(),t}}),o=function(t){t||(t="#ffffff"),"string"==typeof t&&(t=[t]);for(var e=0;e<t.length;e++)t[e]=parseInt(t[e].slice(1),16);var i,n,r,a,o,s,l,c,u,d,h,f=function(t,e,i){return(299*t+587*e+114*i)/1e3},p=!1,_=0;do{for(i=Math.round(16777215*Math.random()),n=(16711680&i)>>16,r=(65280&i)>>8,a=255&i,u=f(n,r,a),p=!0,e=0;e<t.length;e++)if(o=t[e],s=(16711680&o)>>16,l=(65280&o)>>8,c=255&o,d=f(s,l,c),h=function(t,e,i,n,r,a){return Math.max(t,n)-Math.min(t,n)+(Math.max(e,r)-Math.min(e,r))+(Math.max(i,a)-Math.min(i,a))}(n,r,a,s,l,c),Math.abs(u-d)<40||h<200){p=!1;break}_++}while(!p&&_<=10);return"#"+(16777216+i).toString(16).substr(1,6)};e.default={commatize:n,is_deferred:r,ServerStateDeferred:a,get_random_color:o}}).call(e,i(2),i(0))},function(t,e,i){"use strict";var n=i(0),r=function(t){return t&&t.__esModule?t:{default:t}}(n),a=r.default;a.fn.make_text_editable=function(t){var e="num_cols"in t?t.num_cols:30,i="num_rows"in t?t.num_rows:4,n="use_textarea"in t&&t.use_textarea,r="on_finish"in t?t.on_finish:null,o="help_text"in t?t.help_text:null,s=a(this);return s.addClass("editable-text").click(function(o){if(!(a(this).children(":input").length>0)){s.removeClass("editable-text");var l,c,u=function(t){s.find(":input").remove(),""!==t?s.text(t):s.html("<br>"),s.addClass("editable-text"),r&&r(t)},d="cur_text"in t?t.cur_text:s.text();n?(l=a("<textarea/>").attr({rows:i,cols:e}).text(a.trim(d)).keyup(function(t){27===t.keyCode&&u(d)}),c=a("<button/>").text("Done").click(function(){return u(l.val()),!1})):l=a("<input type='text'/>").attr({value:a.trim(d),size:e}).blur(function(){u(d)}).keyup(function(t){27===t.keyCode?a(this).trigger("blur"):13===t.keyCode&&u(a(this).val()),t.stopPropagation()}),s.text(""),s.append(l),c&&s.append(c),l.focus(),l.select(),o.stopPropagation()}}),o&&s.attr("title",o).tooltip(),s}},function(t,e,i){"use strict";(function(t,n){function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=i(1),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(a),s=i(13),l=r(s),c=i(15),u=(r(c),t.Model.extend({initialize:function(t){var e=this.get("key");this.set("id",e);var i=o.find([{key:"name",label:"Name",type:"text",default_value:""},{key:"color",label:"Color",type:"color",default_value:null},{key:"min_value",label:"Min Value",type:"float",default_value:null},{key:"max_value",label:"Max Value",type:"float",default_value:null},{key:"mode",type:"string",default_value:this.mode,hidden:!0},{key:"height",type:"int",default_value:32,hidden:!0},{key:"pos_color",label:"Positive Color",type:"color",default_value:"#FF8C00"},{key:"neg_color",label:"Negative Color",type:"color",default_value:"#4169E1"},{key:"block_color",label:"Block color",type:"color",default_value:null},{key:"label_color",label:"Label color",type:"color",default_value:"black"},{key:"show_insertions",label:"Show insertions",type:"bool",default_value:!1},{key:"show_counts",label:"Show summary counts",type:"bool",default_value:!0},{key:"reverse_strand_color",label:"Antisense strand color",type:"color",default_value:null},{key:"show_differences",label:"Show differences only",type:"bool",default_value:!0}],function(t){return t.key===e});i&&this.set(o.extend({},i,t)),void 0===this.get("value")&&void 0!==this.get("default_value")&&(this.set_value(this.get("default_value")),this.get("value")||"color"!==this.get("type")||this.set("value",l.default.get_random_color()))},set_value:function(t,e){var i=this.get("type");"float"===i?t=parseFloat(t):"int"===i&&(t=parseInt(t,10)),this.set({value:t},e)}})),d=t.Collection.extend({model:u,to_key_value_dict:function(){var t={};return this.each(function(e){t[e.get("key")]=e.get("value")}),t},get_value:function(t){var e=this.get(t);if(e)return e.get("value")},set_value:function(t,e,i){var n=this.get(t);if(n)return n.set_value(e,i)},set_default_value:function(t,e){var i=this.get(t);if(i)return i.set("default_value",e)}},{from_models_and_saved_values:function(t,e){return e&&(t=o.map(t,function(t){return o.extend({},t,{value:e[t.key]})})),new d(t)}}),h=t.View.extend({className:"config-settings-view",render:function(){var t=this.$el;return this.collection.each(function(e,i){if(!e.get("hidden")){var r="param_"+i,a=e.get("type"),s=e.get("value"),c=n("<div class='form-row' />").appendTo(t);if(c.append(n("<label />").attr("for",r).text(e.get("label")+":")),"bool"===a)c.append(n('<input type="checkbox" />').attr("id",r).attr("name",r).attr("checked",s));else if("text"===a)c.append(n('<input type="text"/>').attr("id",r).val(s).click(function(){n(this).select()}));else if("select"===a){var u=n("<select />").attr("id",r);o.each(e.get("options"),function(t){n("<option/>").text(t.label).attr("value",t.value).appendTo(u)}),u.val(s),c.append(u)}else if("color"===a){var d=n("<div/>").appendTo(c),h=n("<input />").attr("id",r).attr("name",r).val(s).css("float","left").appendTo(d).click(function(t){n(".tooltip").removeClass("in");var e=n(this).siblings(".tooltip").addClass("in");e.css({left:n(this).position().left+n(this).width()+5,top:n(this).position().top-n(e).height()/2+n(this).height()/2}).show(),e.click(function(t){t.stopPropagation()}),n(document).bind("click.color-picker",function(){e.hide(),n(document).unbind("click.color-picker")}),t.stopPropagation()}),f=n("<a href='javascript:void(0)'/>").addClass("icon-button arrow-circle").appendTo(d).attr("title","Set new random color").tooltip(),p=n("<div class='tooltip right' style='position: absolute;' />").appendTo(d).hide(),_=n("<div class='tooltip-inner' style='text-align: inherit'></div>").appendTo(p),m=(n("<div class='tooltip-arrow'></div>").appendTo(p),n.farbtastic(_,{width:100,height:100,callback:h,color:s}));d.append(n("<div/>").css("clear","both")),function(t){f.click(function(){t.setColor(l.default.get_random_color())})}(m)}else c.append(n("<input />").attr("id",r).attr("name",r).val(s));e.help&&c.append(n("<div class='help'/>").text(e.help))}}),this},render_in_modal:function(t){var e=this,i=function(){Galaxy.modal.hide(),n(window).unbind("keypress.check_enter_esc")},r=function(){Galaxy.modal.hide(),n(window).unbind("keypress.check_enter_esc"),e.update_from_form()},a=function(t){27===(t.keyCode||t.which)?i():13===(t.keyCode||t.which)&&r()};n(window).bind("keypress.check_enter_esc",a),0===this.$el.children().length&&this.render(),Galaxy.modal.show({title:t||"Configure",body:this.$el,buttons:{Cancel:i,OK:r}})},update_from_form:function(){var t=this;this.collection.each(function(e,i){if(!e.get("hidden")){var n="param_"+i,r=t.$el.find("#"+n).val();"bool"===e.get("type")&&(r=t.$el.find("#"+n).is(":checked")),e.set_value(r)}})}});e.default={ConfigSetting:u,ConfigSettingCollection:d,ConfigSettingCollectionView:h}}).call(e,i(2),i(0))},,function(t,e,i){"use strict";(function(t,n,r,a){function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=i(4),l=o(s),c=i(72),u=o(c),d=i(73),h=o(d),f=i(30),p=o(f);t.ajaxSettings.traditional=!0,e.default=n.View.extend({grid:null,initialize:function(t){this.grid=new u.default,this.title=t.title;var e=this;if(window.add_tag_to_grid_filter=function(t,i){var n=t+(void 0!==i&&""!==i?":"+i:"");r("#advanced-search").is(":visible")||(r("#standard-search").slideToggle("fast"),r("#advanced-search").slideToggle("fast")),e.add_filter_condition("tags",n)},this.setElement("<div/>"),t.url_base&&!t.items){var i=t.url_data||{};a.each(t.filters,function(t,e){i["f-"+e]=t}),r.ajax({url:t.url_base+"?"+r.param(i),success:function(i){i.embedded=t.embedded,i.filters=t.filters||{},e.init_grid(i)}})}else this.init_grid(t);t.use_panels&&r("#center").css({padding:"10px",overflow:"auto"})},handle_refresh:function(t){t&&r.inArray("history",t)>-1&&window.top.Galaxy&&window.top.Galaxy.currHistoryPanel&&window.top.Galaxy.currHistoryPanel.loadCurrentHistory()},init_grid:function(t){this.grid.set(t);var e=this.grid.attributes;this.allow_title_display&&e.title&&l.default.setWindowTitle(e.title),this.handle_refresh(e.refresh_frames);var i=this.grid.get("url_base");if(i=i.replace(/^.*\/\/[^\/]+/,""),this.grid.set("url_base",i),this.$el.html(h.default.grid(e)),this.$el.find("#grid-table-header").html(h.default.header(e)),this.$el.find("#grid-table-body").html(h.default.body(e)),this.$el.find("#grid-table-footer").html(h.default.footer(e)),e.message){this.$el.find("#grid-message").html(h.default.message(e));var n=this;e.use_hide_message&&setTimeout(function(){n.$el.find("#grid-message").html("")},5e3)}this.init_grid_elements(),this.init_grid_controls(),window.init_refresh_on_change&&window.init_refresh_on_change()},init_grid_controls:function(){var t=this;this.$el.find(".operation-button").each(function(){r(this).off(),r(this).click(function(){return t.submit_operation(this),!1})}),this.$el.find("input[type=text]").each(function(){r(this).off(),r(this).click(function(){r(this).select()}).keyup(function(){r(this).css("font-style","normal")})}),this.$el.find(".sort-link").each(function(){r(this).off(),r(this).click(function(){return t.set_sort_condition(r(this).attr("sort_key")),!1})}),this.$el.find(".text-filter-form").each(function(){r(this).off(),r(this).submit(function(){var e=r(this).attr("column_key"),i=r("#input-"+e+"-filter"),n=i.val();return i.val(""),t.add_filter_condition(e,n),!1})}),this.$el.find(".text-filter-val > a").each(function(){r(this).off(),r(this).click(function(){return r(this).parent().remove(),t.remove_filter_condition(r(this).attr("filter_key"),r(this).attr("filter_val")),!1})}),this.$el.find(".categorical-filter > a").each(function(){r(this).off(),r(this).click(function(){return t.set_categorical_filter(r(this).attr("filter_key"),r(this).attr("filter_val")),!1})}),this.$el.find(".advanced-search-toggle").each(function(){r(this).off(),r(this).click(function(){return t.$el.find("#standard-search").slideToggle("fast"),t.$el.find("#advanced-search").slideToggle("fast"),!1})}),this.$el.find("#check_all").off(),this.$el.find("#check_all").on("click",function(){t.check_all_items()})},init_grid_elements:function(){this.$el.find(".grid").each(function(){var t=r(this).find("input.grid-row-select-checkbox"),e=r(this).find("span.grid-selected-count"),i=function(){e.text(r(t).filter(":checked").length)};r(t).each(function(){r(this).change(i)}),i()}),0!==this.$el.find(".community_rating_star").length&&this.$el.find(".community_rating_star").rating({});var t=this.grid.attributes,e=this;this.$el.find(".page-link > a").each(function(){r(this).click(function(){return e.set_page(r(this).attr("page_num")),!1})}),this.$el.find(".use-target").each(function(){r(this).click(function(){return e.execute({href:r(this).attr("href"),target:r(this).attr("target")}),!1})}),0!==t.items.length&&a.each(t.items,function(i,n){var r=e.$("#grid-"+i.encode_id+"-popup").off(),o=new p.default(r);a.each(t.operations,function(t){e._add_operation(o,t,i)})})},_add_operation:function(t,e,i){var n=this,a=i.operation_config[e.label];a.allowed&&e.allow_popup&&t.addItem({html:e.label,href:a.url_args,target:a.target,confirmation_text:e.confirm,func:function(t){t.preventDefault();var a=r(t.target).html();e.onclick?e.onclick(i.encode_id):n.execute(this.findItemByHtml(a))}})},add_filter_condition:function(t,e){if(""===e)return!1;this.grid.add_filter(t,e,!0);var i=r(h.default.filter_element(t,e)),n=this;i.click(function(){r(this).remove(),n.remove_filter_condition(t,e)}),this.$el.find("#"+t+"-filtering-criteria").append(i),this.go_page_one(),this.execute()},remove_filter_condition:function(t,e){this.grid.remove_filter(t,e),this.go_page_one(),this.execute()},set_sort_condition:function(t){var e=this.grid.get("sort_key"),i=t;-1!==e.indexOf(t)&&"-"!==e.substring(0,1)&&(i="-"+t),this.$el.find(".sort-arrow").remove();var n="-"==i.substring(0,1)?"&uarr;":"&darr;",a=r("<span>"+n+"</span>").addClass("sort-arrow");this.$el.find("#"+t+"-header").append(a),this.grid.set("sort_key",i),this.go_page_one(),this.execute()},set_categorical_filter:function(t,e){var i=this.grid.get("categorical_filters")[t],n=this.grid.get("filters")[t],a=this;this.$el.find("."+t+"-filter").each(function(){var o=r.trim(r(this).text()),s=i[o],l=s[t];if(l==e)r(this).empty(),r(this).addClass("current-filter"),r(this).append(o);else if(l==n){r(this).empty();var c=r('<a href="#">'+o+"</a>");c.click(function(){a.set_categorical_filter(t,l)}),r(this).removeClass("current-filter"),r(this).append(c)}}),this.grid.add_filter(t,e),this.go_page_one(),this.execute()},set_page:function(t){var e=this;this.$el.find(".page-link").each(function(){var i,n=r(this).attr("id"),a=parseInt(n.split("-")[2],10),o=e.grid.get("cur_page");if(a===t)i=r(this).children().text(),r(this).empty(),r(this).addClass("inactive-link"),r(this).text(i);else if(a===o){i=r(this).text(),r(this).empty(),r(this).removeClass("inactive-link");var s=r('<a href="#">'+i+"</a>");s.click(function(){e.set_page(a)}),r(this).append(s)}}),"all"===t?this.grid.set("cur_page",t):this.grid.set("cur_page",parseInt(t,10)),this.execute()},submit_operation:function(t,e){var i=r(t).val();if(this.$el.find('input[name="id"]:checked').length<1)return!1;var n=a.findWhere(this.grid.attributes.operations,{label:i});n&&!e&&(e=n.confirm||"");var o=[];this.$el.find("input[name=id]:checked").each(function(){o.push(r(this).val())});var s={operation:i,id:o,confirmation_text:e};return"top"!=n.target&&"center"!=n.target||(s=a.extend(s,{href:n.href,target:n.target})),this.execute(s),!0},check_all_items:function(){var t=this.$(".grid-row-select-checkbox"),e=this.$("#check_all").prop("checked");a.each(t,function(t){r(t).prop("checked",e)}),this.init_grid_elements()},go_page_one:function(){var t=this.grid.get("cur_page");null!==t&&void 0!==t&&"all"!==t&&this.grid.set("cur_page",1)},execute:function(t){var e=null,i=null,n=null,a=null,o=null;if(t&&(i=t.href,n=t.operation,e=t.id,a=t.confirmation_text,o=t.target,void 0!==i&&-1!=i.indexOf("operation="))){var s=i.split("?");if(s.length>1)for(var l=s[1],c=l.split("&"),u=0;u<c.length;u++)-1!=c[u].indexOf("operation")?(n=c[u].split("=")[1],n=n.replace(/\+/g," ")):-1!=c[u].indexOf("id")&&(e=c[u].split("=")[1])}return n&&e?!(a&&""!==a&&"None"!=a&&"null"!=a&&!confirm(a))&&(n=n.toLowerCase(),this.grid.set({operation:n,item_ids:e}),"top"==o?window.top.location=i+"?"+r.param(this.grid.get_url_data()):"center"==o?r("#galaxy_main").attr("src",i+"?"+r.param(this.grid.get_url_data())):this.update_grid(),!1):i?(this.go_to(o,i),!1):(this.update_grid(),!1)},go_to:function(t,e){var i=this.$el.find("#advanced-search").is(":visible");switch(this.grid.set("advanced_search",i),e||(e=this.grid.get("url_base")+"?"+r.param(this.grid.get_url_data())),this.grid.set({operation:void 0,item_ids:void 0}),t){case"center":r("#galaxy_main").attr("src",e);break;case"top":window.top.location=e;break;default:window.location=e}},update_grid:function(){var t=this.grid.get("operation")?"POST":"GET";this.$el.find(".loading-elt-overlay").show();var e=this;r.ajax({type:t,url:e.grid.get("url_base"),data:e.grid.get_url_data(),error:function(){alert("Grid refresh failed")},success:function(t){var i=e.grid.get("embedded"),n=e.grid.get("insert"),r=e.$el.find("#advanced-search").is(":visible"),a=t;a.embedded=i,a.insert=n,a.advanced_search=r,e.init_grid(a),e.$el.find(".loading-elt-overlay").hide()},complete:function(){e.grid.set({operation:void 0,item_ids:void 0})}})}})}).call(e,i(0),i(2),i(0),i(1))},,,function(t,e,i){"use strict";(function(e){function n(t,e){!r.isUndefined(t)&&r.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var r=i(6),a=i(86),o={"Content-Type":"application/x-www-form-urlencoded"},s={adapter:function(){var t;return"undefined"!=typeof XMLHttpRequest?t=i(32):void 0!==e&&(t=i(32)),t}(),transformRequest:[function(t,e){return a(e,"Content-Type"),r.isFormData(t)||r.isArrayBuffer(t)||r.isBuffer(t)||r.isStream(t)||r.isFile(t)||r.isBlob(t)?t:r.isArrayBufferView(t)?t.buffer:r.isURLSearchParams(t)?(n(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):r.isObject(t)?(n(e,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(t){return t>=200&&t<300}};s.headers={common:{Accept:"application/json, text/plain, */*"}},r.forEach(["delete","get","head"],function(t){s.headers[t]={}}),r.forEach(["post","put","patch"],function(t){s.headers[t]=r.merge(o)}),t.exports=s}).call(e,i(85))},function(t,e,i){"use strict";function n(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}Object.defineProperty(e,"__esModule",{value:!0}),n(i(22)),n(i(23)),n(i(105))},function(t,e,i){"use strict";function n(t,e,i,n){if(void 0===n&&(n={writable:!0,enumerable:!0,configurable:!0}),!(t instanceof Object))throw new TypeError('"target" isn\'t an Object instance');if(void 0!==e){if(!(e instanceof Object))throw new TypeError('"properties" isn\'t an Object instance');if(void 0===n)n={writable:!0,enumerable:!0,configurable:!0};else if(!(n instanceof Object))throw new TypeError('"attributes" isn\'t an Object instance');if(void 0===i)for(var r in e)void 0!==e[r]&&Object.defineProperty(t,r,Object.create(n,{value:{value:e[r]}}));else if(i instanceof Array)i.forEach(function(i){void 0!==e[i]&&Object.defineProperty(t,i,Object.create(n,{value:{value:e[i]}}))});else{if(!(i instanceof Object))throw new TypeError('"keys" isn\'t an Object instance');for(var a in i){var r=i[a];void 0!==e[r]&&Object.defineProperty(t,a,Object.create(n,{value:{value:e[r]}}))}}}}function r(t,e,i,n){if(void 0===n&&(n=!0),!(t instanceof Object))throw new TypeError('"target" isn\'t an Object instance');if(void 0===e)return!0;if(!(e instanceof Object))throw new TypeError('"properties" isn\'t an Object instance');if(void 0===n&&(n=!0),void 0===i){for(var r in e)if(t[r]!==e[r]&&(void 0!==e[r]||!n))return!1}else{if(i instanceof Array)return i.every(function(i){return t[i]===e[i]||void 0===e[i]&&n});if(!(i instanceof Object))throw new TypeError('"keys" isn\'t an Object instance');for(var a in i){var r=i[a];if(t[a]!==e[r]&&(void 0!==e[r]||!n))return!1}}return!0}function a(t){return"number"==typeof t}function o(t){return"string"==typeof t}function s(t,e){if(!t)throw new Error(e);return t}function l(t,e){if(!(t instanceof Object))throw new TypeError(e||"Expected Object");return t}function c(t,e){if("string"!=typeof t)throw new TypeError(e||"Expected string");return t}function u(t,e){if(!d(t))throw new TypeError(e||"Expected Array");return t}function d(t){return!!t&&t.constructor===Array}function h(t,e){return[].concat.apply([],t.map(e))}Object.defineProperty(e,"__esModule",{value:!0}),e.updateProperties=n,e.testProperties=r,e.mustBeNumber=function(t,e){if(!a(t))throw new TypeError(e||"Expected number");return t},e.isNumber=a,e.isString=o,e.mustNotBeUndefined=s,e.mustBeObject=l,e.mustBeString=c,e.mustBeArray=u,e.isArray=d,e.mconcat=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return e.reduceRight(t)},e.snd=function(t){return t[1]},e.concatMap=h},function(t,e,i){"use strict";function n(t){return a(t)||o(t)}function r(t){return e.measureTypes.hasOwnProperty(t)}function a(t){return r(t.type)&&X.isNumber(t.value)}function o(t){return _(t.expression)}function s(t){if(void 0===t)return!1;switch(t){case"Parentheses":case"Square":case"Dollar":return!0;default:return!1}}function l(t,e){return void 0!==t&&(void 0===e?"string"==typeof t.name:e===t.name)}function c(t){return void 0!==t&&"string"==typeof t.text}function u(t){return void 0!==t&&X.isArray(t.latex)}function d(t){return t.arguments instanceof Array}function h(t){return t===W.SUP||t===W.SUB}function f(t){switch(t){case"#":return"\\#";case"$":return"\\$";case"%":return"\\%";case"^":return"\\^{}";case"&":return"\\&";case"{":return"\\{";case"}":return"\\}";case"~":return"\\~{}";case"\\":return"\\textbackslash{}";case"_":return"\\_{}";default:return t}}function p(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return 0===e.length?"string"==typeof t.type:e.some(function(e){return t.type===e})}function _(t){return g(t)||m(t)}function m(t){return R(t)||w(t)||y(t)||x(t)||k(t)||C(t)||T(t)||A(t)}function g(t){return R(t)||v(t)||y(t)||x(t)||k(t)||C(t)||T(t)||A(t)}function v(t){return void 0!==t&&void 0!==t.type&&c(t)&&p(t,e.typeTeXRaw)}function w(t){return void 0!==t&&"string"==typeof t.string&&"number"==typeof t.category}function y(t){return l(t)&&d(t)&&p(t,e.typeTeXComm,e.typeTeXCommS)}function b(t){return y(t)&&0===t.arguments.length}function x(t,i){return p(t,e.typeTeXEnv)}function k(t){return u(t)&&p(t)&&s(t.type)}function C(t){return void 0!==t&&"boolean"==typeof t.noNewPage&&(void 0===t.measure||n(t.measure))}function S(t){return h(t.type)}function T(t){return u(t)&&p(t,e.typeTeXBraces)}function M(t){return p(t,"FixArg")}function O(t){return p(t,"OptArg")}function A(t){return c(t)&&p(t,e.typeTeXComment)}function R(t){return void 0!==t&&0===Object.keys(t).length}function E(t){return{type:"FixArg",latex:t}}function z(t){return 1===t.length?{type:"OptArg",latex:t}:{type:"MOptArg",latex:t}}function P(t){return{type:"SymArg",latex:[t]}}function j(t){return{type:"ParArg",latex:[t]}}function q(t){return{type:"MOptArg",latex:t}}function L(t){return{type:"MSymArg",latex:t}}function $(t){return{type:"MParArg",latex:t}}function N(t){return{name:t,arguments:[],type:e.typeTeXCommS}}function I(t){return{text:t,type:e.typeTeXRaw,characterCategories:J.convertToTeXCharsDefault(t)}}function D(t,e,i,n){return{latex:n,type:t,startSymbol:e,endSymbol:i}}function G(t){return{latex:[t],type:e.typeTeXBraces}}function U(t){return{text:t,type:e.typeTeXComment}}function B(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];return{name:t,arguments:i,type:e.typeTeXComm}}function F(t,e,i){return{type:t,symbol:e,arguments:i}}function V(t,i){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return{name:t,latex:i,arguments:n,type:e.typeTeXEnv}}function H(t){var e=[];return Y(t,e),e.join("")}function Y(t,e){if(y(t))e.push("\\",t.name),t.arguments.forEach(function(t){return Y(t,e)});else{if(x(t))throw new Error("not supported yet");if(k(t))e.push(t.startSymbol),t.latex.forEach(function(t){return Y(t,e)}),e.push(t.endSymbol);else if(C(t))e.push("\n");else if(S(t))e.push(t.symbol),t.arguments&&t.arguments.forEach(function(t){return Y(t,e)});else if(T(t))e.push("{"),t.latex.forEach(function(t){return Y(t,e)}),e.push("}");else if(A(t))e.push("%"+t.text+"\n");else if(v(t))e.push(t.text);else{if(w(t))throw new Error("not supported yet");if(M(t))e.push("{"),t.latex.forEach(function(t){return Y(t,e)}),e.push("}");else{if(!O(t))throw new Error("Did not recognize "+JSON.stringify(t));e.push("["),t.latex.forEach(function(t){return Y(t,e)}),e.push("]")}}}}Object.defineProperty(e,"__esModule",{value:!0});var X=i(22),J=i(37);e.isMeasure=n,e.measureTypes={pt:!0,mm:!0,cm:!0,in:!0,ex:!0,em:!0},e.isMeasureType=r,e.isBuiltInMeasure=a,e.isCustomMeasure=o,e.mathTypes={Parentheses:"Parentheses",Square:"Square",Dollar:"Dollar"},e.isMathType=s,e.isNameHaving=l,e.isTextHaving=c,e.isLaTeXHaving=u,e.isArgumentHaving=d,e.typeTeXSeq="TeXSeq",e.typeTeXEnv="TeXEnv",e.typeTeXBraces="TeXBraces",e.typeTeXComment="TeXComment",e.typeTeXRaw="TeXRaw",e.typeTeXComm="TeXComm",e.typeTeXCommS="TeXCommS";var W;!function(t){t[t.SUP=0]="SUP",t[t.SUB=1]="SUB"}(W=e.SubOrSuperSymbol||(e.SubOrSuperSymbol={})),e.isSubOrSuperSymbol=h,e.fromStringLaTeX=function(t){return I(e.protectString(t))},e.protectString=function(t){for(var e=[],i=0;i<t.length;i++)e.push(f(t.charAt(i)));return e.join()},e.protectChar=f,e.isTypeHaving=p,e.isLaTeXBlock=_,e.isLaTeXNoRaw=m,e.isLaTeXRaw=g,e.isTeXRaw=v,e.isTeXChar=w,e.isTeXComm=y,e.isTeXCommS=b,e.isTeXEnv=x,e.isTeXMath=k,e.isTeXLineBreak=C,e.isSubOrSuperScript=S,e.isTeXBraces=T,e.isFixArg=M,e.isOptArg=O,e.isTeXComment=A,e.isTeXEmpty=R,e.newFixArg=E,e.newOptArg=z,e.newSymArg=P,e.newParArg=j,e.newMOptArg=q,e.newMSymArg=L,e.newMParArg=$,e.newCommandS=N,e.newTeXRaw=I,e.newTeXMath=D,e.newTeXBraces=G,e.newTeXMathDol=function(t){return D("Dollar","$","$",t)},e.newTeXComment=U,e.newTeXComm=B,e.newSubOrSuperScript=F,e.newTeXEnv=V,e.stringifyLaTeX=H},function(t,e,i){"use strict";(function(t,i,n){Object.defineProperty(e,"__esModule",{value:!0});var r=t.Model.extend({defaults:{title:"",icon_class:"",on_click:null,menu_options:null,is_menu_button:!0,id:null,href:null,target:null,enabled:!0,visible:!0,tooltip_config:{}}}),a=t.View.extend({initialize:function(){this.model.attributes.tooltip_config={placement:"bottom"},this.model.bind("change",this.render,this)},render:function(){this.$el.tooltip("hide");var t=this.template(this.model.toJSON());return t.tooltip(this.model.get("tooltip_config")),this.$el.replaceWith(t),this.setElement(t),this},events:{click:"click"},click:function(t){return!i.isFunction(this.model.get("on_click"))||(this.model.get("on_click")(t),!1)},template:function(t){var e='title="'+t.title+'" class="icon-button';return t.is_menu_button&&(e+=" menu-button"),e+=" "+t.icon_class,t.enabled||(e+="_disabled"),e+='"',t.id&&(e+=' id="'+t.id+'"'),e+=' href="'+t.href+'"',t.target&&(e+=' target="'+t.target+'"'),t.visible||(e+=' style="display: none;"'),e=t.enabled?"<a "+e+"/>":"<span "+e+"/>",n(e)}}),o=t.Collection.extend({model:r}),s=t.View.extend({tagName:"div",initialize:function(){this.render()},render:function(){var t=this;return this.collection.each(function(e){var i=n("<a/>").attr("href","javascript:void(0)").attr("title",e.attributes.title).addClass("icon-button menu-button").addClass(e.attributes.icon_class).appendTo(t.$el).click(e.attributes.on_click);e.attributes.tooltip_config&&i.tooltip(e.attributes.tooltip_config);var r=e.get("options");r&&make_popupmenu(i,r)}),this}}),l=function(t,e){e||(e={});var n=new o(i.map(t,function(t){return new r(i.extend(t,e))}));return new s({collection:n})};e.default={IconButton:r,IconButtonView:a,IconButtonCollection:o,IconButtonMenuView:s,create_icon_buttons_menu:l}}).call(e,i(2),i(1),i(0))},function(t,e){t.exports=function(t,e,i,n,r,a){var o,s=t=t||{},l=typeof t.default;"object"!==l&&"function"!==l||(o=t,s=t.default);var c="function"==typeof s?s.options:s;e&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0),i&&(c.functional=!0),r&&(c._scopeId=r);var u;if(a?(u=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},c._ssrRegister=u):n&&(u=n),u){var d=c.functional,h=d?c.render:c.beforeCreate;d?(c._injectStyles=u,c.render=function(t,e){return u.call(e),h(t,e)}):c.beforeCreate=h?[].concat(h,u):[u]}return{esModule:o,exports:s,options:c}}},function(t,e,i){"use strict";function n(t,e){var i=void 0!==t.prototype?t.prototype:t;return void 0!==e&&(i._logNamespace=e),r.forEach(function(t){i[t]=function(){if(this.logger)return this.logger.emit?this.logger.emit(t,this._logNamespace,arguments):this.logger[t]?this.logger[t].apply(this.logger,arguments):void 0}}),t}Object.defineProperty(e,"__esModule",{value:!0});var r=["log","debug","info","warn","error","metric"];e.default=n},function(t,e,i){"use strict";(function(t,i){Object.defineProperty(e,"__esModule",{value:!0});var n=t.Model.extend({defaults:{activate:!1}}),r=t.Collection.extend({model:n}),a=t.View.extend({el:"#webhook-view",initialize:function(t){var e=this,i=t.toolId||"",r=t.toolVersion||"";this.$el.attr("tool_id",i),this.$el.attr("tool_version",r),this.model=new n,this.model.urlRoot=t.urlRoot,this.model.fetch({success:function(){e.render()}})},render:function(){var t=this.model.toJSON();return this.$el.html('<div id="'+t.name+'"></div>'),t.styles&&i("<style/>",{type:"text/css"}).text(t.styles).appendTo("head"),t.script&&i("<script/>",{type:"text/javascript"}).text(t.script).appendTo("head"),this}}),o=function(t){var e=new r;e.url=Galaxy.root+t.url,e.fetch({async:!t.async||t.async,success:t.callback})};e.default={Webhooks:r,WebhookView:a,add:o}}).call(e,i(2),i(0))},function(t,e,i){"use strict";(function(t){function i(e,i){i=i||window.location.search.substr(1);var n=new RegExp(e+"=([^&#$]+)","g"),r=i.match(n);if(r&&r.length)return r=t.map(r,function(t){return decodeURIComponent(t.substr(e.length+1).replace(/\+/g," "))}),1===r.length?r[0]:r}function n(t){if(!t)return{};var e={};return t.split("&").forEach(function(t){var i=t.split("=");e[i[0]]=decodeURI(i[1])}),e}Object.defineProperty(e,"__esModule",{value:!0}),e.default={get:i,parse:n}}).call(e,i(1))},,function(t,e,i){"use strict";(function(t,i,n,r){Object.defineProperty(e,"__esModule",{value:!0});var a=t.View.extend({initialize:function(t,e){this.$button=t,this.$button.length||(this.$button=i("<div/>")),this.options=e||[],this.$button.data("popupmenu",this);var n=this;this.$button.click(function(t){return i(".popmenu-wrapper").remove(),n._renderAndShow(t),!1})},_renderAndShow:function(t){this.render(),this.$el.appendTo("body").css(this._getShownPosition(t)).show(),this._setUpCloseBehavior()},render:function(){if(this.$el.addClass("popmenu-wrapper").hide().css({position:"absolute"}).html(this.template(this.$button.attr("id"),this.options)),this.options.length){var t=this;this.$el.find("li").each(function(e,n){var r=t.options[e];r.func&&i(this).children("a.popupmenu-option").click(function(e){r.func.call(t,e,r),e.preventDefault()})})}return this},template:function(t,e){return['<ul id="',t,'-menu" class="dropdown-menu">',this._templateOptions(e),"</ul>"].join("")},_templateOptions:function(t){return t.length?n.map(t,function(t){return t.divider?'<li class="divider"></li>':t.header?['<li class="head"><a href="javascript:void(0);">',t.html,"</a></li>"].join(""):['<li><a class="popupmenu-option" href="',t.href||"javascript:void(0);",'"',t.target?' target="'+t.target+'"':"",">",t.checked?'<span class="fa fa-check"></span>':"",t.html,"</a></li>"].join("")}).join(""):"<li>(no options)</li>"},_getShownPosition:function(t){var e=this.$el.width(),n=t.pageX-e/2;return n=Math.min(n,i(document).scrollLeft()+i(window).width()-e-5),n=Math.max(n,i(document).scrollLeft()+5),{top:t.pageY,left:n}},_setUpCloseBehavior:function(){function t(t){if(i(document).off("click.close_popup"),window&&window.parent!==window)try{i(window.parent.document).off("click.close_popup")}catch(t){}else try{i("iframe#galaxy_main").contents().off("click.close_popup")}catch(t){}e.remove()}var e=this;if(i("html").one("click.close_popup",t),window&&window.parent!==window)try{i(window.parent.document).find("html").one("click.close_popup",t)}catch(t){}else try{i("iframe#galaxy_main").contents().one("click.close_popup",t)}catch(t){}},addItem:function(t,e){return e=e>=0?e:this.options.length,this.options.splice(e,0,t),this},removeItem:function(t){return t>=0&&this.options.splice(t,1),this},findIndexByHtml:function(t){for(var e=0;e<this.options.length;e++)if(n.has(this.options[e],"html")&&this.options[e].html===t)return e;return null},findItemByHtml:function(t){return this.options[this.findIndexByHtml(t)]},toString:function(){return"PopupMenu"}});a.create=function(t,e){return new a(t,e)},a.make_popupmenu=function(t,e){var o=[];return n.each(e,function(t,e){var i={html:e};null===t?i.header=!0:"function"===r.type(t)&&(i.func=t),o.push(i)}),new a(i(t),o)},a.convertLinksToOptions=function(t,e){t=i(t),e=e||"a";var n=[];return t.find(e).each(function(t,e){var r={},a=i(t);if(r.html=a.text(),a.attr("href")){var o=a.attr("href"),s=a.attr("target"),l=a.attr("confirm");r.func=function(){if(!l||confirm(l))switch(s){case"_parent":window.parent.location=o;break;case"_top":window.top.location=o;break;default:window.location=o}}}n.push(r)}),n},a.fromExistingDom=function(t,e,n){t=i(t),e=i(e);var r=a.convertLinksToOptions(e,n);return e.remove(),new a(t,r)},a.make_popup_menus=function(t,e,n){t=t||document,e=e||"div[popupmenu]",n=n||function(t,e){return"#"+t.attr("popupmenu")};var r=[];return i(t).find(e).each(function(){var e=i(this),o=i(t).find(n(e,t));r.push(a.fromDom(o,e)),o.addClass("popup")}),r},e.default=a}).call(e,i(2),i(0),i(1),i(0))},function(t,e,i){"use strict";t.exports=function(t,e){return function(){for(var i=new Array(arguments.length),n=0;n<i.length;n++)i[n]=arguments[n];return t.apply(e,i)}}},function(t,e,i){"use strict";var n=i(6),r=i(87),a=i(89),o=i(90),s=i(91),l=i(33),c="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||i(92);t.exports=function(t){return new Promise(function(e,u){var d=t.data,h=t.headers;n.isFormData(d)&&delete h["Content-Type"];var f=new XMLHttpRequest,p="onreadystatechange",_=!1;if(window.XMLHttpRequest||"undefined"==typeof window||!window.XDomainRequest||"withCredentials"in f||s(t.url)||(f=new window.XDomainRequest,p="onload",_=!0,f.onprogress=function(){},f.ontimeout=function(){}),t.auth){var m=t.auth.username||"",g=t.auth.password||"";h.Authorization="Basic "+c(m+":"+g)}if(f.open(t.method.toUpperCase(),a(t.url,t.params,t.paramsSerializer),!0),f.timeout=t.timeout,f[p]=function(){if(f&&(4===f.readyState||_)&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))){var i="getAllResponseHeaders"in f?o(f.getAllResponseHeaders()):null,n=t.responseType&&"text"!==t.responseType?f.response:f.responseText,a={data:n,status:1223===f.status?204:f.status,statusText:1223===f.status?"No Content":f.statusText,headers:i,config:t,request:f};r(e,u,a),f=null}},f.onerror=function(){u(l("Network Error",t,null,f)),f=null},f.ontimeout=function(){u(l("timeout of "+t.timeout+"ms exceeded",t,"ECONNABORTED",f)),f=null},n.isStandardBrowserEnv()){var v=i(93),w=(t.withCredentials||s(t.url))&&t.xsrfCookieName?v.read(t.xsrfCookieName):void 0;w&&(h[t.xsrfHeaderName]=w)}if("setRequestHeader"in f&&n.forEach(h,function(t,e){void 0===d&&"content-type"===e.toLowerCase()?delete h[e]:f.setRequestHeader(e,t)}),t.withCredentials&&(f.withCredentials=!0),t.responseType)try{f.responseType=t.responseType}catch(e){if("json"!==t.responseType)throw e}"function"==typeof t.onDownloadProgress&&f.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&f.upload&&f.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then(function(t){f&&(f.abort(),u(t),f=null)}),void 0===d&&(d=null),f.send(d)})}},function(t,e,i){"use strict";var n=i(88);t.exports=function(t,e,i,r,a){var o=new Error(t);return n(o,e,i,r,a)}},function(t,e,i){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},function(t,e,i){"use strict";function n(t){this.message=t}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,t.exports=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.supportedMarkups={ascii:!0,unicode:!0,html:!0}},function(t,e,i){"use strict";function n(t){return r(e.defaultCategories,t)}function r(t,e){for(var i=[],n=0;n<e.length;n++){var r=e.charAt(n);i.push({string:r,category:t(r)})}return i}Object.defineProperty(e,"__esModule",{value:!0}),e.defaultCategories=function(t){switch(t){case"\\":return 0;case"{":return 1;case"}":return 2;case"$":return 3;case"&":return 4;case"\r":return 5;case"#":return 6;case"^":return 7;case"_":return 8;case"\0":return 9;case" ":return 10;case"~":return 13;case"%":return 14;case"d":return 15;default:return 11}},e.convertToTeXCharsDefault=n,e.convertToTeXChars=r},function(t,e,i){!function(e,i){t.exports=i()}(0,function(){return function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var i={};return e.m=t,e.c=i,e.i=function(t){return t},e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this._=t}function r(t){return t instanceof n}function a(t){return"[object Array]"==={}.toString.call(t)}function o(t,e){return{status:!0,index:t,value:e,furthest:-1,expected:[]}}function s(t,e){return{status:!1,index:-1,value:null,furthest:t,expected:[e]}}function l(t,e){if(!e)return t;if(t.furthest>e.furthest)return t;var i=t.furthest===e.furthest?u(t.expected,e.expected):e.expected;return{status:t.status,index:t.index,value:t.value,furthest:e.furthest,expected:i}}function c(t,e){var i=t.slice(0,e).split("\n");return{offset:e,line:i.length,column:i[i.length-1].length+1}}function u(t,e){var i=t.length,n=e.length;if(0===i)return e;if(0===n)return t;for(var r={},a=0;a<i;a++)r[t[a]]=!0;for(var o=0;o<n;o++)r[e[o]]=!0;var s=[];for(var l in r)r.hasOwnProperty(l)&&s.push(l);return s.sort(),s}function d(t){if(!r(t))throw new Error("not a parser: "+t)}function h(t){if(!a(t))throw new Error("not an array: "+t)}function f(t){if("number"!=typeof t)throw new Error("not a number: "+t)}function p(t){if(!(t instanceof RegExp))throw new Error("not a regexp: "+t);for(var e=y(t),i=0;i<e.length;i++){var n=e.charAt(i);if("i"!==n&&"m"!==n&&"u"!==n)throw new Error('unsupported regexp flag "'+n+'": '+t)}}function _(t){if("function"!=typeof t)throw new Error("not a function: "+t)}function m(t){if("string"!=typeof t)throw new Error("not a string: "+t)}function g(t){return 1===t.length?t[0]:"one of "+t.join(", ")}function v(t,e){var i=e.index,n=i.offset;if(n===t.length)return", got the end of the input";var r=n>0?"'...":"'",a=t.length-n>12?"...'":"'";return" at line "+i.line+" column "+i.column+", got "+r+t.slice(n,n+12)+a}function w(t,e){return"expected "+g(e.expected)+v(t,e)}function y(t){var e=""+t;return e.slice(e.lastIndexOf("/")+1)}function b(t){return RegExp("^(?:"+t.source+")",y(t))}function x(){for(var t=[].slice.call(arguments),e=t.length,i=0;i<e;i+=1)d(t[i]);return n(function(i,n){for(var r,a=new Array(e),s=0;s<e;s+=1){if(r=l(t[s]._(i,n),r),!r.status)return r;a[s]=r.value,n=r.index}return l(o(n,a),r)})}function k(){for(var t={},e=0,i=[].slice.call(arguments),s=i.length,c=0;c<s;c+=1){var u=i[c];if(!r(u)){if(a(u)&&2===u.length&&"string"==typeof u[0]&&r(u[1])){var d=u[0];if(t[d])throw new Error("seqObj: duplicate key "+d);t[d]=!0,e++;continue}throw new Error("seqObj arguments must be parsers or [string, parser] array pairs.")}}if(0===e)throw new Error("seqObj expects at least one named parser, found zero");return n(function(t,e){for(var n,r={},c=0;c<s;c+=1){var u,d;if(a(i[c])?(u=i[c][0],d=i[c][1]):(u=null,d=i[c]),n=l(d._(t,e),n),!n.status)return n;u&&(r[u]=n.value),e=n.index}return l(o(e,r),n)})}function C(){var t=[].slice.call(arguments);if(0===t.length)throw new Error("seqMap needs at least one argument");var e=t.pop();return _(e),x.apply(null,t).map(function(t){return e.apply(null,t)})}function S(t){var e={};for(var i in t)({}).hasOwnProperty.call(t,i)&&function(i){var n=function(){return t[i](e)};e[i]=G(n)}(i);return e}function T(){var t=[].slice.call(arguments),e=t.length;if(0===e)return z("zero alternates");for(var i=0;i<e;i+=1)d(t[i]);return n(function(e,i){for(var n,r=0;r<t.length;r+=1)if(n=l(t[r]._(e,i),n),n.status)return n;return n})}function M(t,e){return O(t,e).or(E([]))}function O(t,e){d(t),d(e);var i=e.then(t).many();return t.chain(function(t){return i.map(function(e){return[t].concat(e)})})}function A(t){m(t);var e="'"+t+"'";return n(function(i,n){var r=n+t.length,a=i.slice(n,r);return a===t?o(r,a):s(n,e)})}function R(t,e){p(t),arguments.length>=2?f(e):e=0;var i=b(t),r=""+t;return n(function(t,n){var a=i.exec(t.slice(n));if(a){if(0<=e&&e<=a.length){var l=a[0],c=a[e];return o(n+l.length,c)}return s(n,"valid match group (0 to "+a.length+") in "+r)}return s(n,r)})}function E(t){return n(function(e,i){return o(i,t)})}function z(t){return n(function(e,i){return s(i,t)})}function P(t){if(r(t))return n(function(e,i){var n=t._(e,i);return n.index=i,n.value="",n});if("string"==typeof t)return P(A(t));if(t instanceof RegExp)return P(R(t));throw new Error("not a string, regexp, or parser: "+t)}function j(t){return d(t),n(function(e,i){var n=t._(e,i),r=e.slice(i,n.index);return n.status?s(i,'not "'+r+'"'):o(i,null)})}function q(t){return _(t),n(function(e,i){var n=e.charAt(i);return i<e.length&&t(n)?o(i+1,n):s(i,"a character matching "+t)})}function L(t){return q(function(e){return t.indexOf(e)>=0})}function $(t){return q(function(e){return t.indexOf(e)<0})}function N(t){return n(t(o,s))}function I(t,e){return q(function(i){return t<=i&&i<=e}).desc(t+"-"+e)}function D(t){return _(t),n(function(e,i){for(var n=i;n<e.length&&t(e.charAt(n));)n++;return o(n,e.slice(i,n))})}function G(t,e){arguments.length<2&&(e=t,t=void 0);var i=n(function(t,n){return i._=e()._,i._(t,n)});return t?i.desc(t):i}function U(){return z("fantasy-land/empty")}var B=n.prototype;B.parse=function(t){if("string"!=typeof t)throw new Error(".parse must be called with a string as its argument");var e=this.skip(Y)._(t,0);return e.status?{status:!0,value:e.value}:{status:!1,index:c(t,e.furthest),expected:e.expected}},B.tryParse=function(t){var e=this.parse(t);if(e.status)return e.value;var i=w(t,e),n=new Error(i);throw n.type="ParsimmonError",n.result=e,n},B.or=function(t){return T(this,t)},B.trim=function(t){return this.wrap(t,t)},B.wrap=function(t,e){return C(t,this,e,function(t,e){return e})},B.thru=function(t){return t(this)},B.then=function(t){return d(t),x(this,t).map(function(t){return t[1]})},B.many=function(){var t=this;return n(function(e,i){for(var n=[],r=void 0;;){if(r=l(t._(e,i),r),!r.status)return l(o(i,n),r);i=r.index,n.push(r.value)}})},B.tie=function(){return this.map(function(t){h(t);for(var e="",i=0;i<t.length;i++)m(t[i]),e+=t[i];return e})},B.times=function(t,e){var i=this;return arguments.length<2&&(e=t),f(t),f(e),n(function(n,r){for(var a=[],s=void 0,c=void 0,u=0;u<t;u+=1){if(s=i._(n,r),c=l(s,c),!s.status)return c;r=s.index,a.push(s.value)}for(;u<e&&(s=i._(n,r),c=l(s,c),s.status);u+=1)r=s.index,a.push(s.value);return l(o(r,a),c)})},B.result=function(t){return this.map(function(){return t})},B.atMost=function(t){return this.times(0,t)},B.atLeast=function(t){return C(this.times(t),this.many(),function(t,e){return t.concat(e)})},B.map=function(t){_(t);var e=this;return n(function(i,n){var r=e._(i,n);return r.status?l(o(r.index,t(r.value)),r):r})},B.skip=function(t){return x(this,t).map(function(t){return t[0]})},B.mark=function(){return C(F,this,F,function(t,e,i){return{start:t,value:e,end:i}})},B.node=function(t){return C(F,this,F,function(e,i,n){return{name:t,value:i,start:e,end:n}})},B.sepBy=function(t){return M(this,t)},B.sepBy1=function(t){return O(this,t)},B.lookahead=function(t){return this.skip(P(t))},B.notFollowedBy=function(t){return this.skip(j(t))},B.desc=function(t){var e=this;return n(function(i,n){var r=e._(i,n);return r.status||(r.expected=[t]),r})},B.fallback=function(t){return this.or(E(t))},B.ap=function(t){return C(t,this,function(t,e){return t(e)})},B.chain=function(t){var e=this;return n(function(i,n){var r=e._(i,n);return r.status?l(t(r.value)._(i,r.index),r):r})},B.concat=B.or,B.empty=U,B.of=E,B["fantasy-land/ap"]=B.ap,B["fantasy-land/chain"]=B.chain,B["fantasy-land/concat"]=B.concat,B["fantasy-land/empty"]=B.empty,B["fantasy-land/of"]=B.of,B["fantasy-land/map"]=B.map;var F=n(function(t,e){return o(e,c(t,e))}),V=n(function(t,e){return e>=t.length?s(e,"any character"):o(e+1,t.charAt(e))}),H=n(function(t,e){return o(t.length,t.slice(e))}),Y=n(function(t,e){return e<t.length?s(e,"EOF"):o(e,null)}),X=R(/[0-9]/).desc("a digit"),J=R(/[0-9]*/).desc("optional digits"),W=R(/[a-z]/i).desc("a letter"),K=R(/[a-z]*/i).desc("optional letters"),Z=R(/\s*/).desc("optional whitespace"),Q=R(/\s+/).desc("whitespace");n.all=H,n.alt=T,n.any=V,n.createLanguage=S,n.custom=N,n.digit=X,n.digits=J,n.empty=U,n.eof=Y,n.fail=z,n.formatError=w,n.index=F,n.isParser=r,n.lazy=G,n.letter=W,n.letters=K,n.lookahead=P,n.makeFailure=s,n.makeSuccess=o,n.noneOf=$,n.notFollowedBy=j,n.of=E,n.oneOf=L,n.optWhitespace=Z,n.Parser=n,n.range=I,n.regex=R,n.regexp=R,n.sepBy=M,n.sepBy1=O,n.seq=x,n.seqMap=C,n.seqObj=k,n.string=A,n.succeed=E,n.takeWhile=D,n.test=q,n.whitespace=Q,n["fantasy-land/empty"]=U,n["fantasy-land/of"]=E,t.exports=n}])})},function(t,e,i){"use strict";function n(t){return new Error("I do not know command "+t)}Object.defineProperty(e,"__esModule",{value:!0}),e.unknownCommandError=n},function(t,e,i){"use strict";function n(t,e,i,n){return{name:t,optionalArguments:e,argumentCount:i,apply:n}}function r(t,e,i){return{name:t,optionalArguments:e,argumentCount:i}}function a(t,e){return{name:t,optionalArguments:0,argumentCount:e}}Object.defineProperty(e,"__esModule",{value:!0}),e.createCommandHandler=n,e.createKnownCommandWithOptArgs=r,e.createKnownCommandWithArgs=a},function(t,e,i){"use strict";function n(t){return"bb"===t||"mathbb"===t||"textbb"===t}function r(t){return"bf"===t||"mathbf"===t||"textbf"===t}function a(t){return"mono"===t}function o(t){return"frak"===t||"mathfrak"===t||"textfrak"===t}function s(t){return"it"===t||"mathit"===t||"textit"===t}function l(t){return"tt"===t||"mathtt"===t||"texttt"===t}function c(t){return"cal"===t||"mathcal"===t||"textcal"===t}function u(t){return"sup"===t||"mathsup"===t||"textsup"===t||"superscript"===t||"mathsuperscript"===t||"textsuperscript"===t}function d(t){return"sub"===t||"mathsub"===t||"textsub"===t||"subscript"===t||"mathsubscript"===t||"textsubscript"===t}function h(t){return e.formattingText.hasOwnProperty(t)||e.formattingMath.hasOwnProperty(t)||e.formattingNoMode.hasOwnProperty(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.formattingText={textbb:!0,textbf:!0,textfrak:!0,textit:!0,texttt:!0,textcal:!0,textsup:!0,textsub:!0,textsuperscript:!0,textsubscript:!0},e.formattingNoMode={bb:!0,bf:!0,frak:!0,it:!0,tt:!0,cal:!0,mono:!0,sup:!0,sub:!0,superscript:!0,subscript:!0},e.formattingMath={mathbb:!0,mathbf:!0,mathfrak:!0,mathit:!0,mathtt:!0,mathcal:!0,mathsup:!0,mathsub:!0,mathsuperscript:!0,mathsubscript:!0},e.isBbCmd=n,e.isBfCmd=r,e.isMonoCmd=a,e.isFrakCmd=o,e.isItCmd=s,e.isTtCmd=l,e.isCalCmd=c,e.isSupCmd=u,e.isSubCmd=d,e.isFormattingCmd=h},function(t,e,i){"use strict";function n(t){return e.superscriptCharacters.hasOwnProperty(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.superscriptCharacters={0:"⁰",1:"¹",2:"²",3:"³",4:"⁴",5:"⁵",6:"⁶",7:"⁷",8:"⁸",9:"⁹","+":"⁺","-":"⁻","=":"⁼","(":"⁽",")":"⁾",a:"ᵃ",b:"ᵇ",c:"ᶜ",d:"ᵈ",e:"ᵉ",f:"ᶠ",g:"ᵍ",h:"ʰ",i:"ⁱ",j:"ʲ",k:"ᵏ",l:"ˡ",m:"ᵐ",n:"ⁿ",o:"ᵒ",p:"ᵖ",r:"ʳ",s:"ˢ",t:"ᵗ",u:"ᵘ",v:"ᵛ",w:"ʷ",x:"ˣ",y:"ʸ",z:"ᶻ",A:"ᴬ",B:"ᴮ",D:"ᴰ",E:"ᴱ",G:"ᴳ",H:"ᴴ",I:"ᴵ",J:"ᴶ",K:"ᴷ",L:"ᴸ",M:"ᴹ",N:"ᴺ",O:"ᴼ",P:"ᴾ",R:"ᴿ",T:"ᵀ",U:"ᵁ",V:"ⱽ",W:"ᵂ","α":"ᵅ","β":"ᵝ","γ":"ᵞ","δ":"ᵟ","∊":"ᵋ","θ":"ᶿ","ι":"ᶥ","Φ":"ᶲ","φ":"ᵠ","χ":"ᵡ"},e.isSuperscriptCharacter=n,e.translateCharToSuperscript=function(t){return n(t)?e.superscriptCharacters[t]:void 0}},function(t,e,i){"use strict";function n(t){return e.oneArgsCommands.hasOwnProperty(t)}Object.defineProperty(e,"__esModule",{value:!0});var r=i(137),a=i(138),o=i(41);e.oneArgsCommands=Object.assign({},r.spaceCmds1arg,o.formattingText,o.formattingMath,o.formattingNoMode,a.diacriticsTextMode,a.diacriticsMathMode,{cyrchar:!0,vec:!0,mono:!0}),e.is1argsCommand=n},,function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0});var a=i(1),o=(r(a),i(2)),s=r(o),l=i(5),c=n(l),u=i(3),d=n(u),h=s.Model.extend(c.default.LoggableMixin).extend({_logNamespace:"user",urlRoot:function(){return Galaxy.root+"api/users"},defaults:{id:null,username:"("+(0,d.default)("anonymous user")+")",email:"",total_disk_usage:0,nice_total_disk_usage:"",quota_percent:null,is_admin:!1},initialize:function(t){this.log("User.initialize:",t),this.on("loaded",function(t,e){this.log(this+" has loaded:",t,e)}),this.on("change",function(t,e){this.log(this+" has changed:",t,e.changes)})},isAnonymous:function(){return!this.get("email")},isAdmin:function(){return this.get("is_admin")},loadFromApi:function(t,e){t=t||h.CURRENT_ID_STR,e=e||{};var i=this,n=e.success;return e.success=function(t,e){i.trigger("loaded",t,e),n&&n(t,e)},t===h.CURRENT_ID_STR&&(e.url=this.urlRoot+"/"+h.CURRENT_ID_STR),s.Model.prototype.fetch.call(this,e)},clearSessionStorage:function(){for(var t in sessionStorage)0===t.indexOf("history:")?sessionStorage.removeItem(t):"history-panel"===t&&sessionStorage.removeItem(t)},toString:function(){var t=[this.get("username")];return this.get("id")&&(t.unshift(this.get("id")),t.push(this.get("email"))),"User("+t.join(":")+")"}});h.CURRENT_ID_STR="current",h.getCurrentUserFromApi=function(t){var e=new h;return e.loadFromApi(h.CURRENT_ID_STR,t),e};s.Collection.extend(c.default.LoggableMixin).extend({model:h,urlRoot:function(){return Galaxy.root+"api/users"}});e.default={User:h}},function(t,e,i){"use strict";(function(t,n){function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=i(1),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(a),s=i(13),l=r(s),c=i(10),u=r(c),d=i(58),h=(r(d),{hidden:!1,show:function(){this.set("hidden",!1)},hide:function(){this.set("hidden",!0)},toggle:function(){this.set("hidden",!this.get("hidden"))},is_visible:function(){return!this.attributes.hidden}}),f=t.Model.extend({defaults:{name:null,label:null,type:null,value:null,html:null,num_samples:5},initialize:function(t){this.attributes.html=unescape(this.attributes.html)},copy:function(){return new f(this.toJSON())},set_value:function(t){this.set("value",t||"")}}),p=t.Collection.extend({model:f}),_=f.extend({}),m=f.extend({set_value:function(t){this.set("value",parseInt(t,10))},get_samples:function(){return d3.scale.linear().domain([this.get("min"),this.get("max")]).ticks(this.get("num_samples"))}}),g=m.extend({set_value:function(t){this.set("value",parseFloat(t))}}),v=f.extend({get_samples:function(){return o.map(this.get("options"),function(t){return t[0]})}});f.subModelTypes={integer:m,float:g,data:_,select:v};var w=t.Model.extend({defaults:{id:null,name:null,description:null,target:null,inputs:[],outputs:[]},urlRoot:Galaxy.root+"api/tools",initialize:function(t){this.set("inputs",new p(o.map(t.inputs,function(t){return new(f.subModelTypes[t.type]||f)(t)})))},toJSON:function(){var e=t.Model.prototype.toJSON.call(this);return e.inputs=this.get("inputs").map(function(t){return t.toJSON()}),e},remove_inputs:function(t){var e=this,i=e.get("inputs").filter(function(e){return-1!==t.indexOf(e.get("type"))});e.get("inputs").remove(i)},copy:function(e){var i=new w(this.toJSON());if(e){var n=new t.Collection;i.get("inputs").each(function(t){t.get_samples()&&n.push(t)}),i.set("inputs",n)}return i},apply_search_results:function(t){return-1!==o.indexOf(t,this.attributes.id)?this.show():this.hide(),this.is_visible()},set_input_value:function(t,e){this.get("inputs").find(function(e){return e.get("name")===t}).set("value",e)},set_input_values:function(t){var e=this;o.each(o.keys(t),function(i){e.set_input_value(i,t[i])})},run:function(){return this._run()},rerun:function(t,e){return this._run({action:"rerun",target_dataset_id:t.id,regions:e})},get_inputs_dict:function(){var t={};return this.get("inputs").each(function(e){t[e.get("name")]=e.get("value")}),t},_run:function(t){var e=o.extend({tool_id:this.id,inputs:this.get_inputs_dict()},t),i=n.Deferred(),r=new l.default.ServerStateDeferred({ajax_settings:{url:this.urlRoot,data:JSON.stringify(e),dataType:"json",contentType:"application/json",type:"POST"},interval:2e3,success_fn:function(t){return"pending"!==t}});return n.when(r.go()).then(function(t){i.resolve(new u.default.DatasetCollection(t))}),i}});o.extend(w.prototype,h);var y=(t.View.extend({}),t.Collection.extend({model:w})),b=t.Model.extend(h),x=t.Model.extend({defaults:{elems:[],open:!1},clear_search_results:function(){o.each(this.attributes.elems,function(t){t.show()}),this.show(),this.set("open",!1)},apply_search_results:function(t){var e,i=!0;o.each(this.attributes.elems,function(n){n instanceof b?(e=n,e.hide()):n instanceof w&&n.apply_search_results(t)&&(i=!1,e&&e.show())}),i?this.hide():(this.show(),this.set("open",!0))}});o.extend(x.prototype,h);var k=t.Model.extend({defaults:{search_hint_string:"search tools",min_chars_for_search:3,clear_btn_url:"",visible:!0,query:"",results:null,clear_key:27},urlRoot:Galaxy.root+"api/tools",initialize:function(){this.on("change:query",this.do_search)},do_search:function(){var t=this.attributes.query;if(t.length<this.attributes.min_chars_for_search)return void this.set("results",null);var e=t;this.timer&&clearTimeout(this.timer),n("#search-clear-btn").hide(),n("#search-spinner").show();var i=this;this.timer=setTimeout(function(){"undefined"!=typeof ga&&ga("send","pageview",Galaxy.root+"?q="+e),n.get(i.urlRoot,{q:e},function(t){i.set("results",t),n("#search-spinner").hide(),n("#search-clear-btn").show()},"json")},400)},clear_search:function(){this.set("query",""),this.set("results",null)}});o.extend(k.prototype,h);var C=t.Model.extend({initialize:function(e){this.attributes.tool_search=e.tool_search,this.attributes.tool_search.on("change:results",this.apply_search_results,this),this.attributes.tools=e.tools,this.attributes.layout=new t.Collection(this.parse(e.layout))},parse:function(t){var e=this,i=function t(i){var n=i.model_class;if(n.indexOf("Tool")===n.length-4)return e.attributes.tools.get(i.id);if("ToolSection"===n){var r=o.map(i.elems,t);return i.elems=r,new x(i)}return"ToolSectionLabel"===n?new b(i):void 0};return o.map(t,i)},clear_search_results:function(){this.get("layout").each(function(t){t instanceof x?t.clear_search_results():t.show()})},apply_search_results:function(){var t=this.get("tool_search").get("results");if(null===t)return void this.clear_search_results();var e=null;this.get("layout").each(function(i){i instanceof b?(e=i,e.hide()):i instanceof w?i.apply_search_results(t)&&e&&e.show():(e=null,i.apply_search_results(t))})}}),S=t.View.extend({initialize:function(){this.model.on("change:hidden",this.update_visible,this),this.update_visible()},update_visible:function(){this.model.attributes.hidden?this.$el.hide():this.$el.show()}}),T=S.extend({tagName:"div",render:function(){var t=n("<div/>");t.append(z.tool_link(this.model.toJSON()));var e=this.model.get("form_style",null);if("upload1"===this.model.id)t.find("a").on("click",function(t){t.preventDefault(),Galaxy.upload.show()});else if("regular"===e){var i=this;t.find("a").on("click",function(t){t.preventDefault(),Galaxy.router.push("/",{tool_id:i.model.id,version:i.model.get("version")})})}return this.$el.append(t),this}}),M=S.extend({tagName:"div",className:"toolPanelLabel",render:function(){return this.$el.append(n("<span/>").text(this.model.attributes.text)),this}}),O=S.extend({tagName:"div",className:"toolSectionWrapper",initialize:function(){S.prototype.initialize.call(this),this.model.on("change:open",this.update_open,this)},render:function(){this.$el.append(z.panel_section(this.model.toJSON()));var t=this.$el.find(".toolSectionBody");return o.each(this.model.attributes.elems,function(e){if(e instanceof w){var i=new T({model:e,className:"toolTitle"});i.render(),t.append(i.$el)}else if(e instanceof b){var n=new M({model:e});n.render(),t.append(n.$el)}}),this},events:{"click .toolSectionTitle > a":"toggle"},toggle:function(){this.model.set("open",!this.model.attributes.open)},update_open:function(){this.model.attributes.open?this.$el.children(".toolSectionBody").slideDown("fast"):this.$el.children(".toolSectionBody").slideUp("fast")}}),A=t.View.extend({tagName:"div",id:"tool-search",className:"bar",events:{click:"focus_and_select","keyup :input":"query_changed","change :input":"query_changed","click #search-clear-btn":"clear"},render:function(){return this.$el.append(z.tool_search(this.model.toJSON())),this.model.is_visible()||this.$el.hide(),n("#messagebox").is(":visible")&&this.$el.css("top","95px"),this.$el.find("[title]").tooltip(),this},focus_and_select:function(){this.$el.find(":input").focus().select()},clear:function(){return this.model.clear_search(),this.$el.find(":input").val(""),this.focus_and_select(),!1},query_changed:function(t){if(this.model.attributes.clear_key&&this.model.attributes.clear_key===t.which)return this.clear(),!1;this.model.set("query",this.$el.find(":input").val())}}),R=t.View.extend({tagName:"div",className:"toolMenu",initialize:function(){this.model.get("tool_search").on("change:results",this.handle_search_results,this)},render:function(){var t=this,e=new A({model:this.model.get("tool_search")});return e.render(),t.$el.append(e.$el),this.model.get("layout").each(function(e){if(e instanceof x){var i=new O({model:e});i.render(),t.$el.append(i.$el)}else if(e instanceof w){var n=new T({model:e,className:"toolTitleNoSection"});n.render(),t.$el.append(n.$el)}else if(e instanceof b){var r=new M({model:e});r.render(),t.$el.append(r.$el)}}),t.$el.find("a.tool-link").click(function(e){var i=n(this).attr("class").split(/\s+/)[0],r=t.model.get("tools").get(i);t.trigger("tool_link_click",e,r)}),this},handle_search_results:function(){var t=this.model.get("tool_search").get("results");t&&0===t.length?n("#search-no-results").show():n("#search-no-results").hide()}}),E=t.View.extend({className:"toolForm",render:function(){this.$el.children().remove(),this.$el.append(z.tool_form(this.model.toJSON()))}}),z=(t.View.extend({className:"toolMenuAndView",initialize:function(){this.tool_panel_view=new R({collection:this.collection}),this.tool_form_view=new E},render:function(){this.tool_panel_view.render(),this.tool_panel_view.$el.css("float","left"),this.$el.append(this.tool_panel_view.$el),this.tool_form_view.$el.hide(),this.$el.append(this.tool_form_view.$el);var t=this;this.tool_panel_view.on("tool_link_click",function(e,i){e.preventDefault(),t.show_tool(i)})},show_tool:function(t){var e=this;t.fetch().done(function(){e.tool_form_view.model=t,e.tool_form_view.render(),e.tool_form_view.$el.show(),n("#left").width("650px")})}}),{tool_search:o.template(['<input id="tool-search-query" class="search-query parent-width" name="query" ','placeholder="<%- search_hint_string %>" autocomplete="off" type="text" />','<a id="search-clear-btn" title="clear search (esc)"> </a>','<span id="search-spinner" class="search-spinner fa fa-spinner fa-spin"></span>'].join("")),panel_section:o.template(['<div class="toolSectionTitle" id="title_<%- id %>">','<a href="javascript:void(0)"><span><%- name %></span></a>',"</div>",'<div id="<%- id %>" class="toolSectionBody" style="display: none;">','<div class="toolSectionBg"></div>',"<div>"].join("")),tool_link:o.template(['<a class="<%- id %> tool-link" href="<%= link %>" target="<%- target %>" minsizehint="<%- min_width %>">','<span class="labels">',"<% _.each( labels, function( label ){ %>",'<span class="label label-default label-<%- label %>">',"<%- label %>","</span>","<% }); %>","</span>",'<span class="tool-old-link">',"<%- name %>","</span>"," <%- description %>","</a>"].join("")),tool_form:o.template(['<div class="toolFormTitle"><%- tool.name %> (version <%- tool.version %>)</div>','<div class="toolFormBody">',"<% _.each( tool.inputs, function( input ){ %>",'<div class="form-row">','<label for="<%- input.name %>"><%- input.label %>:</label>','<div class="form-row-input">',"<%= input.html %>","</div>",'<div class="toolParamHelp" style="clear: both;">',"<%- input.help %>","</div>",'<div style="clear: both;"></div>',"</div>","<% }); %>","</div>",'<div class="form-row form-actions">','<input type="submit" class="btn btn-primary" name="runtool_btn" value="Execute" />',"</div>",'<div class="toolHelp">','<div class="toolHelpBody"><% tool.help %></div>',"</div>"].join(""),{variable:"tool"})});e.default={ToolParameter:f,IntegerToolParameter:m,SelectToolParameter:v,Tool:w,ToolCollection:y,ToolSearch:k,ToolPanel:C,ToolPanelView:R,ToolFormView:E}}).call(e,i(2),i(0))},function(t,e,i){"use strict";(function(t,n){function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=i(3),o=r(a),s=i(4),l=(r(s),i(165)),c=r(l),u=i(7),d=r(u),h=i(19),f=r(h),p=i(59),_=r(p),m=i(64),g=r(m);e.default=f.default.extend({initialize:function(t){var e=this;this.deferred=new c.default,f.default.prototype.initialize.call(this,t),this._update(this.model.get("initialmodel")),this.model.get("listen_to_history")&&parent.Galaxy&&parent.Galaxy.currHistoryPanel&&this.listenTo(parent.Galaxy.currHistoryPanel.collection,"change",function(){e.model.get("onchange")()}),this.$el.on("remove",function(){e._destroy()})},_update:function(t){var e=this;t=t||this.model.get("buildmodel"),t?(this.deferred.reset(),this.deferred.execute(function(i){t(i,e),i.then(function(){e._render()})})):this._render()},_destroy:function(){var t=this;this.$el.off().hide(),this.deferred.execute(function(){f.default.prototype.remove.call(t),Galaxy.emit.debug("tool-form-base::_destroy()","Destroy view.")})},_render:function(){var e=this,i=this.model.attributes;this.model.set({title:i.fixed_title||"<b>"+i.name+"</b> "+i.description+" (Galaxy Version "+i.version+")",operations:!i.hide_operations&&this._operations(),onchange:function(){e.deferred.reset(),e.deferred.execute(function(t){e.model.get("postchange")(t,e)})}}),this.render(),this.model.get("collapsible")||this.$el.append(t("<div/>").addClass("ui-margin-top-large").append(this._footer())),this.show_message&&this.message.update({status:"success",message:"Now you are using '"+i.name+"' version "+i.version+", id '"+i.id+"'.",persistent:!1}),this.show_message=!0},_operations:function(){var e=this,i=this.model.attributes,r=new d.default.ButtonMenu({icon:"fa-cubes",title:!i.narrow&&"Versions"||null,tooltip:"Select another tool version"});if(!i.sustain_version&&i.versions&&i.versions.length>1)for(var a in i.versions){var s=i.versions[a];s!=i.version&&r.addMenu({title:"Switch to "+s,version:s,icon:"fa-cube",onclick:function(){e.model.set("id",i.id.replace(i.version,this.version)),e.model.set("version",this.version),e._update()}})}else r.$el.hide();var l=new d.default.ButtonMenu({id:"options",icon:"fa-caret-down",title:!i.narrow&&"Options"||null,tooltip:"View available options"});return i.biostar_url&&(l.addMenu({icon:"fa-question-circle",title:"Question?",onclick:function(){window.open(i.biostar_url+"/p/new/post/")}}),l.addMenu({icon:"fa-search",title:(0,o.default)("Search"),onclick:function(){window.open(i.biostar_url+"/local/search/page/?q="+i.name)}})),l.addMenu({icon:"fa-share",title:(0,o.default)("Share"),onclick:function(){prompt("Copy to clipboard: Ctrl+C, Enter",window.location.origin+Galaxy.root+"root?tool_id="+i.id)}}),Galaxy.user&&Galaxy.user.get("is_admin")&&l.addMenu({icon:"fa-download",title:(0,o.default)("Download"),onclick:function(){window.location.href=Galaxy.root+"api/tools/"+i.id+"/download"}}),i.requirements&&i.requirements.length>0&&l.addMenu({icon:"fa-info-circle",title:(0,o.default)("Requirements"),onclick:function(){!this.requirements_visible||e.portlet.collapsed?(this.requirements_visible=!0,e.portlet.expand(),e.message.update({persistent:!0,message:e._templateRequirements(i),status:"info"})):(this.requirements_visible=!1,e.message.update({message:""}))}}),i.sharable_url&&l.addMenu({icon:"fa-external-link",title:(0,o.default)("See in Tool Shed"),onclick:function(){window.open(i.sharable_url)}}),t.getJSON("/api/webhooks/tool-menu/all",function(t){n.each(t,function(t){t.activate&&t.config.function&&l.addMenu({icon:t.config.icon,title:t.config.title,onclick:function(){new Function("options",t.config.function)(i)}})})}),{menu:l,versions:r}},_footer:function(){var e=this.model.attributes,i=t("<div/>").append(this._templateHelp(e));if(e.citations){var n=g.default.extend(_.default),r=document.createElement("div");i.append(r),new n({propsData:{id:e.id,source:"tools"}}).$mount(r)}return i},_templateHelp:function(e){var i=t("<div/>").addClass("ui-form-help").append(e.help);return i.find("a").attr("target","_blank"),i},_templateRequirements:function(e){var i=e.requirements.length;if(i>0){var r="This tool requires ";n.each(e.requirements,function(t,e){r+=t.name+(t.version?" (Version "+t.version+")":"")+(e<i-2?", ":e==i-2?" and ":"")});var a=t("<a/>").attr("target","_blank").attr("href","https://galaxyproject.org/tools/requirements/").text("here");return t("<span/>").append(r+". Click ").append(a).append(" for more information.")}return"No requirements found."}})}).call(e,i(0),i(1))},,function(t,e){function i(t,e){var i=t[1]||"",r=t[3];if(!r)return i;if(e&&"function"==typeof btoa){var a=n(r);return[i].concat(r.sources.map(function(t){return"/*# sourceURL="+r.sourceRoot+t+" */"})).concat([a]).join("\n")}return[i].join("\n")}function n(t){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t))))+" */"}t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n=i(e,t);return e[2]?"@media "+e[2]+"{"+n+"}":n}).join("")},e.i=function(t,i){"string"==typeof t&&(t=[[null,t,""]]);for(var n={},r=0;r<this.length;r++){var a=this[r][0];"number"==typeof a&&(n[a]=!0)}for(r=0;r<t.length;r++){var o=t[r];"number"==typeof o[0]&&n[o[0]]||(i&&!o[2]?o[2]=i:i&&(o[2]="("+o[2]+") and ("+i+")"),e.push(o))}},e}},function(t,e,i){function n(t){for(var e=0;e<t.length;e++){var i=t[e],n=u[i.id];if(n){n.refs++;for(var r=0;r<n.parts.length;r++)n.parts[r](i.parts[r]);for(;r<i.parts.length;r++)n.parts.push(a(i.parts[r]));n.parts.length>i.parts.length&&(n.parts.length=i.parts.length)}else{for(var o=[],r=0;r<i.parts.length;r++)o.push(a(i.parts[r]));u[i.id]={id:i.id,refs:1,parts:o}}}}function r(){var t=document.createElement("style");return t.type="text/css",d.appendChild(t),t}function a(t){var e,i,n=document.querySelector('style[data-vue-ssr-id~="'+t.id+'"]');if(n){if(p)return _;n.parentNode.removeChild(n)}if(m){var a=f++;n=h||(h=r()),e=o.bind(null,n,a,!1),i=o.bind(null,n,a,!0)}else n=r(),e=s.bind(null,n),i=function(){n.parentNode.removeChild(n)};return e(t),function(n){if(n){if(n.css===t.css&&n.media===t.media&&n.sourceMap===t.sourceMap)return;e(t=n)}else i()}}function o(t,e,i,n){var r=i?"":n.css;if(t.styleSheet)t.styleSheet.cssText=g(e,r);else{var a=document.createTextNode(r),o=t.childNodes;o[e]&&t.removeChild(o[e]),o.length?t.insertBefore(a,o[e]):t.appendChild(a)}}function s(t,e){var i=e.css,n=e.media,r=e.sourceMap;if(n&&t.setAttribute("media",n),r&&(i+="\n/*# sourceURL="+r.sources[0]+" */",i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),t.styleSheet)t.styleSheet.cssText=i;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}var l="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!l)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var c=i(80),u={},d=l&&(document.head||document.getElementsByTagName("head")[0]),h=null,f=0,p=!1,_=function(){},m="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());t.exports=function(t,e,i){p=i;var r=c(t,e);return n(r),function(e){for(var i=[],a=0;a<r.length;a++){var o=r[a],s=u[o.id];s.refs--,i.push(s)}e?(r=c(t,e),n(r)):r=[];for(var a=0;a<i.length;a++){var s=i[a];if(0===s.refs){for(var l=0;l<s.parts.length;l++)s.parts[l]();delete u[s.id]}}}};var g=function(){var t=[];return function(e,i){return t[e]=i,t.filter(Boolean).join("\n")}}()},function(t,e,i){t.exports=i(82)},,,,,function(t,e,i){"use strict";(function(t,n){function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=i(3),o=r(a),s=i(1),l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(s),c=i(57),u=r(c),d=i(11),h=r(d),f=i(24),p=r(f),_=i(28),m=r(_),g=i(17),v=r(g),w=i(4),y=r(w);i(173),i(172),i(174),i(63),i(176),i(164),i(163),i(175),i(14);var b=null,x=null,k=function(){this.initialize&&this.initialize.apply(this,arguments)};k.extend=t.Model.extend;var C=k.extend({initialize:function(t){y.default.cssLoadFile("static/style/jquery.rating.css"),y.default.cssLoadFile("static/style/autocomplete_tagging.css"),y.default.cssLoadFile("static/style/jquery-ui/smoothness/jquery-ui.css"),y.default.cssLoadFile("static/style/library.css"),y.default.cssLoadFile("static/style/trackster.css"),this.baseURL=t},save_viz:function(){Galaxy.modal.show({title:"Saving...",body:"progress"});var t=[];n(".bookmark").each(function(){t.push({position:n(this).children(".position").text(),annotation:n(this).children(".annotation").text()})});var e=x.overview_drawable?x.overview_drawable.config.get_value("name"):null,i={view:x.to_dict(),viewport:{chrom:x.chrom,start:x.low,end:x.high,overview:e},bookmarks:t};return n.ajax({url:Galaxy.root+"visualization/save",type:"POST",dataType:"json",data:{id:x.vis_id,title:x.config.get_value("name"),dbkey:x.dbkey,type:"trackster",vis_json:JSON.stringify(i)}}).success(function(t){Galaxy.modal.hide(),x.vis_id=t.vis_id,x.has_changes=!1,window.history.pushState({},"",t.url+window.location.hash)}).error(function(){Galaxy.modal.show({title:(0,o.default)("Could Not Save"),body:"Could not save visualization. Please try again later.",buttons:{Cancel:function(){Galaxy.modal.hide()}}})})},createButtonMenu:function(){var t=this,e=p.default.create_icon_buttons_menu([{icon_class:"plus-button",title:(0,o.default)("Add tracks"),on_click:function(){h.default.select_datasets({dbkey:x.dbkey},function(t){l.each(t,function(t){x.add_drawable(u.default.object_from_template(t,x,x))})})}},{icon_class:"block--plus",title:(0,o.default)("Add group"),on_click:function(){x.add_drawable(new u.default.DrawableGroup(x,x,{name:"New Group"}))}},{icon_class:"bookmarks",title:(0,o.default)("Bookmarks"),on_click:function(){window.force_right_panel("0px"==n("div#right").css("right")?"hide":"show")}},{icon_class:"globe",title:(0,o.default)("Circster"),on_click:function(){window.location=t.baseURL+"visualization/circster?id="+x.vis_id}},{icon_class:"disk--arrow",title:(0,o.default)("Save"),on_click:function(){t.save_viz()}},{icon_class:"cross-circle",title:(0,o.default)("Close"),on_click:function(){t.handle_unsaved_changes(x)}}],{tooltip_config:{placement:"bottom"}});return this.buttonMenu=e,e},add_bookmark:function(t,e,i){var r=n("#right .unified-panel-body"),a=n("<div/>").addClass("bookmark").appendTo(r),o=n("<div/>").addClass("position").appendTo(a),s=(n("<a href=''/>").text(t).appendTo(o).click(function(){return x.go_to(t),!1}),n("<div/>").text(e).appendTo(a));if(i){var l=n("<div/>").addClass("delete-icon-container").prependTo(a).click(function(){return a.slideUp("fast"),a.remove(),x.has_changes=!0,!1});n("<a href=''/>").addClass("icon-button delete").appendTo(l);s.make_text_editable({num_rows:3,use_textarea:!0,help_text:"Edit bookmark note"}).addClass("annotation")}return x.has_changes=!0,a},create_visualization:function(t,e,i,r,a){var o=this;return x=new u.default.TracksterView(l.extend(t,{header:!1})),x.editor=!0,n.when(x.load_chroms_deferred).then(function(t){if(e){var n=e.chrom,s=e.start,l=e.end,c=e.overview;n&&void 0!==s&&l?x.change_chrom(n,s,l):x.change_chrom(t[0].chrom)}else x.change_chrom(t[0].chrom);if(i)for(var d=0;d<i.length;d++)x.add_drawable(u.default.object_from_template(i[d],x,x));for(var d=0;d<x.drawables.length;d++)if(x.drawables[d].config.get_value("name")===c){x.set_overview(x.drawables[d]);break}if(r)for(var h,d=0;d<r.length;d++)h=r[d],o.add_bookmark(h.position,h.annotation,a);x.has_changes=!1}),this.set_up_router({view:x}),x},set_up_router:function(e){new h.default.TrackBrowserRouter(e),t.history.start()},init_keyboard_nav:function(t){n(document).keyup(function(e){if(!n(e.srcElement).is(":input"))switch(e.which){case 37:t.move_fraction(.25);break;case 38:Math.round(t.viewport_container.height()/15);t.viewport_container.scrollTop(t.viewport_container.scrollTop()-20);break;case 39:t.move_fraction(-.25);break;case 40:Math.round(t.viewport_container.height()/15);t.viewport_container.scrollTop(t.viewport_container.scrollTop()+20)}})},handle_unsaved_changes:function(t){if(t.has_changes){var e=this;Galaxy.modal.show({title:(0,o.default)("Close visualization"),body:"There are unsaved changes to your visualization which will be lost if you do not save them.",buttons:{Cancel:function(){Galaxy.modal.hide()},"Leave without Saving":function(){n(window).off("beforeunload"),window.location=Galaxy.root+"visualization"},Save:function(){n.when(e.save_viz()).then(function(){window.location=Galaxy.root+"visualization"})}}})}else window.location=Galaxy.root+"visualization"}}),S=t.View.extend({initialize:function(){b=new C(Galaxy.root),b.createButtonMenu(),b.buttonMenu.$el.attr("style","float: right"),n("#center .unified-panel-header-inner").append(b.buttonMenu.$el),n("#right .unified-panel-title").append("Bookmarks"),n("#right .unified-panel-icons").append("<a id='add-bookmark-button' class='icon-button menu-button plus-button' href='javascript:void(0);' title='Add bookmark'></a>"),n("#right-border").click(function(){x.resize_window()}),window.force_right_panel("hide"),window.galaxy_config.app.id?this.view_existing():m.default.get("dataset_id")?this.choose_existing_or_new():this.view_new()},choose_existing_or_new:function(){var t=this,e=m.default.get("dbkey"),i={},n={dbkey:e,dataset_id:m.default.get("dataset_id"),hda_ldda:m.default.get("hda_ldda"),gene_region:m.default.get("gene_region")};e&&(i["f-dbkey"]=e),Galaxy.modal.show({title:"View Data in a New or Saved Visualization?",body:"<p><ul style='list-style: disc inside none'>You can add this dataset as:<li>a new track to one of your existing, saved Trackster sessions if they share the genome build: <b>"+(e||"Not available.")+"</b></li><li>or create a new session with this dataset as the only track</li></ul></p>",buttons:{Cancel:function(){window.location=Galaxy.root+"visualizations/list"},"View in saved visualization":function(){t.view_in_saved(n)},"View in new visualization":function(){t.view_new()}}})},view_in_saved:function(t){var e=new v.default({url_base:Galaxy.root+"visualization/list_tracks",embedded:!0});Galaxy.modal.show({title:(0,o.default)("Add Data to Saved Visualization"),body:e.$el,buttons:{Cancel:function(){window.location=Galaxy.root+"visualizations/list"},"Add to visualization":function(){n(parent.document).find("input[name=id]:checked").each(function(){t.id=n(this).val(),window.location=Galaxy.root+"visualization/trackster?"+n.param(t)})}}})},view_existing:function(){var t=window.galaxy_config.app.viz_config;x=b.create_visualization({container:n("#center .unified-panel-body"),name:t.title,vis_id:t.vis_id,dbkey:t.dbkey},t.viewport,t.tracks,t.bookmarks,!0),this.init_editor()},view_new:function(){var t=this;n.ajax({url:Galaxy.root+"api/genomes?chrom_info=True",data:{},error:function(){alert("Couldn't create new browser.")},success:function(e){Galaxy.modal.show({title:(0,o.default)("New Visualization"),body:t.template_view_new(e),buttons:{Cancel:function(){window.location=Galaxy.root+"visualizations/list"},Create:function(){t.create_browser(n("#new-title").val(),n("#new-dbkey").val()),Galaxy.modal.hide()}}});var i=e.map(function(t){return t[1]});window.galaxy_config.app.default_dbkey&&l.contains(i,window.galaxy_config.app.default_dbkey)&&n("#new-dbkey").val(window.galaxy_config.app.default_dbkey),n("#new-title").focus(),n("select[name='dbkey']").select2(),n("#overlay").css("overflow","auto")}})},template_view_new:function(t){for(var e='<form id="new-browser-form" action="javascript:void(0);" method="post" onsubmit="return false;"><div class="form-row"><label for="new-title">Browser name:</label><div class="form-row-input"><input type="text" name="title" id="new-title" value="Unnamed"></input></div><div style="clear: both;"></div></div><div class="form-row"><label for="new-dbkey">Reference genome build (dbkey): </label><div class="form-row-input"><select name="dbkey" id="new-dbkey">',i=0;i<t.length;i++)e+='<option value="'+t[i][1]+'">'+t[i][0]+"</option>";return e+='</select></div><div style="clear: both;"></div></div><div class="form-row">Is the build not listed here? <a href="'+Galaxy.root+'custom_builds">Add a Custom Build</a></div></form>'},create_browser:function(t,e){n(document).trigger("convert_to_values"),x=b.create_visualization({container:n("#center .unified-panel-body"),name:t,dbkey:e},window.galaxy_config.app.gene_region),this.init_editor(),x.editor=!0},init_editor:function(){n("#center .unified-panel-title").text(x.config.get_value("name")+" ("+x.dbkey+")"),window.galaxy_config.app.add_dataset&&n.ajax({url:Galaxy.root+"api/datasets/"+window.galaxy_config.app.add_dataset,data:{hda_ldda:"hda",data_type:"track_config"},dataType:"json",success:function(t){x.add_drawable(u.default.object_from_template(t,x,x))}}),n("#add-bookmark-button").click(function(){var t=x.chrom+":"+x.low+"-"+x.high;return b.add_bookmark(t,"Bookmark description",!0)}),b.init_keyboard_nav(x),n(window).on("beforeunload",function(){if(x.has_changes)return"There are unsaved changes to your visualization that will be lost if you leave this page."})}});e.default={TracksterUI:C,GalaxyApp:S}}).call(e,i(2),i(0))},function(t,e,i){"use strict";(function(t,n){function r(t){return t&&t.__esModule?t:{default:t}}function a(t,e){e||(e=0);var i=Math.pow(10,e);return Math.round(t*i)/i}function o(e){var i=t.Deferred();return t.ajax({type:"HEAD",url:e,beforeSend:function(t){t.setRequestHeader("Range","bytes=0-10")},success:function(t,e,n){i.resolve(206===n.status)}}),i}Object.defineProperty(e,"__esModule",{value:!0});var s=i(3),l=r(s),c=i(1),u=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(c),d=i(11),h=r(d),f=i(74),p=r(f),_=i(13),m=r(_),g=i(75),v=r(g),w=i(76),y=r(w),b=i(77),x=r(b),k=i(10),C=r(k),S=i(46),T=r(S),M=i(15),O=r(M),A=i(148),R=r(A);i(14);var E=u.extend,z={},P=function(t,e){z[t.attr("id")]=e},j=function(e,i,n,r){n=".group",z[e.attr("id")]=r,e.bind("drag",{handle:"."+i,relative:!0},function(e,i){var r,a,o,s,l,c=(t(this),t(this).parent()),u=c.children(".track,.group"),d=z[t(this).attr("id")];if(a=t(this).parents(n),0!==a.length){o=a.position().top,s=o+a.outerHeight();var h=z[a.attr("id")];if(i.offsetY<o)return t(this).insertBefore(a),h.remove_drawable(d),void h.container.add_drawable_before(d,h);if(i.offsetY>s)return t(this).insertAfter(a),h.remove_drawable(d),void h.container.add_drawable(d)}for(a=null,l=0;l<u.length;l++)if(r=t(u.get(l)),o=r.position().top,s=o+r.outerHeight(),r.is(n)&&this!==r.get(0)&&i.offsetY>=o&&i.offsetY<=s)return i.offsetY-o<s-i.offsetY?r.find(".content-div").prepend(this):r.find(".content-div").append(this),d.container&&d.container.remove_drawable(d),void z[r.attr("id")].add_drawable(d);for(l=0;l<u.length&&(r=t(u.get(l)),!(i.offsetY<r.position().top)||r.hasClass("reference-track")||r.hasClass("intro"));l++);l===u.length?this!==u.get(l-1)&&(c.append(this),z[c.attr("id")].move_drawable(d,l)):this!==u.get(l)&&(t(this).insertBefore(u.get(l)),z[c.attr("id")].move_drawable(d,i.deltaY>0?l-1:l))}).bind("dragstart",function(){t(this).addClass("dragging")}).bind("dragend",function(){t(this).removeClass("dragging")})},q="A converter for this dataset is not installed. Please check your datatypes_conf.xml file.",L=["Histogram","Line","Filled","Intensity"],$=function t(e,i,n){if(t.id_counter||(t.id_counter=0),this.id=t.id_counter++,this.view=e,this.container=i,this.drag_handle_class=n.drag_handle_class,this.is_overview=!1,this.action_icons={},this.config=O.default.ConfigSettingCollection.from_models_and_saved_values(this.config_params,n.prefs),this.config.get_value("name")||this.config.set_value("name",n.name),this.config_onchange&&this.config.on("change",this.config_onchange,this),this.container_div=this.build_container_div(),this.header_div=null,!1!==n.header){var r=new p.default.TrackHeaderView({model:this,id:this.id});this.header_div=r.$el,this.container_div.append(this.header_div);var a=r.icons_div;this.action_icons=r.action_icons,this.container_div.hover(function(){a.show()},function(){a.hide()})}};$.prototype.action_icons_def=[{name:"toggle_icon",title:"Hide/show content",css_class:"toggle",on_click_fn:function(t){t.config.get_value("content_visible")?(t.action_icons.toggle_icon.addClass("toggle-expand").removeClass("toggle"),t.hide_contents(),t.config.set_value("content_visible",!1)):(t.action_icons.toggle_icon.addClass("toggle").removeClass("toggle-expand"),t.config.set_value("content_visible",!0),t.show_contents())}},{name:"settings_icon",title:(0,l.default)("Edit settings"),css_class:"gear",on_click_fn:function(t){new O.default.ConfigSettingCollectionView({collection:t.config}).render_in_modal("Configure Track")}},{name:"remove_icon",title:(0,l.default)("Remove"),css_class:"remove-icon",on_click_fn:function(e){t(".tooltip").remove(),e.remove()}}],E($.prototype,{config_params:[{key:"name",label:"Name",type:"text",default_value:""},{key:"content_visible",type:"bool",default_value:!0,hidden:!0}],config_onchange:function(){},init:function(){},changed:function(){this.view.changed()},can_draw:function(){return!(!this.enabled||!this.config.get_value("content_visible"))},request_draw:function(){},_draw:function(t){},to_dict:function(){},set_name:function(t){this.old_name=this.config.get_value("name"),this.config.set_value("name",t)},revert_name:function(){this.old_name&&this.config.set_value("name",this.old_name)},remove:function(){this.changed(),this.container.remove_drawable(this);var e=this.view;this.container_div.hide(0,function(){t(this).remove(),e.update_intro_div()})},build_container_div:function(){},update_icons:function(){},hide_contents:function(){},show_contents:function(){},get_drawables:function(){}});var N=function(t,e,i){$.call(this,t,e,i),this.obj_type=i.obj_type,this.drawables=[]};E(N.prototype,$.prototype,{unpack_drawables:function(t){this.drawables=[];for(var e,i=0;i<t.length;i++)e=at(t[i],this.view,this),this.add_drawable(e)},init:function(){for(var t=0;t<this.drawables.length;t++)this.drawables[t].init()},_draw:function(t){for(var e=0;e<this.drawables.length;e++)this.drawables[e]._draw(t)},to_dict:function(){for(var t=[],e=0;e<this.drawables.length;e++)t.push(this.drawables[e].to_dict());return{prefs:this.config.to_key_value_dict(),obj_type:this.obj_type,drawables:t}},add_drawable:function(t){this.drawables.push(t),t.container=this,this.changed()},add_drawable_before:function(t,e){this.changed();var i=this.drawables.indexOf(e);return-1!==i&&(this.drawables.splice(i,0,t),!0)},replace_drawable:function(t,e,i){var n=this.drawables.indexOf(t);return-1!==n&&(this.drawables[n]=e,i&&t.container_div.replaceWith(e.container_div),this.changed()),n},remove_drawable:function(t){var e=this.drawables.indexOf(t);return-1!==e&&(this.drawables.splice(e,1),t.container=null,this.changed(),!0)},move_drawable:function(t,e){var i=this.drawables.indexOf(t);return-1!==i&&(this.drawables.splice(i,1),this.drawables.splice(e,0,t),this.changed(),!0)},get_drawables:function(){return this.drawables},get_tracks:function(t){for(var e,i=this.drawables.slice(0),n=[];0!==i.length;)e=i.shift(),e instanceof t?n.push(e):e.drawables&&(i=i.concat(e.drawables));return n}});var I=function(e,i,n){if(E(n,{obj_type:"DrawableGroup",drag_handle_class:"group-handle"}),N.call(this,e,i,n),this.content_div=t("<div/>").addClass("content-div").attr("id","group_"+this.id+"_content_div").appendTo(this.container_div),P(this.container_div,this),P(this.content_div,this),j(this.container_div,this.drag_handle_class,".group",this),this.filters_manager=new x.default.FiltersManager(this),this.header_div.after(this.filters_manager.parent_div),this.filters_manager.parent_div.after(t("<div style='clear: both'/>")),this.saved_filters_managers=[],"drawables"in n&&this.unpack_drawables(n.drawables),"filters"in n){var r=this.filters_manager;this.filters_manager=new x.default.FiltersManager(this,n.filters),r.parent_div.replaceWith(this.filters_manager.parent_div),n.filters.visible&&this.setup_multitrack_filtering()}};E(I.prototype,$.prototype,N.prototype,{action_icons_def:[$.prototype.action_icons_def[0],$.prototype.action_icons_def[1],{name:"composite_icon",title:(0,l.default)("Show composite track"),css_class:"layers-stack",on_click_fn:function(e){t(".tooltip").remove(),e.show_composite_track()}},{name:"filters_icon",title:(0,l.default)("Filters"),css_class:"ui-slider-050",on_click_fn:function(t){t.filters_manager.visible()?(t.filters_manager.clear_filters(),t._restore_filter_managers()):(t.setup_multitrack_filtering(),t.request_draw({clear_tile_cache:!0})),t.filters_manager.toggle()}},$.prototype.action_icons_def[2]],build_container_div:function(){var e=t("<div/>").addClass("group").attr("id","group_"+this.id);return this.container&&this.container.content_div.append(e),e},hide_contents:function(){this.tiles_div.hide()},show_contents:function(){this.tiles_div.show(),this.request_draw()},update_icons:function(){var e=this.drawables.length;if(0===e)this.action_icons.composite_icon.hide(),this.action_icons.filters_icon.hide();else if(1===e)this.action_icons.composite_icon.toggle(this.drawables[0]instanceof K),this.action_icons.filters_icon.hide();else{var i,n,r,a=this.drawables[0].get_type(),o=0;for(i=0;i<e;i++){if(r=this.drawables[i],r.get_type()!==a){can_composite=!1;break}r instanceof et&&o++}if(this.drawables[0]instanceof Q?this.action_icons.composite_icon.show():(this.action_icons.composite_icon.hide(),t(".tooltip").remove()),o>1&&o===this.drawables.length){var s,l={};for(r=this.drawables[0],n=0;n<r.filters_manager.filters.length;n++)s=r.filters_manager.filters[n],l[s.name]=[s];for(i=1;i<this.drawables.length;i++)for(r=this.drawables[i],n=0;n<r.filters_manager.filters.length;n++)s=r.filters_manager.filters[n],s.name in l&&l[s.name].push(s);this.filters_manager.remove_all();var c,u;for(var d in l)c=l[d],c.length===o&&(u=new x.default.NumberFilter({name:c[0].name,index:c[0].index}),this.filters_manager.add_filter(u));this.action_icons.filters_icon.toggle(this.filters_manager.filters.length>0)}else this.action_icons.filters_icon.hide()}},_restore_filter_managers:function(){for(var t=0;t<this.drawables.length;t++)this.drawables[t].filters_manager=this.saved_filters_managers[t];this.saved_filters_managers=[]},setup_multitrack_filtering:function(){if(this.filters_manager.filters.length>0){this.saved_filters_managers=[];for(var t=0;t<this.drawables.length;t++){var e=this.drawables[t];this.saved_filters_managers.push(e.filters_manager),e.filters_manager=this.filters_manager}}this.filters_manager.init_filters()},show_composite_track:function(){var t=new K(this.view,this.view,{name:this.config.get_value("name"),drawables:this.drawables});this.container.replace_drawable(this,t,!0);t.request_draw()},add_drawable:function(t){N.prototype.add_drawable.call(this,t),this.update_icons()},remove_drawable:function(t){N.prototype.remove_drawable.call(this,t),this.update_icons()},to_dict:function(){this.filters_manager.visible()&&this._restore_filter_managers();var t=E(N.prototype.to_dict.call(this),{filters:this.filters_manager.to_dict()});return this.filters_manager.visible()&&this.setup_multitrack_filtering(),t},request_draw:function(t){u.each(this.drawables,function(e){e.request_draw(t)})}});var D=n.View.extend({initialize:function(t){E(t,{obj_type:"View"}),N.call(this,"View",t.container,t),this.chrom=null,this.vis_id=t.vis_id,this.dbkey=t.dbkey,this.stand_alone=void 0===t.stand_alone||t.stand_alone,this.label_tracks=[],this.tracks_to_be_redrawn=[],this.max_low=0,this.max_high=0,this.zoom_factor=3,this.min_separation=30,this.has_changes=!1,this.load_chroms_deferred=null,this.render(),this.canvas_manager=new h.default.CanvasManager(this.container.get(0).ownerDocument),this.reset(),this.config=O.default.ConfigSettingCollection.from_models_and_saved_values([{key:"name",label:"Name",type:"text",default_value:""},{key:"a_color",label:"A Color",type:"color",default_value:"#FF0000"},{key:"c_color",label:"C Color",type:"color",default_value:"#00FF00"},{key:"g_color",label:"G Color",type:"color",default_value:"#0000FF"},{key:"t_color",label:"T Color",type:"color",default_value:"#FF00FF"},{key:"n_color",label:"N Color",type:"color",default_value:"#AAAAAA"}],{name:t.name})},render:function(){this.requested_redraw=!1;var e=this.container,i=this;this.top_container=t("<div/>").addClass("top-container").appendTo(e),this.browser_content_div=t("<div/>").addClass("content").appendTo(e),this.bottom_container=t("<div/>").addClass("bottom-container").appendTo(e),this.top_labeltrack=t("<div/>").addClass("top-labeltrack").appendTo(this.top_container),this.viewport_container=t("<div/>").addClass("viewport-container").attr("id","viewport-container").appendTo(this.browser_content_div),this.content_div=this.viewport_container,P(this.viewport_container,i),this.intro_div=t("<div/>").addClass("intro").appendTo(this.viewport_container);t("<div/>").text("Add Datasets to Visualization").addClass("action-button").appendTo(this.intro_div).click(function(){h.default.select_datasets({dbkey:i.dbkey},function(t){u.each(t,function(t){i.add_drawable(at(t,i,i))})})});this.nav_container=t("<div/>").addClass("trackster-nav-container").prependTo(this.top_container),this.nav=t("<div/>").addClass("trackster-nav").appendTo(this.nav_container),this.stand_alone&&(this.nav_container.addClass("stand-alone"),this.nav.addClass("stand-alone")),this.overview=t("<div/>").addClass("overview").appendTo(this.bottom_container),this.overview_viewport=t("<div/>").addClass("overview-viewport").appendTo(this.overview),this.overview_close=t("<a/>").attr("title","Close overview").addClass("icon-button overview-close tooltip").hide().appendTo(this.overview_viewport),this.overview_highlight=t("<div/>").addClass("overview-highlight").hide().appendTo(this.overview_viewport),this.overview_box_background=t("<div/>").addClass("overview-boxback").appendTo(this.overview_viewport),this.overview_box=t("<div/>").addClass("overview-box").appendTo(this.overview_viewport),this.default_overview_height=this.overview_box.height(),this.nav_controls=t("<div/>").addClass("nav-controls").appendTo(this.nav),this.chrom_select=t("<select/>").attr({name:"chrom"}).addClass("chrom-nav").append("<option value=''>Loading</option>").appendTo(this.nav_controls);var n=function(e){"focusout"!==e.type&&13!==(e.keyCode||e.which)&&27!==(e.keyCode||e.which)||(27!==(e.keyCode||e.which)&&i.go_to(t(this).val()),t(this).hide(),t(this).val(""),i.location_span.show(),i.chrom_select.show()),e.stopPropagation()};this.nav_input=t("<input/>").addClass("nav-input").hide().bind("keyup focusout",n).appendTo(this.nav_controls),this.location_span=t("<span/>").addClass("location").attr("title","Click to change location").tooltip({placement:"bottom"}).appendTo(this.nav_controls),this.location_span.click(function(){i.location_span.hide(),i.chrom_select.hide(),i.nav_input.val(i.chrom+":"+i.low+"-"+i.high),i.nav_input.css("display","inline-block"),i.nav_input.select(),i.nav_input.focus(),i.nav_input.autocomplete({source:function(e,n){var r=[],a=t.map(i.get_tracks(et),function(t){return t.data_manager.search_features(e.term).success(function(t){r=r.concat(t)})});t.when.apply(t,a).done(function(){n(t.map(r,function(t){return{label:t[0],value:t[1]}}))})},minLength:2})}),void 0!==this.vis_id&&(this.hidden_input=t("<input/>").attr("type","hidden").val(this.vis_id).appendTo(this.nav_controls)),this.zo_link=t("<a/>").attr("id","zoom-out").attr("title","Zoom out").tooltip({placement:"bottom"}).click(function(){i.zoom_out()}).appendTo(this.nav_controls),this.zi_link=t("<a/>").attr("id","zoom-in").attr("title","Zoom in").tooltip({placement:"bottom"}).click(function(){i.zoom_in()}).appendTo(this.nav_controls),this.load_chroms_deferred=this.load_chroms({low:0}),this.chrom_select.bind("change",function(){i.change_chrom(i.chrom_select.val())}),this.browser_content_div.click(function(e){t(this).find("input").trigger("blur")}),this.browser_content_div.bind("dblclick",function(t){i.zoom_in(t.pageX,this.viewport_container)}),this.overview_box.bind("dragstart",function(t,e){this.current_x=e.offsetX}).bind("drag",function(t,e){var n=e.offsetX-this.current_x;this.current_x=e.offsetX;var r=Math.round(n/i.viewport_container.width()*(i.max_high-i.max_low));i.move_delta(-r)}),this.overview_close.click(function(){i.reset_overview()}),this.viewport_container.bind("draginit",function(t,e){if(t.clientX>i.viewport_container.width()-16)return!1}).bind("dragstart",function(t,e){e.original_low=i.low,e.current_height=t.clientY,e.current_x=e.offsetX}).bind("drag",function(e,n){var r=t(this),a=n.offsetX-n.current_x,o=r.scrollTop()-(e.clientY-n.current_height);r.scrollTop(o),n.current_height=e.clientY,n.current_x=n.offsetX;var s=Math.round(a/i.viewport_container.width()*(i.high-i.low));i.move_delta(s)}),this.top_labeltrack.bind("dragstart",function(e,n){return t("<div/>").addClass("zoom-area").css("height",i.browser_content_div.height()+i.top_labeltrack.height()+1).appendTo(t(this))}).bind("drag",function(e,n){t(n.proxy).css({left:Math.min(e.pageX,n.startX)-i.container.offset().left,width:Math.abs(e.pageX-n.startX)});var r=Math.min(e.pageX,n.startX)-i.container.offset().left,a=Math.max(e.pageX,n.startX)-i.container.offset().left,o=i.high-i.low,s=i.viewport_container.width();i.update_location(Math.round(r/s*o)+i.low,Math.round(a/s*o)+i.low)}).bind("dragend",function(e,n){var r=Math.min(e.pageX,n.startX),a=Math.max(e.pageX,n.startX),o=i.high-i.low,s=i.viewport_container.width(),l=i.low;i.low=Math.round(r/s*o)+l,i.high=Math.round(a/s*o)+l,t(n.proxy).remove(),i.request_redraw()}),this.add_label_track(new W(this,{content_div:this.top_labeltrack})),t(window).bind("resize",function(){this.resize_timer&&clearTimeout(this.resize_timer),this.resize_timer=setTimeout(function(){i.resize_window()},500)}),t(document).bind("redraw",function(){i.redraw()}),this.reset(),t(window).trigger("resize")},get_base_color:function(t){return this.config.get_value(t.toLowerCase()+"_color")||this.config.get_value("n_color")}});E(D.prototype,N.prototype,{changed:function(){this.has_changes=!0},update_intro_div:function(){this.intro_div.toggle(0===this.drawables.length)},trigger_navigate:function(t,e,i,n){if(this.timer&&clearTimeout(this.timer),n){var r=this;this.timer=setTimeout(function(){r.trigger("navigate",t+":"+e+"-"+i)},500)}else view.trigger("navigate",t+":"+e+"-"+i)},update_location:function(t,e){this.location_span.text(m.default.commatize(t)+" - "+m.default.commatize(e)),this.nav_input.val(this.chrom+":"+m.default.commatize(t)+"-"+m.default.commatize(e));var i=this.chrom_select.val();""!==i&&this.trigger_navigate(i,this.low,this.high,!0)},load_chroms:function(e){e.num=100;var i=this,n=t.Deferred();return t.ajax({url:Galaxy.root+"api/genomes/"+this.dbkey,data:e,dataType:"json",success:function(e){if(0!==e.chrom_info.length){if(e.reference){var r=new Z(i);i.add_label_track(r),i.reference_track=r}i.chrom_data=e.chrom_info,i.chrom_select.html(""),i.chrom_select.append(t('<option value="">Select Chrom/Contig</option>'));for(var a=0,o=i.chrom_data.length;a<o;a++){var s=i.chrom_data[a].chrom,l=t("<option>");l.text(s),l.val(s),i.chrom_select.append(l)}e.prev_chroms&&i.chrom_select.append(t('<option value="previous">Previous 100</option>')),e.next_chroms&&i.chrom_select.append(t('<option value="next">Next 100</option>')),i.chrom_start_index=e.start_index,n.resolve(e.chrom_info)}},error:function(){alert("Could not load chroms for this dbkey: "+i.dbkey)}}),n},change_chrom:function(e,i,n){var r=this;if(!r.chrom_data)return void r.load_chroms_deferred.then(function(){r.change_chrom(e,i,n)});if(e&&"None"!==e){if("previous"===e)return void r.load_chroms({low:this.chrom_start_index-100});if("next"===e)return void r.load_chroms({low:this.chrom_start_index+100});var a=t.grep(r.chrom_data,function(t,i){return t.chrom===e})[0];if(void 0===a)return void r.load_chroms({chrom:e},function(){r.change_chrom(e,i,n)});if(e!==r.chrom){r.chrom=e,r.chrom_select.val(r.chrom),r.max_high=a.len-1,r.reset();for(var o=0,s=r.drawables.length;o<s;o++){var l=r.drawables[o];l.init&&l.init()}r.reference_track&&r.reference_track.init()}void 0===i&&void 0===n?(r.low=0,r.high=r.max_high):(r.low=void 0!==i?Math.max(i,0):0,void 0===n?(r.low=Math.max(r.low-15,0),r.high=r.low+30):r.high=Math.min(n,r.max_high)),r.request_redraw()}},go_to:function(t){t=t.replace(/,/g,""),t=t.replace(/:|\-/g," ");var e=t.split(/\s+/),i=e[0],n=e[1]?parseInt(e[1],10):void 0,r=e[2]?parseInt(e[2],10):void 0;this.change_chrom(i,n,r)},move_fraction:function(t){var e=this,i=e.high-e.low;this.move_delta(t*i)},move_delta:function(t){var e=this,i=e.high-e.low;e.low-t<e.max_low?(e.low=e.max_low,e.high=e.max_low+i):e.high-t>e.max_high?(e.high=e.max_high,e.low=e.max_high-i):(e.high-=t,e.low-=t),e.request_redraw({data_fetch:!1}),this.redraw_on_move_fn&&clearTimeout(this.redraw_on_move_fn),this.redraw_on_move_fn=setTimeout(function(){e.request_redraw()},200);var n=e.chrom_select.val();this.trigger_navigate(n,e.low,e.high,!0)},add_drawable:function(t){N.prototype.add_drawable.call(this,t),t.init(),this.changed(),this.update_intro_div();var e=this;t.config.on("change",function(){e.changed()})},add_label_track:function(t){t.view=this,t.init(),this.label_tracks.push(t)},remove_drawable:function(e,i){if(N.prototype.remove_drawable.call(this,e),i){var n=this;e.container_div.hide(0,function(){t(this).remove(),n.update_intro_div()})}},reset:function(){this.low=this.max_low,this.high=this.max_high,this.viewport_container.find(".yaxislabel").remove()},request_redraw:function(t,e){var i=this,n=e?[e]:i.drawables;u.each(n,function(e){var n=u.find(i.tracks_to_be_redrawn,function(t){return t[0]===e});n?n[1]=t:i.tracks_to_be_redrawn.push([e,t])}),this.requested_redraw||(requestAnimationFrame(function(){i._redraw()}),this.requested_redraw=!0)},_redraw:function(){this.requested_redraw=!1;var t=this.low,e=this.high;t<this.max_low&&(t=this.max_low),e>this.max_high&&(e=this.max_high);var i=this.high-this.low;0!==this.high&&i<this.min_separation&&(e=t+this.min_separation),this.low=Math.floor(t),this.high=Math.ceil(e),this.update_location(this.low,this.high),this.resolution_px_b=this.viewport_container.width()/(this.high-this.low);var n=this.low/(this.max_high-this.max_low)*this.overview_viewport.width()||0,r=(this.high-this.low)/(this.max_high-this.max_low)*this.overview_viewport.width()||0;this.overview_box.css({left:n,width:Math.max(13,r)}).show(),r<13&&this.overview_box.css("left",n-(13-r)/2),this.overview_highlight&&this.overview_highlight.css({left:n,width:r}),u.each(this.tracks_to_be_redrawn,function(t){var e=t[0],i=t[1];e&&e._draw(i)}),this.tracks_to_be_redrawn=[],u.each(this.label_tracks,function(t){t._draw()})},zoom_in:function(t,e){if(!(0===this.max_high||this.high-this.low<=this.min_separation)){var i=this.high-this.low,n=i/2+this.low,r=i/this.zoom_factor/2;t&&(n=t/this.viewport_container.width()*(this.high-this.low)+this.low),this.low=Math.round(n-r),this.high=Math.round(n+r),this.changed(),this.request_redraw()}},zoom_out:function(){if(0!==this.max_high){var t=this.high-this.low,e=t/2+this.low,i=t*this.zoom_factor/2;this.low=Math.round(e-i),this.high=Math.round(e+i),this.changed(),this.request_redraw()}},resize_viewport:function(){this.viewport_container.height(this.container.height()-this.top_container.height()-this.bottom_container.height())},resize_window:function(){this.resize_viewport(),this.request_redraw()},set_overview:function(t){if(this.overview_drawable){if(this.overview_drawable.dataset.id===t.dataset.id)return;this.overview_viewport.find(".track").remove()}var e=t.copy({content_div:this.overview_viewport}),i=this;e.header_div.hide(),e.is_overview=!0,i.overview_drawable=e,this.overview_drawable.postdraw_actions=function(){i.overview_highlight.show().height(i.overview_drawable.content_div.height()),i.overview_viewport.height(i.overview_drawable.content_div.height()+i.overview_box.outerHeight()),i.overview_close.show(),i.resize_window()},i.overview_drawable.request_draw(),this.changed()},reset_overview:function(){t(".tooltip").remove(),this.overview_viewport.find(".track-tile").remove(),this.overview_viewport.height(this.default_overview_height),this.overview_box.height(this.default_overview_height),this.overview_close.hide(),this.overview_highlight.hide(),view.resize_window(),view.overview_drawable=null}});var G=T.default.Tool.extend({defaults:{track:null},initialize:function(t){T.default.Tool.prototype.initialize.call(this,t);var e=!0;void 0!==t.tool_state&&void 0!==t.tool_state.hidden&&(e=t.tool_state.hidden),this.set("hidden",e),this.remove_inputs(["data","hidden_data","conditional"])},state_dict:function(t){return u.extend(this.get_inputs_dict(),{hidden:!this.is_visible()})}}),U=n.View.extend({events:{"change :input":"update_value"},render:function(){var e=this.$el.addClass("param-row"),i=this.model;t("<div>").addClass("param-label").text(i.get("label")).appendTo(e);t("<div/>").addClass("param-input").html(i.get("html")).appendTo(e).find(":input").val(i.get("value")),t("<div style='clear: both;'/>").appendTo(e)},update_value:function(e){this.model.set_value(t(e.target).val())}}),B=n.View.extend({initialize:function(t){this.model.on("change:hidden",this.set_visible,this)},render:function(){var e=this,i=this.model,n=this.$el.addClass("dynamic-tool").hide();n.bind("drag",function(t){t.stopPropagation()}).click(function(t){t.stopPropagation()}).bind("dblclick",function(t){t.stopPropagation()}).keydown(function(t){t.stopPropagation()});t("<div class='tool-name'>").appendTo(n).text(i.get("name"));i.get("inputs").each(function(t){var e=new U({model:t});e.render(),n.append(e.$el)}),n.find("input").click(function(){t(this).select()});var r=t("<div>").addClass("param-row").appendTo(n),a=t("<input type='submit'>").attr("value","Run on complete dataset").appendTo(r);t("<input type='submit'>").attr("value","Run on visible region").appendTo(r).click(function(){e.run_on_region()}),a.click(function(){e.run_on_dataset()}),i.is_visible()&&this.$el.show()},set_visible:function(){this.$el.toggle(this.model.is_visible())},update_params:function(){for(var t=0;t<this.params.length;t++)this.params[t].update_value()},run_on_dataset:function(){var t=this.model;this.run({target_dataset_id:this.model.get("track").dataset.id,action:"rerun",tool_id:t.id},null,function(e){Galaxy.modal.show({title:t.get("name")+" is Running",body:t.get("name")+" is running on the complete dataset. Tool outputs are in dataset's history.",buttons:{Close:function(){Galaxy.modal.hide()}}})})},run_on_region:function(){var t,e=this.model.get("track"),i=this.model,n=new h.default.GenomeRegion({chrom:e.view.chrom,start:e.view.low,end:e.view.high}),r={target_dataset_id:e.dataset.id,action:"rerun",tool_id:i.id,regions:[n.toJSON()]},a=e,o=i.get("name")+a.tool_region_and_parameters_str(n);if(a.container===view){var s=new I(view,view,{name:e.config.get_value("name")}),l=a.container.replace_drawable(a,s,!1);s.container_div.insertBefore(a.view.content_div.children()[l]),s.add_drawable(a),a.container_div.appendTo(s.content_div),t=s}else t=a.container;var c=new a.constructor(view,t,{name:o,hda_ldda:"hda"});c.init_for_tool_data(),c.change_mode(a.mode),c.set_filters_manager(a.filters_manager.copy(c)),c.update_icons(),t.add_drawable(c),c.tiles_div.text("Starting job."),this.run(r,c,function(t){c.set_dataset(new C.default.Dataset(t)),c.tiles_div.text("Running job."),c.init()})},run:function(e,i,n){e.inputs=this.model.get_inputs_dict();var r=new m.default.ServerStateDeferred({ajax_settings:{url:Galaxy.root+"api/tools",data:JSON.stringify(e),dataType:"json",contentType:"application/json",type:"POST"},interval:2e3,success_fn:function(t){return"pending"!==t}});t.when(r.go()).then(function(t){"no converter"===t?(i.container_div.addClass("error"),i.content_div.text(q)):t.error?(i.container_div.addClass("error"),i.content_div.text("Tool cannot be rerun: "+t.message)):n(t)})}}),F=function(t,e){y.default.Scaler.call(this,e),this.filter=t};F.prototype.gen_val=function(t){return this.filter.high===Number.MAX_VALUE||this.filter.low===-Number.MAX_VALUE||this.filter.low===this.filter.high?this.default_val:(parseFloat(t[this.filter.index])-this.filter.low)/(this.filter.high-this.filter.low)};var V=function(e,i,n,r,a){this.track=e,this.region=i,this.low=i.get("start"),this.high=i.get("end"),this.w_scale=n,this.canvas=r,this.html_elt=t("<div class='track-tile'/>").append(r),this.data=a,this.stale=!1};V.prototype.predisplay_actions=function(){};var H=function(t,e,i,n,r){V.call(this,t,e,i,n,r)};H.prototype.predisplay_actions=function(){};var Y=function(t,e,i,n,r,a,o,s,l,c,u){V.call(this,t,e,i,n,r),this.mode=a,this.all_slotted=s,this.feature_mapper=l,this.has_icons=!1,this.incomplete_features=c,this.other_tiles_features_drawn={},this.seq_data=u};E(Y.prototype,V.prototype),Y.prototype.predisplay_actions=function(){};var X=function(e,i,r){E(r,{drag_handle_class:"draghandle"}),$.call(this,e,i,r),this.dataset=null,r.dataset&&(this.dataset=r.dataset instanceof n.Model?r.dataset:new C.default.Dataset(r.dataset)),this.dataset_check_type="converted_datasets_state",this.data_url_extra_params={},this.data_query_wait="data_query_wait"in r?r.data_query_wait:5e3,this.data_manager="data_manager"in r?r.data_manager:new h.default.GenomeDataManager({dataset:this.dataset,genome:new h.default.Genome({key:e.dbkey,chroms_info:{chrom_info:e.chrom_data}}),data_mode_compatible:this.data_and_mode_compatible,can_subset:this.can_subset}),this.min_height_px=16,this.max_height_px=800,this.visible_height_px=this.config.get_value("height"),this.content_div=t("<div class='track-content'>").appendTo(this.container_div),this.container&&(this.container.content_div.append(this.container_div),"resize"in r&&!r.resize||this.add_resize_handle())};E(X.prototype,$.prototype,{action_icons_def:[{name:"mode_icon",title:(0,l.default)("Set display mode"),css_class:"chevron-expand",on_click_fn:function(){}},$.prototype.action_icons_def[0],{name:"overview_icon",title:(0,l.default)("Set as overview"),css_class:"application-dock-270",on_click_fn:function(t){t.view.set_overview(t)}},$.prototype.action_icons_def[1],{name:"filters_icon",title:(0,l.default)("Filters"),css_class:"ui-slider-050",on_click_fn:function(t){t.filters_manager.visible()?t.filters_manager.clear_filters():t.filters_manager.init_filters(),t.filters_manager.toggle()}},{name:"tools_icon",title:(0,l.default)("Tool"),css_class:"hammer",on_click_fn:function(e){e.tool.toggle(),e.tool.is_visible()?e.set_name(e.config.get_value("name")+e.tool_region_and_parameters_str()):e.revert_name(),t(".tooltip").remove()}},{name:"param_space_viz_icon",title:(0,l.default)("Tool parameter space visualization"),css_class:"arrow-split",on_click_fn:function(e){var i="<strong>Tool</strong>:"+e.tool.get("name")+"<br/><strong>Dataset</strong>:"+e.config.get_value("name")+'<br/><strong>Region(s)</strong>: <select name="regions"><option value="cur">current viewing area</option><option value="bookmarks">bookmarks</option><option value="both">current viewing area and bookmarks</option></select>',r=function(){Galaxy.modal.hide(),t(window).unbind("keypress.check_enter_esc")},a=function(){var i,r=t('select[name="regions"] option:selected').val(),a=new h.default.GenomeRegion({chrom:view.chrom,start:view.low,end:view.high}),o=u.map(t(".bookmark"),function(e){return new h.default.GenomeRegion({from_str:t(e).children(".position").text()})});i="cur"===r?[a]:"bookmarks"===r?o:[a].concat(o),Galaxy.modal.hide(),window.location.href=Galaxy.root+"visualization/sweepster?"+t.param({dataset_id:e.dataset.id,hda_ldda:e.dataset.get("hda_ldda"),regions:JSON.stringify(new n.Collection(i).toJSON())})};Galaxy.modal.show({title:"Visualize tool parameter space and output from different parameter settings?",body:i,buttons:{No:r,Yes:a}})}},$.prototype.action_icons_def[2]],can_draw:function(){return this.dataset&&$.prototype.can_draw.call(this)},build_container_div:function(){return t("<div/>").addClass("track").attr("id","track_"+this.id)},set_dataset:function(t){this.dataset=t,this.data_manager.set("dataset",t)},on_resize:function(){this.request_draw({clear_tile_cache:!0})},add_resize_handle:function(){var e=this,i=!1,n=!1,r=t("<div class='track-resize'>");t(e.container_div).hover(function(){e.config.get_value("content_visible")&&(i=!0,r.show())},function(){i=!1,n||r.hide()}),r.hide().bind("dragstart",function(i,r){n=!0,r.original_height=t(e.content_div).height()}).bind("drag",function(i,n){var r=Math.min(Math.max(n.original_height+n.deltaY,e.min_height_px),e.max_height_px);t(e.tiles_div).css("height",r),e.visible_height_px=e.max_height_px===r?0:r,e.on_resize()}).bind("dragend",function(t,a){e.tile_cache.clear(),n=!1,i||r.hide(),e.config.set_value("height",e.visible_height_px),e.changed()}).appendTo(e.container_div)},hide_contents:function(){this.tiles_div.hide(),this.container_div.find(".yaxislabel, .track-resize").hide()},show_contents:function(){this.tiles_div.show(),this.container_div.find(".yaxislabel, .track-resize").show(),this.request_draw()},get_type:function(){return this instanceof W?"LabelTrack":this instanceof Z?"ReferenceTrack":this instanceof Q?"LineTrack":this instanceof nt?"ReadTrack":this instanceof it?"VariantTrack":this instanceof K?"CompositeTrack":this instanceof et?"FeatureTrack":""},show_message:function(e){return this.tiles_div.remove(),t("<span/>").addClass("message").html(e).appendTo(this.content_div)},init:function(e){var i=this;if(i.enabled=!1,i.tile_cache.clear(),i.data_manager.clear(),i.content_div.children().remove(),i.container_div.removeClass("nodata error pending"),i.tiles_div=t("<div/>").addClass("tiles").appendTo(i.content_div),i.dataset.id){var n=t.Deferred(),r={hda_ldda:i.dataset.get("hda_ldda"),data_type:this.dataset_check_type,chrom:i.view.chrom,retry:e};return t.getJSON(this.dataset.url(),r,function(e){if(e&&"error"!==e&&"error"!==e.kind)"no converter"===e?(i.container_div.addClass("error"),i.show_message(q)):"no data"===e||void 0!==e.data&&(null===e.data||0===e.data.length)?(i.container_div.addClass("nodata"),i.show_message("No data for this chrom/contig.")):"pending"===e?(i.container_div.addClass("pending"),i.show_message("Preparing data. This can take a while for a large dataset. If the visualization is saved and closed, preparation will continue in the background."),setTimeout(function(){i.init()},i.data_query_wait)):"data"!==e&&"data"!==e.status||(e.valid_chroms&&(i.valid_chroms=e.valid_chroms,i.update_icons()),i.tiles_div.text("Ready for display"),i.view.chrom?(i.tiles_div.text(""),i.tiles_div.css("height",i.visible_height_px+"px"),i.enabled=!0,t.when.apply(t,i.predraw_init()).done(function(){n.resolve(),i.container_div.removeClass("nodata error pending"),i.request_draw()})):n.resolve());else{i.container_div.addClass("error");var r=i.show_message("Cannot display dataset due to an error. ");e.message&&(r.append(t("<a href='javascript:void(0);'></a>").text("View error").click(function(){Galaxy.modal.show({title:(0,l.default)("Trackster Error"),body:"<pre>"+e.message+"</pre>",buttons:{Close:function(){Galaxy.modal.hide()}}})})),r.append(t("<span/>").text(" ")),r.append(t("<a href='javascript:void(0);'></a>").text("Try again").click(function(){i.init(!0)})))}}),this.update_icons(),n}},predraw_init:function(){var e=this;return t.getJSON(e.dataset.url(),{data_type:"data",stats:!0,chrom:e.view.chrom,low:0,high:e.view.max_high,hda_ldda:e.dataset.get("hda_ldda")},function(t){var i=t.data;if(i&&void 0!==i.min&&void 0!==i.max){var n=i.min,r=i.max;n=Math.floor(Math.min(0,Math.max(n,i.mean-2*i.sd))),r=Math.ceil(Math.max(0,Math.min(r,i.mean+2*i.sd))),e.config.set_default_value("min_value",n),e.config.set_default_value("max_value",r),e.config.set_value("min_value",n),e.config.set_value("max_value",r)}})},get_drawables:function(){return this}});var J=function(e,i,n){X.call(this,e,i,n);var r=this;if(j(r.container_div,r.drag_handle_class,".group",r),this.filters_manager=new x.default.FiltersManager(this,"filters"in n?n.filters:null),this.data_manager.set("filters_manager",this.filters_manager),this.filters_available=!1,this.tool=n.tool?new G(u.extend(n.tool,{track:this,tool_state:n.tool_state})):null,this.tile_cache=new h.default.Cache(10),this.left_offset=0,this.header_div&&(this.set_filters_manager(this.filters_manager),this.tool)){var a=new B({model:this.tool});a.render(),this.dynamic_tool_div=a.$el,this.header_div.after(this.dynamic_tool_div)}this.tiles_div=t("<div/>").addClass("tiles").appendTo(this.content_div),this.config.get_value("content_visible")||this.tiles_div.hide(),this.overlay_div=t("<div/>").addClass("overlay").appendTo(this.content_div),n.mode&&this.change_mode(n.mode)};E(J.prototype,$.prototype,X.prototype,{action_icons_def:X.prototype.action_icons_def.concat([{name:"show_more_rows_icon",title:"To minimize track height, not all feature rows are displayed. Click to display more rows.",css_class:"exclamation",on_click_fn:function(e){t(".tooltip").remove(),e.slotters[e.view.resolution_px_b].max_rows*=2,e.request_draw({clear_tile_cache:!0})},hide:!0}]),copy:function(t){var e=this.to_dict();E(e,{data_manager:this.data_manager});var i=new this.constructor(this.view,t,e);return i.change_mode(this.mode),i.enabled=this.enabled,i},set_filters_manager:function(t){this.filters_manager=t,this.header_div.after(this.filters_manager.parent_div)},to_dict:function(){return{track_type:this.get_type(),dataset:{id:this.dataset.id,hda_ldda:this.dataset.get("hda_ldda")},prefs:this.config.to_key_value_dict(),mode:this.mode,filters:this.filters_manager.to_dict(),tool_state:this.tool?this.tool.state_dict():{}}},set_min_max:function(){var e=this;return t.getJSON(e.dataset.url(),{data_type:"data",stats:!0,chrom:e.view.chrom,low:0,high:e.view.max_high,hda_ldda:e.dataset.get("hda_ldda")},function(t){var i=t.data;if(isNaN(parseFloat(e.config.get_value("min_value")))||isNaN(parseFloat(e.config.get_value("max_value")))){var n=i.min,r=i.max;n=Math.floor(Math.min(0,Math.max(n,i.mean-2*i.sd))),r=Math.ceil(Math.max(0,Math.min(r,i.mean+2*i.sd))),e.config.set_value("min_value",n),e.config.set_value("max_value",r)}})},change_mode:function(t){var e=this;return e.mode=t,e.config.set_value("mode",t),"Auto"===t&&this.data_manager.clear(),e.request_draw({clear_tile_cache:!0}),this.action_icons.mode_icon.attr("title","Set display mode (now: "+e.mode+")"),e},update_icons:function(){var t=this;t.action_icons.filters_icon.toggle(t.filters_available),t.action_icons.tools_icon.toggle(null!==t.tool),t.action_icons.param_space_viz_icon.toggle(null!==t.tool)},_gen_tile_cache_key:function(t,e){return t+"_"+e},request_draw:function(t){t&&t.clear_tile_cache&&this.tile_cache.clear(),this.view.request_redraw(t,this)},before_draw:function(){this.max_height_px=0},_draw:function(e){if(this.can_draw()){var i=e&&e.clear_after,n=this.view.low,r=this.view.high,a=this.view.container.width(),o=this.view.resolution_px_b,s=1/o;this.is_overview&&(n=this.view.max_low,r=this.view.max_high,o=a/(view.max_high-view.max_low),s=1/o),this.before_draw(),this.tiles_div.children().addClass("remove");for(var l,c,d=Math.floor(400*s),f=Math.floor(n/d),p=[],_=[];f*d<r;)l=new h.default.GenomeRegion({chrom:this.view.chrom,start:f*d,end:Math.min((f+1)*d,this.view.max_high)}),c=this.draw_helper(l,o,e),p.push(c),t.when(c).then(function(t){_.push(t)}),f+=1;i||this.tiles_div.children(".remove").removeClass("remove").remove();var m=this;t.when.apply(t,p).then(function(){m.tiles_div.children(".remove").remove(),_=u.filter(_,function(t){return null!==t}),0!==_.length&&m.postdraw_actions(_,a,o,i)})}},_add_yaxis_label:function(e,i){var n=this,r="max"===e?"top":"bottom",o="max"===e?"max":"min",s="max"===e?"max_value":"min_value",l=this.container_div.find(".yaxislabel."+r),c=a(n.config.get_value(s),1);i=i||function(){n.request_draw({clear_tile_cache:!0})},0!==l.length?l.text(c):(l=t("<div/>").text(c).make_text_editable({num_cols:12,on_finish:function(e){t(".tooltip").remove(),n.config.set_value(s,a(e,1)),i()},help_text:"Set "+o+" value"}).addClass("yaxislabel "+r).css("color",this.config.get_value("label_color")),this.container_div.prepend(l))},postdraw_actions:function(t,e,i,n){if(u.filter(t,function(t){return t instanceof H}).length>0){this.max_height_px=0;var r=this;u.each(t,function(t){t instanceof H||(t.html_elt.remove(),r.draw_helper(t.region,i,{force:!0,mode:"Coverage"}))}),r._add_yaxis_label("max")}else this.container_div.find(".yaxislabel").remove(),u.find(t,function(t){return t.has_icons})&&u.each(t,function(t){t.has_icons||t.html_elt.css("padding-top",20)})},get_mode:function(t){return this.mode},update_auto_mode:function(t){},_get_drawables:function(){return[this]},draw_helper:function(e,i,n){n||(n={});var r=n.force,a=n.mode||this.mode,o=1/i,s=this,l=this._get_drawables(),c=this._gen_tile_cache_key(i,e),d=r?void 0:s.tile_cache.get_elt(c);if(d)return function(t){return t&&"track"in t}(d)&&s.show_tile(d,i),d;if(!1===n.data_fetch)return null;var h=function(){var t=u.find(L,function(t){return t===a})?"Coverage":a,i=u.map(l,function(i){return i.data_manager.get_data(e,t,o,s.data_url_extra_params)});return view.reference_track&&i.push(view.reference_track.data_manager.get_data(e,a,o,view.reference_track.data_url_extra_params)),i},f=t.Deferred();return s.tile_cache.set_elt(c,f),t.when.apply(t,h()).then(function(){var r,a=h(),o=a;if(u.find(a,function(t){return m.default.is_deferred(t)}))return s.tile_cache.set_elt(c,void 0),void t.when(s.draw_helper(e,i,n)).then(function(t){f.resolve(t)});view.reference_track&&(r=view.reference_track.data_manager.subset_entry(a.pop(),e));var d=[],p=[];u.each(l,function(t,e){var n=t.mode,r=o[e];"Auto"===n&&(n=t.get_mode(r),t.update_auto_mode(n)),d.push(n),p.push(t.get_canvas_height(r,n,i,y))});var _,g=s.view.canvas_manager.new_canvas(),v=e.get("start"),w=e.get("end"),y=Math.ceil((w-v)*i)+s.left_offset,b=u.max(p);g.width=y,g.height=n.height||b;var x=g.getContext("2d");x.translate(s.left_offset,0),l.length>1&&(x.globalAlpha=.5,x.globalCompositeOperation="source-over"),u.each(l,function(t,n){_=t.draw_tile(o[n],x,d[n],e,i,r)}),void 0!==_&&(s.tile_cache.set_elt(c,_),s.show_tile(_,i)),f.resolve(_)}),f},get_canvas_height:function(t,e,i,n){return this.visible_height_px},_draw_line_track_tile:function(t,e,i,n,r){-1!==[void 0,null].indexOf(this.config.get_value("min_value"))&&this.config.set_value("min_value",0),-1!==[void 0,null,0].indexOf(this.config.get_value("max_value"))&&this.config.set_value("max_value",u.max(u.map(t.data,function(t){return t[1]}))||0);var a=e.canvas;return new y.default.LinePainter(t.data,n.get("start"),n.get("end"),this.config.to_key_value_dict(),i).draw(e,a.width,a.height,r),new H(this,n,r,a,t.data)},draw_tile:function(t,e,i,n,r,a){},show_tile:function(t,e){var i=t.html_elt;t.predisplay_actions();var n=Math.round((t.low-(this.is_overview?this.view.max_low:this.view.low))*e);this.left_offset&&(n-=this.left_offset),i.css("left",n),i.hasClass("remove")?i.removeClass("remove"):this.tiles_div.append(i),i.css("height","auto"),this.max_height_px=Math.max(this.max_height_px,i.height()-2),i.parent().children().css("height",this.max_height_px+"px");var r=this.max_height_px;0!==this.visible_height_px&&(r=Math.min(this.max_height_px,this.visible_height_px)),this.tiles_div.css("height",r+"px")},tool_region_and_parameters_str:function(t){var e=this;return" - region=["+(void 0!==t?t.toString():"all")+"], parameters=["+u.values(e.tool.get_inputs_dict()).join(", ")+"]"},data_and_mode_compatible:function(t,e){return"Auto"===e||("Coverage"===e?"bigwig"===t.dataset_type:"bigwig"!==t.dataset_type&&"no_detail"!==t.extra_info)},can_subset:function(t){return!t.message&&"no_detail"!==t.extra_info&&("bigwig"!==t.dataset_type||t.data[1][0]-t.data[0][0]==1)},init_for_tool_data:function(){this.data_manager.set("data_type","raw_data"),this.data_query_wait=1e3,this.dataset_check_type="state"}});var W=function(t,e){X.call(this,t,e,{resize:!1,header:!1}),this.container_div.addClass("label-track")};E(W.prototype,X.prototype,{init:function(){this.enabled=!0},predraw_init:function(){},_draw:function(e){for(var i=this.view,n=i.high-i.low,r=Math.floor(Math.pow(10,Math.floor(Math.log(n)/Math.log(10)))),a=Math.floor(i.low/r)*r,o=this.view.container.width(),s=t("<div/>").addClass("label-container");a<i.high;){var l=Math.floor((a-i.low)/n*o);s.append(t("<div/>").addClass("pos-label").text(m.default.commatize(a)).css({left:l})),a+=r}this.content_div.children(":first").remove(),this.content_div.append(s)}});var K=function(t,e,i){if(J.call(this,t,e,i),this.drawables=[],"drawables"in i){for(var n,r=0;r<i.drawables.length;r++)n=i.drawables[r],this.drawables[r]=at(n,t,null),n.left_offset>this.left_offset&&(this.left_offset=n.left_offset);this.enabled=!0}u.each(this.drawables,function(t){(t instanceof et||t instanceof nt)&&t.change_mode("Coverage")}),this.update_icons(),this.obj_type="CompositeTrack"};E(K.prototype,J.prototype,{display_modes:L,build_config_params:function(){return u.union($.prototype.config_params,[{key:"min_value",label:"Min Value",type:"float",default_value:void 0},{key:"max_value",label:"Max Value",type:"float",default_value:void 0},{key:"mode",type:"string",default_value:this.mode,hidden:!0},{key:"height",type:"int",default_value:30,hidden:!0}])},action_icons_def:[{name:"composite_icon",title:(0,l.default)("Show individual tracks"),css_class:"layers-stack",on_click_fn:function(e){t(".tooltip").remove(),e.show_group()}}].concat(J.prototype.action_icons_def),to_dict:N.prototype.to_dict,add_drawable:N.prototype.add_drawable,unpack_drawables:N.prototype.unpack_drawables,config_onchange:function(){this.set_name(this.config.get_value("name")),this.request_draw({clear_tile_cache:!0})},on_resize:function(){var t=this.visible_height_px;u.each(this.drawables,function(e){e.visible_height_px=t}),X.prototype.on_resize.call(this)},change_mode:function(t){J.prototype.change_mode.call(this,t);for(var e=0;e<this.drawables.length;e++)this.drawables[e].change_mode(t)},init:function(){for(var e=[],i=0;i<this.drawables.length;i++)e.push(this.drawables[i].init());var n=this;t.when.apply(t,e).then(function(){n.enabled=!0,n.request_draw()})},update_icons:function(){this.action_icons.filters_icon.hide(),this.action_icons.tools_icon.hide(),this.action_icons.param_space_viz_icon.hide()},can_draw:$.prototype.can_draw,_get_drawables:function(){return this.drawables},show_group:function(){for(var t,e=new I(this.view,this.container,{name:this.config.get_value("name")}),i=0;i<this.drawables.length;i++)t=this.drawables[i],t.update_icons(),e.add_drawable(t),t.container=e,e.content_div.append(t.container_div);this.container.replace_drawable(this,e,!0);e.request_draw({clear_tile_cache:!0})},before_draw:function(){var t=u.min(u.map(this.drawables,function(t){return t.config.get_value("min_value")})),e=u.max(u.map(this.drawables,function(t){return t.config.get_value("max_value")}));this.config.set_value("min_value",t),this.config.set_value("max_value",e),u.each(this.drawables,function(i){i.config.set_value("min_value",t),i.config.set_value("max_value",e)})},update_all_min_max:function(){var t=this.config.get_value("min_value"),e=this.config.get_value("max_value");u.each(this.drawables,function(i){i.config.set_value("min_value",t),i.config.set_value("max_value",e)}),this.request_draw({clear_tile_cache:!0})},postdraw_actions:function(t,e,i,n){var r,a=-1;for(r=0;r<t.length;r++){var o=t[r].html_elt.find("canvas").height();o>a&&(a=o)}for(r=0;r<t.length;r++){var s=t[r];s.html_elt.find("canvas").height()!==a&&(this.draw_helper(s.region,i,{force:!0,height:a}),s.html_elt.remove())}var l=this,c=function(){l.update_all_min_max()};this._add_yaxis_label("min",c),this._add_yaxis_label("max",c)}});var Z=function(t){J.call(this,t,{content_div:t.top_labeltrack},{resize:!1,header:!1}),this.left_offset=t.canvas_manager.char_width_px,this.container_div.addClass("reference-track"),this.data_url=Galaxy.root+"api/genomes/"+this.view.dbkey,this.data_url_extra_params={reference:!0},this.data_manager=new h.default.GenomeReferenceDataManager({data_url:this.data_url,can_subset:this.can_subset}),this.hide_contents()};E(Z.prototype,$.prototype,J.prototype,{build_config_params:function(){return u.union($.prototype.config_params,[{key:"height",type:"int",default_value:13,hidden:!0}])},init:function(){this.data_manager.clear(),this.enabled=!0},predraw_init:function(){},can_draw:$.prototype.can_draw,draw_helper:function(t,e,i){var n,r=this.tiles_div.is(":visible"),a=null;return e>this.view.canvas_manager.char_width_px?(this.tiles_div.show(),n=!0,a=J.prototype.draw_helper.call(this,t,e,i)):(n=!1,this.tiles_div.hide()),r!==n&&this.view.resize_viewport(),a},can_subset:function(t){return!0},draw_tile:function(t,e,i,n,r){var a=this.data_manager.subset_entry(t,n),o=a.data,s=e.canvas;e.font=e.canvas.manager.default_font,e.textAlign="center";for(var l=0,c=o.length;l<c;l++)e.fillStyle=this.view.get_base_color(o[l]),e.fillText(o[l],Math.floor(l*r),10);return new V(this,n,r,s,a)}});var Q=function(e,i,n){this.mode="Histogram",J.call(this,e,i,n),this.left_offset=30;var r=this;t.when(o(Galaxy.root+"datasets/"+this.dataset.id+"/display")).then(function(t){t&&(r.data_manager=new R.default.BBIDataManager({dataset:r.dataset}))})};E(Q.prototype,$.prototype,J.prototype,{display_modes:L,build_config_params:function(){return u.union($.prototype.config_params,[{key:"color",label:"Color",type:"color"},{key:"min_value",label:"Min Value",type:"float",default_value:void 0},{key:"max_value",label:"Max Value",type:"float",default_value:void 0},{key:"mode",type:"string",default_value:this.mode,hidden:!0},{key:"height",type:"int",default_value:30,hidden:!0}])},config_onchange:function(){this.set_name(this.config.get_value("name")),this.request_draw({clear_tile_cache:!0})},before_draw:function(){},draw_tile:function(t,e,i,n,r){return this._draw_line_track_tile(t,e,i,n,r)},can_subset:function(t){return t.data[1][0]-t.data[0][0]==1},postdraw_actions:function(t,e,i,n){this._add_yaxis_label("max"),this._add_yaxis_label("min")}});var tt=function(t,e,i){this.mode="Heatmap",J.call(this,t,e,i)};E(tt.prototype,$.prototype,J.prototype,{display_modes:["Heatmap"],build_config_params:function(){return u.union($.prototype.config_params,[{key:"pos_color",label:"Positive Color",type:"color",default_value:"#FF8C00"},{key:"neg_color",label:"Negative Color",type:"color",default_value:"#4169E1"},{key:"min_value",label:"Min Value",type:"int",default_value:void 0},{key:"max_value",label:"Max Value",type:"int",default_value:void 0},{key:"mode",type:"string",default_value:this.mode,hidden:!0},{key:"height",type:"int",default_value:500,hidden:!0}])},config_onchange:function(){this.set_name(this.config.get_value("name")),this.request_draw({clear_tile_cache:!0})},predraw_init:function(){var e=this;return t.getJSON(e.dataset.url(),{data_type:"data",stats:!0,chrom:e.view.chrom,low:0,high:e.view.max_high,hda_ldda:e.dataset.get("hda_ldda")},function(t){t.data})},draw_tile:function(t,e,i,n,r){var a=e.canvas;return new y.default.DiagonalHeatmapPainter(t.data,n.get("start"),n.get("end"),this.config.to_key_value_dict(),i).draw(e,a.width,a.height,r),new V(this,n,r,a,t.data)}});var et=function(t,e,i){J.call(this,t,e,i),this.container_div.addClass("feature-track"),this.summary_draw_height=30,this.slotters={},this.start_end_dct={},this.left_offset=200,this.set_painter_from_config()};E(et.prototype,$.prototype,J.prototype,{display_modes:["Auto","Coverage","Dense","Squish","Pack"],build_config_params:function(){return u.union($.prototype.config_params,[{key:"block_color",label:"Block color",type:"color"},{key:"reverse_strand_color",label:"Antisense strand color",type:"color"},{key:"label_color",label:"Label color",type:"color",default_value:"black"},{key:"show_counts",label:"Show summary counts",type:"bool",default_value:!0,help:"Show the number of items in each bin when drawing summary histogram"},{key:"min_value",label:"Histogram minimum",type:"float",default_value:void 0,help:"clear value to set automatically"},{key:"max_value",label:"Histogram maximum",type:"float",default_value:void 0,help:"clear value to set automatically"},{key:"connector_style",label:"Connector style",type:"select",default_value:"fishbones",options:[{label:"Line with arrows",value:"fishbone"},{label:"Arcs",value:"arcs"}]},{key:"mode",type:"string",default_value:this.mode,hidden:!0},{key:"height",type:"int",default_value:0,hidden:!0}])},config_onchange:function(){this.set_name(this.config.get_value("name")),this.set_painter_from_config(),this.request_draw({clear_tile_cache:!0})},set_painter_from_config:function(){"arcs"===this.config.get_value("connector_style")?this.painter=y.default.ArcLinkedFeaturePainter:this.painter=y.default.LinkedFeaturePainter},postdraw_actions:function(e,i,n,r){J.prototype.postdraw_actions.call(this,e,i,n,r);var a,o=this;if(0===u.filter(e,function(t){return t instanceof H}).length){var s={};u.each(u.pluck(e,"incomplete_features"),function(t){u.each(t,function(t){s[t[0]]=t})});var l=this;u.each(e,function(e){var i=u.omit(s,u.map(e.incomplete_features,function(t){return t[0]}));if(i=u.omit(i,u.keys(e.other_tiles_features_drawn)),0!==u.size(i)){var n={data:u.values(i)},r=l.view.canvas_manager.new_canvas(),a=r.getContext("2d");r.height=Math.max(e.canvas.height,l.get_canvas_height(n,e.mode,e.w_scale,100)),r.width=e.canvas.width,a.drawImage(e.canvas,0,0),a.translate(o.left_offset,0);var c=l.draw_tile(n,a,e.mode,e.region,e.w_scale,e.seq_data);t(e.canvas).replaceWith(t(c.canvas)),e.canvas=r,u.extend(e.other_tiles_features_drawn,s)}})}if(o.filters_manager){var c,d=o.filters_manager.filters;for(c=0;c<d.length;c++)d[c].update_ui_elt();var h,f,p=!1;for(a=0;a<e.length;a++)if(e[a].data.length)for(h=e[a].data[0],c=0;c<d.length;c++)if(f=d[c],f.applies_to(h)&&f.min!==f.max){p=!0;break}o.filters_available!==p&&(o.filters_available=p,o.filters_available||o.filters_manager.hide(),o.update_icons())}if(e[0]instanceof Y){var _=!0;for(a=0;a<e.length;a++)if(!e[a].all_slotted){_=!1;break}this.action_icons.show_more_rows_icon.toggle(!_)}else this.action_icons.show_more_rows_icon.hide()},update_auto_mode:function(t){"Auto"===this.mode&&("no_detail"===t&&(t="feature spans"),this.action_icons.mode_icon.attr("title","Set display mode (now: Auto/"+t+")"))},incremental_slots:function(t,e,i){var n=this.view.canvas_manager.dummy_context,r=this.slotters[t];return r&&r.mode===i||(r=new v.default.FeatureSlotter(t,i,100,function(t){return n.measureText(t)}),this.slotters[t]=r),r.slot_features(e)},get_mode:function(t){return"no_detail"===t.extra_info||this.is_overview?"no_detail":this.view.high-this.view.low>12e3?"Squish":"Pack"},get_canvas_height:function(t,e,i,n){if("Coverage"===e||"bigwig"===t.dataset_type)return this.summary_draw_height;var r=this.incremental_slots(i,t.data,e),a=new this.painter(null,null,null,this.config.to_key_value_dict(),e);return Math.max(this.min_height_px,a.get_required_height(r,n))},draw_tile:function(t,e,i,n,r,a,o){var s=this,l=e.canvas,c=n.get("start"),u=n.get("end"),d=this.left_offset;if("bigwig"===t.dataset_type)return this._draw_line_track_tile(t,e,i,n,r);var h=[],f=this.slotters[r].slots,p=!0;if(t.data)for(var _=this.filters_manager.filters,m=0,g=t.data.length;m<g;m++){for(var v,w=t.data[m],y=!1,b=0,x=_.length;b<x;b++)if(v=_[b],v.update_attrs(w),!v.keep(w)){y=!0;break}y||(h.push(w),w[0]in f||(p=!1))}var k=this.filters_manager.alpha_filter?new F(this.filters_manager.alpha_filter):null,C=this.filters_manager.height_filter?new F(this.filters_manager.height_filter):null,S=new this.painter(h,c,u,this.config.to_key_value_dict(),i,k,C,a,function(t){return s.view.get_base_color(t)}),T=null;if(e.fillStyle=this.config.get_value("block_color"),e.font=e.canvas.manager.default_font,e.textAlign="right",t.data){var M=S.draw(e,l.width,l.height,r,f);T=M.feature_mapper,incomplete_features=M.incomplete_features,T.translation=-d}return o?void 0:new Y(s,n,r,l,t.data,i,t.message,p,T,incomplete_features,a)}});var it=function(t,e,i){J.call(this,t,e,i),this.painter=y.default.VariantPainter,this.summary_draw_height=30,this.left_offset=30};E(it.prototype,$.prototype,J.prototype,{display_modes:["Auto","Coverage","Dense","Squish","Pack"],build_config_params:function(){return u.union($.prototype.config_params,[{key:"color",label:"Histogram color",type:"color"},{key:"show_sample_data",label:"Show sample data",type:"bool",default_value:!0},{key:"show_labels",label:"Show summary and sample labels",type:"bool",default_value:!0},{key:"summary_height",label:"Locus summary height",type:"float",default_value:20},{key:"mode",type:"string",default_value:this.mode,hidden:!0},{key:"height",type:"int",default_value:0,hidden:!0}])},config_onchange:function(){this.set_name(this.config.get_value("name")),this.request_draw({clear_tile_cache:!0})},draw_tile:function(t,e,i,n,r){if("bigwig"===t.dataset_type)return this._draw_line_track_tile(t,e,"Histogram",n,r);var a=this.view;return new this.painter(t.data,n.get("start"),n.get("end"),this.config.to_key_value_dict(),i,function(t){return a.get_base_color(t)}).draw(e,e.canvas.width,e.canvas.height,r),new V(this,n,r,e.canvas,t.data)},get_canvas_height:function(t,e,i,n){if("bigwig"===t.dataset_type)return this.summary_draw_height;var r=this.dataset.get_metadata("sample_names")?this.dataset.get_metadata("sample_names").length:0;return 0===r&&0!==t.data.length&&(r=t.data[0][7].match(/,/g),r=null===r?1:r.length+1),new this.painter(null,null,null,this.config.to_key_value_dict(),e).get_required_height(r)},predraw_init:function(){var t=[X.prototype.predraw_init.call(this)];return this.dataset.get_metadata("sample_names")||t.push(this.dataset.fetch()),t},postdraw_actions:function(e,i,n,r){J.prototype.postdraw_actions.call(this,e,i,n,r);var a=u.filter(e,function(t){return t instanceof H}),o=this.dataset.get_metadata("sample_names");if(0===a.length&&this.config.get_value("show_labels")&&o&&o.length>1){var s;if(0===this.container_div.find(".yaxislabel.variant").length&&(s=this.config.get_value("summary_height")/2,this.tiles_div.prepend(t("<div/>").text("Summary").addClass("yaxislabel variant top").css({"font-size":s+"px",top:(this.config.get_value("summary_height")-s)/2+"px"})),this.config.get_value("show_sample_data"))){var l=o.join("<br/>");this.tiles_div.prepend(t("<div/>").html(l).addClass("yaxislabel variant top sample").css({top:this.config.get_value("summary_height")}))}s=("Squish"===this.mode?5:10)+"px",t(this.tiles_div).find(".sample").css({"font-size":s,"line-height":s}),t(this.tiles_div).find(".yaxislabel").css("color",this.config.get_value("label_color"))}else this.container_div.find(".yaxislabel.variant").remove()}});var nt=function(t,e,i){et.call(this,t,e,i),this.painter=y.default.ReadPainter,this.update_icons()};E(nt.prototype,$.prototype,J.prototype,et.prototype,{build_config_params:function(){return u.union($.prototype.config_params,[{key:"block_color",label:"Histogram color",type:"color"},{key:"detail_block_color",label:"Sense strand block color",type:"color",default_value:"#AAAAAA"},{key:"reverse_strand_color",label:"Antisense strand block color",type:"color",default_value:"#DDDDDD"},{key:"label_color",label:"Label color",type:"color",default_value:"black"},{key:"show_insertions",label:"Show insertions",type:"bool",default_value:!1},{key:"show_differences",label:"Show differences only",type:"bool",default_value:!0},{key:"show_counts",label:"Show summary counts",type:"bool",default_value:!0},{key:"mode",type:"string",default_value:this.mode,hidden:!0},{key:"min_value",label:"Histogram minimum",type:"float",default_value:void 0,help:"clear value to set automatically"},{key:"max_value",label:"Histogram maximum",type:"float",default_value:void 0,help:"clear value to set automatically"},{key:"height",type:"int",default_value:0,hidden:!0}])},config_onchange:function(){this.set_name(this.config.get_value("name")),this.request_draw({clear_tile_cache:!0})}});var rt={CompositeTrack:K,DrawableGroup:I,DiagonalHeatmapTrack:tt,FeatureTrack:et,LineTrack:Q,ReadTrack:nt,VariantTrack:it,VcfTrack:it},at=function(t,e,i){if("copy"in t)return t.copy(i);var n=t.obj_type;return n||(n=t.track_type),new rt[n](e,i,t)};e.default={TracksterView:D,DrawableGroup:I,LineTrack:Q,FeatureTrack:et,DiagonalHeatmapTrack:tt,ReadTrack:nt,VariantTrack:it,CompositeTrack:K,object_from_template:at}}).call(e,i(0),i(2))},function(t,e,i){"use strict";(function(t,n,r){function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(3),s=a(o),l=i(4),c=a(l),u=i(7),d=a(u),h=i(12),f=a(h),p=i(47),_=a(p),m=i(27),g=a(m),v=t.View.extend({initialize:function(t){var e=this;this.modal=parent.Galaxy.modal||new f.default.View,this.form=new _.default(c.default.merge({listen_to_history:!0,always_refresh:!1,buildmodel:function(t,i){var r=i.model.attributes,a="",o={},l=r.job_id;l?a=Galaxy.root+"api/jobs/"+l+"/build_for_rerun":(a=Galaxy.root+"api/tools/"+r.id+"/build",o=n.extend({},Galaxy.params),o.tool_id&&delete o.tool_id),r.version&&(o.tool_version=r.version),c.default.get({url:a,data:o,success:function(n){if(!n.display)return void(window.location=Galaxy.root);i.model.set(n),e._customize(i),Galaxy.emit.debug("tool-form-base::_buildModel()","Initial tool model ready.",n),t.resolve()},error:function(e,a){var o=e&&e.err_msg||"Uncaught error.";401==a?window.location=Galaxy.root+"user/login?"+n.param({redirect:Galaxy.root+"?tool_id="+r.id}):i.$el.is(":empty")?i.$el.prepend(new d.default.Message({message:o,status:"danger",persistent:!0,large:!0}).$el):Galaxy.modal&&Galaxy.modal.show({title:(0,s.default)("Tool request failed"),body:o,buttons:{Close:function(){Galaxy.modal.hide()}}}),Galaxy.emit.debug("tool-form-base::_buildModel()","Initial tool model request failed.",e),t.reject()}})},postchange:function(t,e){var i={tool_id:e.model.get("id"),tool_version:e.model.get("version"),inputs:n.extend(!0,{},e.data.create())};e.wait(!0),Galaxy.emit.debug("tool-form::postchange()","Sending current state.",i),c.default.request({type:"POST",url:Galaxy.root+"api/tools/"+e.model.get("id")+"/build",data:i,success:function(i){e.update(i),e.wait(!1),Galaxy.emit.debug("tool-form::postchange()","Received new model.",i),t.resolve()},error:function(e){Galaxy.emit.debug("tool-form::postchange()","Refresh request failed.",e),t.reject()}})}},t)),this.deferred=this.form.deferred,this.setElement("<div/>"),this.$el.append(this.form.$el)},_customize:function(t){var e=this,i=t.model.attributes,n=new d.default.Button({icon:"fa-check",tooltip:"Execute: "+i.name+" ("+i.version+")",title:(0,s.default)("Execute"),cls:"btn btn-primary ui-clear-float",wait_cls:"btn btn-info ui-clear-float",onclick:function(){n.wait(),t.portlet.disable(),e.submit(i,function(){n.unwait(),t.portlet.enable()})}});i.buttons={execute:n},i.job_id&&i.job_remap&&i.inputs.push({label:"Resume dependencies from this job",name:"rerun_remap_job_id",type:"select",display:"radio",ignore:"__ignore__",value:"__ignore__",options:[["Yes",i.job_id],["No","__ignore__"]],help:"The previous run of this tool failed and other tools were waiting for it to finish successfully. Use this option to resume those tools using the new output(s) of this tool run."})},submit:function(t,e){var i=this,a={tool_id:t.id,tool_version:t.version,inputs:this.form.data.create()};if(this.form.trigger("reset"),!i.validate(a))return Galaxy.emit.debug("tool-form::submit()","Submission canceled. Validation failed."),void(e&&e());if(t.action!==Galaxy.root+"tool_runner/index"){var o=n("<form/>").attr({action:t.action,method:t.method,enctype:t.enctype});return r.each(a.inputs,function(t,e){o.append(n("<input/>").attr({name:e,value:t}))}),o.hide().appendTo("body").submit().remove(),void(e&&e())}Galaxy.emit.debug("tool-form::submit()","Validation complete.",a),c.default.request({type:"POST",url:Galaxy.root+"api/tools",data:a,success:function(t){if(e&&e(),i.$el.children().hide(),i.$el.append(i._templateSuccess(t)),t.jobs&&t.jobs.length>0){i.$el.append(n("<div/>",{id:"webhook-view"}));new g.default.WebhookView({urlRoot:Galaxy.root+"api/webhooks/tool",toolId:a.tool_id})}parent.Galaxy&&parent.Galaxy.currHistoryPanel&&parent.Galaxy.currHistoryPanel.refreshContents()},error:function(t){e&&e(),Galaxy.emit.debug("tool-form::submit","Submission failed.",t);var n=!1;if(t&&t.err_data){var r=i.form.data.matchResponse(t.err_data);for(var o in r){i.form.highlight(o,r[o]),n=!0;break}}n||i.modal.show({title:(0,s.default)("Job submission failed"),body:i._templateError(a,t&&t.err_msg),buttons:{Close:function(){i.modal.hide()}}})}})},validate:function(t){var e=t.inputs,i=-1,n=null;for(var r in e){var a=e[r],o=this.form.data.match(r),s=this.form.field_list[o],l=this.form.input_list[o];if(o&&l&&s){if(!l.optional&&null==a)return this.form.highlight(o),!1;if(a&&a.batch){var c=a.values.length,u=c>0&&a.values[0]&&a.values[0].src;if(u)if(null===n)n=u;else if(n!==u)return this.form.highlight(o,"Please select either dataset or dataset list fields for all batch mode fields."),!1;if(-1===i)i=c;else if(i!==c)return this.form.highlight(o,"Please make sure that you select the same number of inputs for all batch mode fields. This field contains <b>"+c+"</b> selection(s) while a previous field contains <b>"+i+"</b>."),!1}}else Galaxy.emit.debug("tool-form::validate()","Retrieving input objects failed.")}return!0},_templateSuccess:function(t){if(t.jobs&&t.jobs.length>0){var e=t.jobs.length,i=1==e?"1 job has":e+" jobs have",a=n("<div/>").addClass("donemessagelarge").append(n("<p/>").text(i+" been successfully added to the queue - resulting in the following datasets:"));return r.each(t.outputs,function(t){a.append(n("<p/>").addClass("messagerow").append(n("<b/>").text(t.hid+": "+t.name)))}),a.append(n("<p/>").append("<b/>").text("You can check the status of queued jobs and view the resulting data by refreshing the History pane. When the job has been run the status will change from 'running' to 'finished' if completed successfully or 'error' if problems were encountered.")),a}return this._templateError(t,"Invalid success response. No jobs found.")},_templateError:function(t,e){return n("<div/>").addClass("errormessagelarge").append(n("<p/>").text("The server could not complete the request. Please contact the Galaxy Team if this error persists. "+(e||""))).append(n("<pre/>").text(JSON.stringify(t,null,4)))}});e.default={View:v}}).call(e,i(2),i(0),i(1))},function(t,e,i){"use strict";function n(t){i(78)}Object.defineProperty(e,"__esModule",{value:!0});var r=i(81),a=i.n(r),o=i(147),s=i(25),l=n,c=s(a.a,o.a,!1,l,null,null);e.default=c.exports},,,,,,function(t,e,i){"use strict";(function(t){function n(t){return t&&t.__esModule?t:{default:t}}function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function a(t,e){return this._init(t||{},e||{})}Object.defineProperty(e,"__esModule",{value:!0});var o=i(1),s=r(o),l=i(2),c=r(l),u=i(5),d=n(u),h=i(45),f=n(h),p=i(66),_=n(p),m=i(26),g=n(m),v=i(3),w=n(v);(0,g.default)(a,"GalaxyApp");var y="galaxy:debug:namespaces",b=!1;try{b="true"==localStorage.getItem("galaxy:debug")}catch(t){console.log((0,w.default)("localStorage not available for debug flag retrieval"))}a.prototype._init=function(t,e){var i=this;return s.extend(i,c.Events),b&&(i.logger=console,console.debug("debugging galaxy:","options:",t,"bootstrapped:",e)),i._processOptions(t),i.root=t.root||"/",i.params=t.params||{},i.session_csrf_token=t.session_csrf_token||null,i._initConfig(t.config||{}),i._patchGalaxy(window.Galaxy),i._initLogger(i.options.loggerOptions||{}),i.debug("GalaxyApp.options: ",i.options),i.debug("GalaxyApp.config: ",i.config),i.debug("GalaxyApp.logger: ",i.logger),i._initLocale(),i.debug("GalaxyApp.localize: ",i.localize),i.config=t.config||{},i.debug("GalaxyApp.config: ",i.config),i._initUser(t.user||{}),i.debug("GalaxyApp.user: ",i.user),i._setUpListeners(),i.trigger("ready",i),i},a.prototype.defaultOptions={patchExisting:!0,root:"/",session_csrf_token:null},a.prototype._processOptions=function(t){var e=this,i=e.defaultOptions;e.options={};for(var n in i)i.hasOwnProperty(n)&&(e.options[n]=t.hasOwnProperty(n)?t[n]:i[n]);return e},a.prototype._initConfig=function(t){var e=this;return e.config=t,e.config.debug=b||e.config.debug,e},a.prototype._patchGalaxy=function(t){var e=this;if(e.options.patchExisting&&t)for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},a.prototype._initLogger=function(t){var e=this;if(e.config.debug){t.consoleLogger=t.consoleLogger||console,t.consoleLevel=t.consoleLevel||_.default.MetricsLogger.ALL;try{t.consoleNamespaceWhitelist=localStorage.getItem(y).split(",")}catch(t){}try{t.consoleFlattenMessages="true"==localStorage.getItem("galaxy:debug:flatten")}catch(t){}console.log(t.consoleFlattenMessages)}return e.logger=new _.default.MetricsLogger(t),e.emit={},["log","debug","info","warn","error","metric"].map(function(t){e.emit[t]=function(i){e.logger.emit(t,arguments[0],Array.prototype.slice.call(arguments,1))}}),e.config.debug&&(d.default.LoggableMixin.logger=e.logger),e},a.prototype._initLocale=function(t){var e=this;return e.debug("_initLocale:",t),e.localize=w.default,window._l=e.localize,e},a.prototype._initUser=function(t){var e=this;return e.debug("_initUser:",t),e.user=new f.default.User(t),e.user.logger=e.logger,e},a.prototype._setUpListeners=function(){var e=this;return e.lastAjax={},t(document).bind("ajaxSend",function(t,i,n){var r=n.data;try{r=JSON.parse(r)}catch(t){}e.lastAjax={url:location.href.slice(0,-1)+n.url,data:r}}),e},a.prototype.debugging=function(t){var e=this;try{if(void 0===t)return"true"===localStorage.getItem("galaxy:debug");if(t)return localStorage.setItem("galaxy:debug",!0),!0;localStorage.removeItem("galaxy:debug"),e.debuggingNamespaces(null)}catch(t){console.log((0,w.default)("localStorage not available for debug flag retrieval"))}return!1},a.prototype.debuggingNamespaces=function(t){var e=this;try{if(void 0===t){var i=localStorage.getItem(y);return"string"==typeof i?i.split(","):[]}null===t?localStorage.removeItem(y):localStorage.setItem(y,t);var n=e.debuggingNamespaces();return e.logger&&(e.logger.options.consoleNamespaceWhitelist=n),n}catch(t){console.log((0,w.default)("localStorage not available for debug namespace retrieval"))}},a.prototype.toString=function(){return"GalaxyApp("+(this.user?this.user.get("email")||"(anonymous)":"uninitialized")+")"},window.Galaxy=window.Galaxy||new a,e.default={GalaxyApp:a}}).call(e,i(0))},function(t,e,i){"use strict";(function(t){function i(t){t=t||{};var e=this;return e.userId=window.bootstrapped&&window.bootstrapped.user?window.bootstrapped.user.id:null,e.userId=e.userId||t.userId||null,e.consoleLogger=t.consoleLogger||null,e._init(t),e}function n(t){var e=String(t);return"[object Object]"==e&&(e=JSON.stringify(t)),e}function r(t){return this._init(t||{})}Object.defineProperty(e,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};i.ALL=0,i.LOG=0,i.DEBUG=10,i.INFO=20,i.WARN=30,i.ERROR=40,i.METRIC=50,i.NONE=100,i.defaultOptions={logLevel:i.NONE,consoleLevel:i.NONE,defaultNamespace:"Galaxy",consoleNamespaceWhitelist:null,consoleFlattenMessages:!1,clientPrefix:"client.",maxCacheSize:3e3,postSize:1e3,addTime:!0,cacheKeyPrefix:"logs-",postUrl:"/api/metrics",delayPostInMs:6e5,getPingData:void 0,onServerResponse:void 0},i.prototype._init=function(t){var e=this;e.options={};for(var n in i.defaultOptions)i.defaultOptions.hasOwnProperty(n)&&(e.options[n]=t.hasOwnProperty(n)?t[n]:i.defaultOptions[n]);return e.options.logLevel=e._parseLevel(e.options.logLevel),e.options.consoleLevel=e._parseLevel(e.options.consoleLevel),e._sending=!1,e._waiting=null,e._postSize=e.options.postSize,e._initCache(),e},i.prototype._initCache=function(){try{this.cache=new r({maxSize:this.options.maxCacheSize,key:this.options.cacheKeyPrefix+this.userId})}catch(t){this._emitToConsole("warn","MetricsLogger",["Could not intitialize logging cache:",t]),this.options.logLevel=i.NONE}},i.prototype._parseLevel=function(t){var e=void 0===t?"undefined":a(t);if("number"===e)return t;if("string"===e){var n=t.toUpperCase();if(i.hasOwnProperty(n))return i[n]}throw new Error("Unknown log level: "+t)},i.prototype.emit=function(t,e,i){var n=this;return e=e||n.options.defaultNamespace,t&&i?(t=n._parseLevel(t),t>=n.options.logLevel&&n._addToCache(t,e,i),n.consoleLogger&&t>=n.options.consoleLevel&&n._emitToConsole(t,e,i),n):n},i.prototype._addToCache=function(t,e,i){this._emitToConsole("debug","MetricsLogger",["_addToCache:",arguments,this.options.addTime,this.cache.length()]);var n=this;try{n.cache.add(n._buildEntry(t,e,i))>=n._postSize&&n._postCache()}catch(t){n._emitToConsole("warn","MetricsLogger",["Metrics logger could not stringify logArguments:",e,i]),n._emitToConsole("error","MetricsLogger",[t])}return n},i.prototype._buildEntry=function(t,e,i){this._emitToConsole("debug","MetricsLogger",["_buildEntry:",arguments]);var n={level:t,namespace:this.options.clientPrefix+e,args:i};return this.options.addTime&&(n.time=(new Date).toISOString()),n},i.prototype._postCache=function(e){if(e=e||{},this._emitToConsole("info","MetricsLogger",["_postCache",e,this._postSize]),!this.options.postUrl||this._sending)return t.when({});var i=this,n=e.count||i._postSize,r=i.cache.get(n),a=r.length,o="function"==typeof i.options.getPingData?i.options.getPingData():{};return o.metrics=JSON.stringify(r),i._sending=!0,t.post(i.options.postUrl,o).always(function(){i._sending=!1}).fail(function(t,e,n){i._postSize=i.options.maxCacheSize,i.emit("error","MetricsLogger",["_postCache error:",t.readyState,t.status,t.responseJSON||t.responseText])}).done(function(t){"function"==typeof i.options.onServerResponse&&i.options.onServerResponse(t),i.cache.remove(a),i._postSize=i.options.postSize})},i.prototype._delayPost=function(){var t=this;t._waiting=setTimeout(function(){t._waiting=null},t.options.delayPostInMs)},i.prototype._emitToConsole=function(t,e,r){var a=this,o=a.options.consoleNamespaceWhitelist;if(!a.consoleLogger)return a;if(o&&-1===o.indexOf(e))return a;var s=Array.prototype.slice.call(r,0);return s.unshift(e),a.options.consoleFlattenMessages&&(s=[s.map(n).join(" ")]),t>=i.METRIC&&"function"==typeof a.consoleLogger.info?a.consoleLogger.info.apply(a.consoleLogger,s):t>=i.ERROR&&"function"==typeof a.consoleLogger.error?a.consoleLogger.error.apply(a.consoleLogger,s):(t>=i.WARN&&"function"==typeof a.consoleLogger.warn?a.consoleLogger.warn.apply(a.consoleLogger,s):t>=i.INFO&&"function"==typeof a.consoleLogger.info?a.consoleLogger.info.apply(a.consoleLogger,s):t>=i.DEBUG&&"function"==typeof a.consoleLogger.debug?a.consoleLogger.debug.apply(a.consoleLogger,s):"function"==typeof a.consoleLogger.log&&a.consoleLogger.log.apply(a.consoleLogger,s),a)},i.prototype.log=function(){this.emit(1,this.options.defaultNamespace,Array.prototype.slice.call(arguments,0))},i.prototype.debug=function(){this.emit(i.DEBUG,this.options.defaultNamespace,Array.prototype.slice.call(arguments,0))},i.prototype.info=function(){this.emit(i.INFO,this.options.defaultNamespace,Array.prototype.slice.call(arguments,0))},i.prototype.warn=function(){this.emit(i.WARN,this.options.defaultNamespace,Array.prototype.slice.call(arguments,0))},i.prototype.error=function(){this.emit(i.ERROR,this.options.defaultNamespace,Array.prototype.slice.call(arguments,0))},i.prototype.metric=function(){this.emit(i.METRIC,this.options.defaultNamespace,Array.prototype.slice.call(arguments,0))},r.defaultOptions={maxSize:5e3},r.prototype._init=function(t){if(!this._hasStorage())throw new Error("LoggingCache needs localStorage");if(!t.key)throw new Error("LoggingCache needs key for localStorage");return this.key=t.key,this._initStorage(),this.maxSize=t.maxSize||r.defaultOptions.maxSize,this},r.prototype._hasStorage=function(){try{return localStorage.setItem("test","test"),localStorage.removeItem("test"),!0}catch(t){return!1}},r.prototype._initStorage=function(){return null===localStorage.getItem(this.key)?this.empty():this},r.prototype.add=function(t){var e=this,i=e._fetchAndParse(),n=i.length+1-e.maxSize;return n>0&&i.splice(0,n),i.push(t),e._unparseAndStore(i),i.length},r.prototype._fetchAndParse=function(){var t=this;return JSON.parse(localStorage.getItem(t.key))},r.prototype._unparseAndStore=function(t){var e=this;return localStorage.setItem(e.key,JSON.stringify(t))},r.prototype.length=function(){return this._fetchAndParse().length},r.prototype.get=function(t){return this._fetchAndParse().slice(0,t)},r.prototype.remove=function(t){var e=this._fetchAndParse(),i=e.splice(0,t);return this._unparseAndStore(e),i},r.prototype.empty=function(){return localStorage.setItem(this.key,"[]"),this},r.prototype.stringify=function(t){return JSON.stringify(this.get(t))},r.prototype.print=function(){console.log(JSON.stringify(this._fetchAndParse(),null,"  "))},e.default={MetricsLogger:i,LoggingCache:r}}).call(e,i(0))},function(t,e,i){"use strict";(function(t,n){function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=i(4),o=(r(a),i(68)),s=r(o),l=i(70),c=r(l),u=i(153),d=r(u),h=t.View.extend({initialize:function(t){var e=this;this.options=t,this.setElement(this._template()),this.$navbarBrandLink=this.$(".navbar-brand-link"),this.$navbarBrandImage=this.$(".navbar-brand-image"),this.$navbarBrandTitle=this.$(".navbar-brand-title"),this.$navbarTabs=this.$(".navbar-tabs"),this.$quoteMeter=this.$(".quota-meter-container"),this.collection=new s.default.Collection,this.collection.on("add",function(t){e.$navbarTabs.append(new s.default.Tab({model:t}).render().$el)}).on("reset",function(){e.$navbarTabs.empty()}).on("dispatch",function(t){e.collection.each(function(e){t(e)})}).fetch(this.options),Galaxy.frame=this.frame=new c.default({collection:this.collection}),Galaxy.quotaMeter=this.quotaMeter=new d.default.UserQuotaMeter({model:Galaxy.user,el:this.$quoteMeter}),n(window).on("click",function(t){var e=n(t.target).closest("a[download]");1==e.length&&(0===n("iframe[id=download]").length&&n("body").append(n("<iframe/>").attr("id","download").hide()),n("iframe[id=download]").attr("src",e.attr("href")),t.preventDefault())}).on("beforeunload",function(){var t="";if(e.collection.each(function(e){var i=e.get("onbeforeunload")&&e.get("onbeforeunload")();i&&(t+=i+" ")}),""!==t)return t})},render:function(){return this.$navbarBrandTitle.html("Galaxy "+(this.options.brand&&"/ "+this.options.brand||"")),this.$navbarBrandLink.attr("href",this.options.logo_url),this.$navbarBrandImage.attr("src",this.options.logo_src),this.quotaMeter.render(),this},_template:function(){return'<div id="masthead" class="navbar navbar-fixed-top navbar-inverse"><div class="navbar-header"><div class="navbar-tabs"/></div><div class="navbar-brand"><a class="navbar-brand-link"><img class="navbar-brand-image"/><span class="navbar-brand-title"/></a></div><div class="quota-meter-container"/><div class="navbar-icons"/></div>'}});e.default={View:h}}).call(e,i(2),i(0))},function(t,e,i){"use strict";(function(t,n,r,a){function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=i(69),l=o(s),c=i(27),u=o(c),d=i(3),h=o(d),f=i(4),p=o(f),_=t.Collection.extend({model:t.Model.extend({defaults:{visible:!0,target:"_parent"}}),fetch:function(t){t=t||{},this.reset();var e=new l.default.GenericNavView;this.add(e.render()),this.add({id:"analysis",title:(0,h.default)("Analyze Data"),url:"",tooltip:(0,h.default)("Analysis home view")}),this.add({id:"workflow",title:(0,h.default)("Workflow"),tooltip:(0,h.default)("Chain tools into workflows"),disabled:!Galaxy.user.id,url:"workflows/list"}),this.add({id:"shared",title:(0,h.default)("Shared Data"),url:"library/index",tooltip:(0,h.default)("Access published resources"),menu:[{title:(0,h.default)("Data Libraries"),url:"library/list"},{title:(0,h.default)("Histories"),url:"histories/list_published"},{title:(0,h.default)("Workflows"),url:"workflows/list_published"},{title:(0,h.default)("Visualizations"),url:"visualizations/list_published"},{title:(0,h.default)("Pages"),url:"pages/list_published"}]}),this.add({id:"visualization",title:(0,h.default)("Visualization"),url:"visualizations/list",tooltip:(0,h.default)("Visualize datasets"),disabled:!Galaxy.user.id,menu:[{title:(0,h.default)("New Track Browser"),url:"visualization/trackster",target:"_frame"},{title:(0,h.default)("Saved Visualizations"),url:"visualizations/list",target:"_frame"},{title:(0,h.default)("Interactive Environments"),url:"visualization/gie_list",target:"galaxy_main"}]}),u.default.add({url:"api/webhooks/masthead/all",callback:function(t){n(document).ready(function(){n.each(t.models,function(t,e){var i=e.toJSON();if(i.activate){var n={id:i.name,icon:i.config.icon,url:i.config.url,tooltip:i.config.tooltip,onclick:i.config.function&&new Function(i.config.function)};Galaxy.page?Galaxy.page.masthead.collection.add(n):Galaxy.masthead&&Galaxy.masthead.collection.add(n),p.default.appendScriptStyle(i)}})})}}),Galaxy.user.get("is_admin")&&this.add({id:"admin",title:(0,h.default)("Admin"),url:"admin",tooltip:(0,h.default)("Administer this Galaxy"),cls:"admin-only"});var i={id:"help",title:(0,h.default)("Help"),tooltip:(0,h.default)("Support, contact, and community"),menu:[{title:(0,h.default)("Support"),url:t.support_url,target:"_blank"},{title:(0,h.default)("Search"),url:t.search_url,target:"_blank"},{title:(0,h.default)("Mailing Lists"),url:t.mailing_lists,target:"_blank"},{title:(0,h.default)("Videos"),url:t.screencasts_url,target:"_blank"},{title:(0,h.default)("Wiki"),url:t.wiki_url,target:"_blank"},{title:(0,h.default)("How to Cite Galaxy"),url:t.citation_url,target:"_blank"},{title:(0,h.default)("Interactive Tours"),url:"tours"}]};t.terms_url&&i.menu.push({title:(0,h.default)("Terms and Conditions"),url:t.terms_url,target:"_blank"}),t.biostar_url&&i.menu.unshift({title:(0,h.default)("Ask a question"),url:"biostar/biostar_question_redirect",target:"_blank"}),t.biostar_url&&i.menu.unshift({title:(0,h.default)("Galaxy Biostar"),url:t.biostar_url_redirect,target:"_blank"}),this.add(i);var a={};a=Galaxy.user.id?{id:"user",title:(0,h.default)("User"),cls:"loggedin-only",tooltip:(0,h.default)("Account and saved data"),menu:[{title:(0,h.default)("Logged in as")+" "+Galaxy.user.get("email")},{title:(0,h.default)("Preferences"),url:"user"},{title:(0,h.default)("Custom Builds"),url:"custom_builds"},{title:(0,h.default)("Logout"),url:"user/logout?session_csrf_token="+Galaxy.session_csrf_token,target:"_top",divider:!0},{title:(0,h.default)("Saved Histories"),url:"histories/list",target:"_top"},{title:(0,h.default)("Saved Datasets"),url:"datasets/list",target:"_top"},{title:(0,h.default)("Saved Pages"),url:"pages/list",target:"_top"}]}:t.allow_user_creation?{id:"user",title:(0,h.default)("Login or Register"),cls:"loggedout-only",tooltip:(0,h.default)("Account registration or login"),menu:[{title:(0,h.default)("Login"),url:"user/login",target:"galaxy_main",noscratchbook:!0},{title:(0,h.default)("Register"),url:"user/create",target:"galaxy_main",noscratchbook:!0}]}:{id:"user",title:(0,h.default)("Login"),cls:"loggedout-only",tooltip:(0,h.default)("Login"),url:"user/login",target:"galaxy_main",noscratchbook:!0},this.add(a);var o=this.get(t.active_view);return o&&o.set("active",!0),(new r.Deferred).resolve().promise()}}),m=t.View.extend({initialize:function(t){this.model=t.model,this.setElement(this._template()),this.$dropdown=this.$(".dropdown"),this.$toggle=this.$(".dropdown-toggle"),this.$menu=this.$(".dropdown-menu"),this.$note=this.$(".dropdown-note"),this.listenTo(this.model,"change",this.render,this)},events:{"click .dropdown-toggle":"_toggleClick"},render:function(){var t=this;return n(".tooltip").remove(),this.$el.attr("id",this.model.id).css({visibility:this.model.get("visible")&&"visible"||"hidden"}),this.model.set("url",this._formatUrl(this.model.get("url"))),this.$note.html(this.model.get("note")||"").removeClass().addClass("dropdown-note").addClass(this.model.get("note_cls")).css({display:this.model.get("show_note")&&"block"||"none"}),this.$toggle.html(this.model.get("title")||"").removeClass().addClass("dropdown-toggle").addClass(this.model.get("cls")).addClass(this.model.get("icon")&&"dropdown-icon fa "+this.model.get("icon")).addClass(this.model.get("toggle")&&"toggle").attr("target",this.model.get("target")).attr("href",this.model.get("url")).attr("title",this.model.get("tooltip")).tooltip("destroy"),this.model.get("tooltip")&&this.$toggle.tooltip({placement:"bottom"}),this.$dropdown.removeClass().addClass("dropdown").addClass(this.model.get("disabled")&&"disabled").addClass(this.model.get("active")&&"active"),this.model.get("menu")&&this.model.get("show_menu")?(this.$menu.show(),n("#dd-helper").show().off().on("click",function(){n("#dd-helper").hide(),t.model.set("show_menu",!1)})):(t.$menu.hide(),n("#dd-helper").hide()),this.$menu.empty().removeClass("dropdown-menu"),this.model.get("menu")&&(a.each(this.model.get("menu"),function(e){t.$menu.append(t._buildMenuItem(e)),e.divider&&t.$menu.append(n("<li/>").addClass("divider"))}),t.$menu.addClass("dropdown-menu"),t.$toggle.append(n("<b/>").addClass("caret"))),this},_buildMenuItem:function(t){var e=this;return t=a.defaults(t||{},{title:"",url:"",target:"_parent",noscratchbook:!1}),t.url=e._formatUrl(t.url),n("<li/>").append(n("<a/>").attr("href",t.url).attr("target",t.target).html(t.title).on("click",function(i){i.preventDefault(),e.model.set("show_menu",!1),t.onclick?t.onclick():Galaxy.frame.add(t)}))},_toggleClick:function(t){var e=this,i=this.model;if(t.preventDefault(),n(".tooltip").hide(),i.trigger("dispatch",function(t){i.id!==t.id&&t.get("menu")&&t.set("show_menu",!1)}),i.get("disabled")){var r=function(t,e){return n("<div/>").append(n("<a/>").attr("href",Galaxy.root+e).html(t)).html()};this.$toggle.popover&&this.$toggle.popover("destroy"),this.$toggle.popover({html:!0,placement:"bottom",content:"Please "+r("login","user/login?use_panels=True")+" or "+r("register","user/create?use_panels=True")+" to use this feature."}).popover("show"),setTimeout(function(){e.$toggle.popover("destroy")},5e3)}else i.get("menu")?i.set("show_menu",!0):i.get("onclick")?i.get("onclick")():Galaxy.frame.add(i.attributes)},_formatUrl:function(t){return"string"==typeof t&&-1===t.indexOf("//")&&"/"!=t.charAt(0)?Galaxy.root+t:t},_template:function(){return'<ul class="nav navbar-nav"><li class="dropdown"><a class="dropdown-toggle"/><ul class="dropdown-menu"/><div class="dropdown-note"/></li></ul>'}});e.default={Collection:_,Tab:m}}).call(e,i(2),i(0),i(0),i(1))},function(t,e,i){"use strict";(function(t,n){function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=i(3),o=r(a),s=i(12),l=r(s),c=t.View.extend({initialize:function(){this.modal=null},makeModalIframe:function(t){var e=window.Galaxy.config.communication_server_host,i=window.Galaxy.config.communication_server_port,r=escape(window.Galaxy.user.attributes.username),a=escape(window.Galaxy.config.persistent_communication_rooms),o="?username="+r+"&persistent_communication_rooms="+a,s=e+":"+i+o,u=null,d=null,h='<iframe class="f-iframe fade in communication-iframe" src="'+s+'"> </iframe>';return n(".chat-modal").length>0&&n(".chat-modal").remove(),c.modal=new l.default.View({body:h,height:350,width:600,closing_events:!0,title_separator:!1,cls:"ui-modal chat-modal"}),c.modal.show(),u=n(".chat-modal .modal-header"),d=n(".chat-modal .modal-body"),u.addClass("modal-header-body"),d.addClass("modal-header-body"),u.find("h4").remove(),u.removeAttr("min-height padding border"),u.append('<i class="fa fa-comment" aria-hidden="true" title="Communicate with other users"></i><i class="fa fa-expand expand-compress-modal" aria-hidden="true" title="Maximize"></i><i class="fa fa-times close-modal" aria-hidden="true" title="Close"></i>'),n(".close-modal").click(function(t){n(".chat-modal").css("display","none")}),n(".expand-compress-modal").click(function(t){n(".expand-compress-modal").hasClass("fa-expand")?(n(".chat-modal .modal-dialog").width("1000px"),n(".chat-modal .modal-body").height("575px"),n(".expand-compress-modal").removeClass("fa-expand").addClass("fa-compress"),n(".expand-compress-modal").attr("title","Minimize"),n(".expand-compress-modal").css("margin-left","96.2%")):(n(".chat-modal .modal-dialog").width("600px"),n(".chat-modal .modal-body").height("350px"),n(".expand-compress-modal").removeClass("fa-compress").addClass("fa-expand"),n(".expand-compress-modal").attr("title","Maximize"),n(".expand-compress-modal").css("margin-left","93.2%"))}),this},render:function(){var t=this;return{id:"show-chat-online",icon:"fa-comment-o",tooltip:(0,o.default)("Chat online"),visible:!1,onclick:t.makeModalIframe}}});e.default={GenericNavView:c}}).call(e,i(2),i(0))},function(t,e,i){"use strict";(function(t,n,r){function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(71),s=a(o),l=i(10),c=a(l),u=i(11),d=a(u),h=i(56),f=a(h),p=i(3),_=a(p);e.default=t.View.extend({initialize:function(t){var e=this;t=t||{},this.frames=new s.default.View({visible:!1}),this.setElement(this.frames.$el),this.buttonActive=t.collection.add({id:"enable-scratchbook",icon:"fa-th",tooltip:(0,_.default)("Enable/Disable Scratchbook"),onclick:function(){e.active=!e.active,e.buttonActive.set({toggle:e.active,show_note:e.active,note_cls:e.active&&"fa fa-check"}),!e.active&&e.frames.hide()},onbeforeunload:function(){if(e.frames.length()>0)return"You opened "+e.frames.length()+" frame(s) which will be lost."}}),this.buttonLoad=t.collection.add({id:"show-scratchbook",icon:"fa-eye",tooltip:(0,_.default)("Show/Hide Scratchbook"),show_note:!0,visible:!1,onclick:function(t){e.frames.visible?e.frames.hide():e.frames.show()}}),this.frames.on("add remove",function(){this.visible&&0==this.length()&&this.hide(),e.buttonLoad.set({note:this.length(),visible:this.length()>0})}).on("show hide ",function(){e.buttonLoad.set({toggle:this.visible,icon:this.visible&&"fa-eye"||"fa-eye-slash"})}),this.history_cache={}},addDataset:function(t){var e=this,i=null;if(Galaxy&&Galaxy.currHistoryPanel){var r=Galaxy.currHistoryPanel.collection.historyId;this.history_cache[r]={name:Galaxy.currHistoryPanel.model.get("name"),dataset_ids:[]},Galaxy.currHistoryPanel.collection.each(function(t){!t.get("deleted")&&t.get("visible")&&e.history_cache[r].dataset_ids.push(t.get("id"))})}var a=function(t,i){if(t){var n=e.history_cache[t.get("history_id")];if(n&&n.dataset_ids){var r=n.dataset_ids,a=r.indexOf(t.get("id"));if(-1!==a&&a+i>=0&&a+i<r.length)return r[a+i]}}},o=function(t,n,r){var o=a(t,n);o?e._loadDataset(o,function(t,e){i=t,r.model.set(e)}):r.model.trigger("change")};this._loadDataset(t,function(t,r){i=t,e.add(n.extend({menu:[{icon:"fa fa-chevron-circle-left",tooltip:(0,_.default)("Previous in History"),onclick:function(t){o(i,-1,t)},disabled:function(){return!a(i,-1)}},{icon:"fa fa-chevron-circle-right",tooltip:(0,_.default)("Next in History"),onclick:function(t){o(i,1,t)},disabled:function(){return!a(i,1)}}]},r))})},_loadDataset:function(t,e){var i=this,a=new c.default.Dataset({id:t});r.when(a.fetch()).then(function(){var r=n.find(["tabular","interval"],function(t){return-1!==a.get("data_type").indexOf(t)}),o=a.get("name"),s=i.history_cache[a.get("history_id")];s&&(o=s.name+": "+o),e(a,r?{title:o,url:null,content:c.default.createTabularDatasetChunkedView({model:new c.default.TabularDataset(a.toJSON()),embedded:!0,height:"100%"}).$el}:{title:o,url:Galaxy.root+"datasets/"+t+"/display/?preview=True",content:null})})},addTrackster:function(t){var e=this,i=new d.default.Visualization({id:t});r.when(i.fetch()).then(function(){var t=new f.default.TracksterUI(Galaxy.root),r={title:i.get("name"),type:"other",content:function(e){var r={container:e,name:i.get("title"),id:i.id,dbkey:i.get("dbkey"),stand_alone:!1},a=i.get("latest_revision"),o=a.config.view.drawables;n.each(o,function(t){t.dataset={hda_ldda:t.hda_ldda,id:t.dataset_id}}),view=t.create_visualization(r,a.config.viewport,a.config.view.drawables,a.config.bookmarks,!1)}};e.add(r)})},add:function(t){if("_blank"==t.target)window.open(t.url);else if("_top"==t.target||"_parent"==t.target||"_self"==t.target)window.location=t.url;else if(!this.active||t.noscratchbook){var e=r(window.parent.document).find("#galaxy_main");"galaxy_main"==t.target||"center"==t.target?0===e.length?window.location=t.url+(-1==t.url.indexOf("?")?"?":"&")+"use_panels=True":e.attr("src",t.url):window.location=t.url}else this.frames.add(t)}})}).call(e,i(2),i(1),i(0))},function(t,e,i){"use strict";(function(t,n,r){Object.defineProperty(e,"__esModule",{value:!0});var a=i(3),o=function(t){return t&&t.__esModule?t:{default:t}}(a),s=t.View.extend({initialize:function(e){this.model=e&&e.model||new t.Model(e),this.setElement(n("<div/>").addClass("corner frame")),this.$el.append(n("<div/>").addClass("f-header corner").append(n("<div/>").addClass("f-title")).append(n("<div/>").addClass("f-icon f-close fa fa-close").tooltip({title:(0,o.default)("Close"),placement:"bottom"}))).append(n("<div/>").addClass("f-content")).append(n("<div/>").addClass("f-resize f-icon corner fa fa-expand").tooltip({title:"Resize"})).append(n("<div/>").addClass("f-cover")),this.$header=this.$(".f-header"),this.$title=this.$(".f-title"),this.$content=this.$(".f-content"),this.render(),this.listenTo(this.model,"change",this.render,this)},render:function(){var t=this,e=this.model.attributes;this.$title.html(e.title||""),this.$header.find(".f-icon-left").remove(),r.each(e.menu,function(e){var i=n("<div/>").addClass("f-icon-left").addClass(e.icon);r.isFunction(e.disabled)&&e.disabled()?i.attr("disabled",!0):i.on("click",function(){e.onclick(t)}).tooltip({title:e.tooltip,placement:"bottom"}),t.$header.append(i)}),e.url?this.$content.html(n("<iframe/>").addClass("f-iframe").attr("scrolling","auto").attr("src",e.url+(-1===e.url.indexOf("?")?"?":"&")+"widget=True")):e.content&&(r.isFunction(e.content)?e.content(t.$content):t.$content.html(e.content))}}),l=t.View.extend({defaultOptions:{frame:{cols:6,rows:3},rows:1e3,cell:130,margin:5,scroll:5,top_min:40,frame_max:9,visible:!0},cols:0,top:0,top_max:0,frame_z:0,frame_counter:0,frame_uid:0,frame_list:{},frame_shadow:null,visible:!1,event:{},initialize:function(e){var i=this;this.options=r.defaults(e||{},this.defaultOptions),this.visible=this.options.visible,this.top=this.top_max=this.options.top_min,this.setElement(n("<div/>").addClass("galaxy-frame").append(n("<div/>").addClass("frame-background")).append(n("<div/>").addClass("frame-menu frame-scroll-up fa fa-chevron-up fa-2x")).append(n("<div/>").addClass("frame-menu frame-scroll-down fa fa-chevron-down fa-2x"))),this.frame_shadow=new t.View({el:n("<div/>").addClass("corner frame-shadow")}),this.$el.append(this.frame_shadow.$el),this._frameInit(this.frame_shadow,"#frame-shadow"),this._frameResize(this.frame_shadow,{width:0,height:0}),this.frame_list["#frame-shadow"]=this.frame_shadow,this.visible?this.show():this.hide(),this._panelRefresh(),n(window).resize(function(){i.visible&&i._panelRefresh()})},render:function(){this.$(".frame-scroll-up")[this.top!=this.options.top_min&&"show"||"hide"](),this.$(".frame-scroll-down")[this.top!=this.top_max&&"show"||"hide"]()},add:function(t){if(this.frame_counter>=this.options.frame_max)Galaxy.modal.show({title:(0,o.default)("Warning"),body:"You have reached the maximum number of allowed frames ("+this.options.frame_max+").",buttons:{Close:function(){Galaxy.modal.hide()}}});else{var e="#frame-"+this.frame_uid++;if(0!==n(e).length)Galaxy.modal.show({title:(0,o.default)("Error"),body:"This frame already exists. This page might contain multiple frame managers.",buttons:{Close:function(){Galaxy.modal.hide()}}});else{this.top=this.options.top_min;var i=new s(t);this.$el.append(i.$el),t.width=this._toPixelCoord("width",this.options.frame.cols),t.height=this._toPixelCoord("height",this.options.frame.rows),this.frame_z=parseInt(i.$el.css("z-index")),this.frame_list[e]=i,this.frame_counter++,this._frameInit(i,e),this._frameResize(i,{width:t.width,height:t.height}),this._frameInsert(i,{top:0,left:0},!0),!this.visible&&this.show(),this.trigger("add")}}},del:function(t){var e=this,i=t.$el;i.fadeOut("fast",function(){i.remove(),delete e.frame_list[t.id],e.frame_counter--,e._panelRefresh(!0),e._panelAnimationComplete(),e.trigger("remove")})},show:function(){this.visible=!0,this.$el.fadeIn("fast"),this.trigger("show")},hide:function(){this.event.type||(this.visible=!1,this.$el.fadeOut("fast",function(){n(this).hide()}),this.trigger("hide"))},length:function(){return this.frame_counter},events:{mousemove:"_eventFrameMouseMove",mouseup:"_eventFrameMouseUp",mouseleave:"_eventFrameMouseUp",mousewheel:"_eventPanelScroll",DOMMouseScroll:"_eventPanelScroll","mousedown .frame":"_eventFrameMouseDown","mousedown .frame-background":"_eventHide","mousedown .frame-scroll-up":"_eventPanelScroll_up","mousedown .frame-scroll-down":"_eventPanelScroll_down","mousedown .f-close":"_eventFrameClose"},_eventFrameMouseDown:function(t){n(".tooltip").hide(),this.event.type||((n(t.target).hasClass("f-header")||n(t.target).hasClass("f-title"))&&(this.event.type="drag"),n(t.target).hasClass("f-resize")&&(this.event.type="resize"),this.event.type&&(t.preventDefault(),this.event.target=this._frameIdentify(t.target),this.event.xy={x:t.originalEvent.pageX,y:t.originalEvent.pageY},this._frameDragStart(this.event.target)))},_eventFrameMouseMove:function(t){if(this.event.type){var e={x:t.originalEvent.pageX,y:t.originalEvent.pageY},i={x:e.x-this.event.xy.x,y:e.y-this.event.xy.y};this.event.xy=e;var n=this._frameScreen(this.event.target);if("resize"==this.event.type){n.width+=i.x,n.height+=i.y;var r=this.options.cell-this.options.margin-1;n.width=Math.max(n.width,r),n.height=Math.max(n.height,r),this._frameResize(this.event.target,n),n.width=this._toGridCoord("width",n.width)+1,n.height=this._toGridCoord("height",n.height)+1,n.width=this._toPixelCoord("width",n.width),n.height=this._toPixelCoord("height",n.height),this._frameResize(this.frame_shadow,n),this._frameInsert(this.frame_shadow,{top:this._toGridCoord("top",n.top),left:this._toGridCoord("left",n.left)})}else if("drag"==this.event.type){n.left+=i.x,n.top+=i.y,this._frameOffset(this.event.target,n);var a={top:this._toGridCoord("top",n.top),left:this._toGridCoord("left",n.left)};0!==a.left&&a.left++,this._frameInsert(this.frame_shadow,a)}}},_eventFrameMouseUp:function(t){this.event.type&&(this._frameDragStop(this.event.target),this.event.type=null)},_eventFrameClose:function(t){this.event.type||(t.preventDefault(),this.del(this._frameIdentify(t.target)))},_eventHide:function(t){!this.event.type&&this.hide()},_eventPanelScroll:function(t){if(!this.event.type&&this.visible){0!==n(t.srcElement).parents(".frame").length?t.stopPropagation():(t.preventDefault(),this._panelScroll(t.originalEvent.detail?t.originalEvent.detail:t.originalEvent.wheelDelta/-3))}},_eventPanelScroll_up:function(t){this.event.type||(t.preventDefault(),this._panelScroll(-this.options.scroll))},_eventPanelScroll_down:function(t){this.event.type||(t.preventDefault(),this._panelScroll(this.options.scroll))},_frameIdentify:function(t){return this.frame_list["#"+n(t).closest(".frame").attr("id")]},_frameDragStart:function(t){this._frameFocus(t,!0);var e=this._frameScreen(t);this._frameResize(this.frame_shadow,e),this._frameGrid(this.frame_shadow,t.grid_location),t.grid_location=null,this.frame_shadow.$el.show(),n(".f-cover").show()},_frameDragStop:function(t){this._frameFocus(t,!1);var e=this._frameScreen(this.frame_shadow);this._frameResize(t,e),this._frameGrid(t,this.frame_shadow.grid_location,!0),this.frame_shadow.grid_location=null,this.frame_shadow.$el.hide(),n(".f-cover").hide(),this._panelAnimationComplete()},_toGridCoord:function(t,e){var i="width"==t||"height"==t?1:-1;return"top"==t&&(e-=this.top),parseInt((e+i*this.options.margin)/this.options.cell,10)},_toPixelCoord:function(t,e){var i="width"==t||"height"==t?1:-1,n=e*this.options.cell-i*this.options.margin;return"top"==t&&(n+=this.top),n},_toGrid:function(t){return{top:this._toGridCoord("top",t.top),left:this._toGridCoord("left",t.left),width:this._toGridCoord("width",t.width),height:this._toGridCoord("height",t.height)}},_toPixel:function(t){return{top:this._toPixelCoord("top",t.top),left:this._toPixelCoord("left",t.left),width:this._toPixelCoord("width",t.width),height:this._toPixelCoord("height",t.height)}},_isCollision:function(t){for(var e in this.frame_list){var i=this.frame_list[e];if(null!==i.grid_location&&function(t,e){return!(t.left>e.left+e.width-1||t.left+t.width-1<e.left||t.top>e.top+e.height-1||t.top+t.height-1<e.top)}(t,i.grid_location))return!0}return!1},_locationRank:function(t){return t.top*this.cols+t.left},_panelRefresh:function(t){this.cols=parseInt(n(window).width()/this.options.cell,10)+1,this._frameInsert(null,null,t)},_panelAnimationComplete:function(){var t=this;n(".frame").promise().done(function(){t._panelScroll(0,!0)})},_panelScroll:function(t,e){var i=this.top-this.options.scroll*t;if(i=Math.max(i,this.top_max),i=Math.min(i,this.options.top_min),this.top!=i){for(var n in this.frame_list){var r=this.frame_list[n];if(null!==r.grid_location){var a={top:r.screen_location.top-(this.top-i),left:r.screen_location.left};this._frameOffset(r,a,e)}}this.top=i}this.render()},_frameInit:function(t,e){t.id=e,t.screen_location={},t.grid_location={},t.grid_rank=null,t.$el.attr("id",e.substring(1))},_frameInsert:function(t,e,i){var a=this,o=[];t&&(t.grid_location=null,o.push([t,this._locationRank(e)])),r.each(this.frame_list,function(t){null!==t.grid_location&&(t.grid_location=null,o.push([t,t.grid_rank]))}),o.sort(function(t,e){return t[1]<e[1]?-1:t[1]>e[1]?1:0}),r.each(o,function(t){a._framePlace(t[0],i)}),this.top_max=0,r.each(this.frame_list,function(t){null!==t.grid_location&&(a.top_max=Math.max(a.top_max,t.grid_location.top+t.grid_location.height))}),this.top_max=n(window).height()-this.top_max*this.options.cell-2*this.options.margin,this.top_max=Math.min(this.top_max,this.options.top_min),this.render()},_framePlace:function(t,e){t.grid_location=null;for(var i=this._toGrid(this._frameScreen(t)),n=!1,r=0;r<this.options.rows;r++){for(var a=0;a<Math.max(1,this.cols-i.width);a++)if(i.top=r,i.left=a,!this._isCollision(i)){n=!0;break}if(n)break}n?this._frameGrid(t,i,e):console.log("Grid dimensions exceeded.")},_frameFocus:function(t,e){t.$el.css("z-index",this.frame_z+(e?1:0))},_frameOffset:function(t,e,i){if(t.screen_location.left=e.left,t.screen_location.top=e.top,i){this._frameFocus(t,!0);var n=this;t.$el.animate({top:e.top,left:e.left},"fast",function(){n._frameFocus(t,!1)})}else t.$el.css({top:e.top,left:e.left})},_frameResize:function(t,e){t.$el.css({width:e.width,height:e.height}),t.screen_location.width=e.width,t.screen_location.height=e.height},_frameGrid:function(t,e,i){t.grid_location=e,this._frameOffset(t,this._toPixel(e),i),t.grid_rank=this._locationRank(e)},_frameScreen:function(t){var e=t.screen_location;return{top:e.top,left:e.left,width:e.width,height:e.height}}});e.default={View:l}}).call(e,i(2),i(0),i(1))},function(t,e,i){"use strict";(function(t,i,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=t.Model.extend({defaults:{url_base:"",async:!1,async_ops:[],categorical_filters:[],filters:{},sort_key:null,show_item_checkboxes:!1,advanced_search:!1,cur_page:1,num_pages:1,operation:void 0,item_ids:void 0},add_filter:function(t,e,i){if(i){var n,r=this.attributes.filters[t];if(null===r||void 0===r)n=e;else if("string"==typeof r)if("All"==r||r==e)n=e;else{var a=[];a[0]=r,a[1]=e,n=a}else n=r,-1===n.indexOf(e)&&n.push(e);this.attributes.filters[t]=n}else this.attributes.filters[t]=e},remove_filter:function(t,e){var n=this.attributes.filters[t];if(null===n||void 0===n)return!1;if("string"==typeof n)this.attributes.filters[t]="";else{var r=i.indexOf(n,e);-1!==r&&(n[r]="")}},get_url_data:function(){var t={async:this.attributes.async,sort:this.attributes.sort_key,page:this.attributes.cur_page,show_item_checkboxes:this.attributes.show_item_checkboxes,advanced_search:this.attributes.advanced_search};this.attributes.operation&&(t.operation=this.attributes.operation),this.attributes.item_ids&&(t.id=this.attributes.item_ids);var e=this;return i.each(i.pairs(e.attributes.filters),function(e){t["f-"+e[0]]=e[1]}),t},get_url:function(t){return this.get("url_base")+"?"+n.param(this.get_url_data())+"&"+n.param(t)}})}).call(e,i(2),i(1),i(0))},function(t,e,i){"use strict";(function(t,n){Object.defineProperty(e,"__esModule",{value:!0});var r=i(4),a=function(t){return t&&t.__esModule?t:{default:t}}(r);e.default={grid:function(t){var e="";return e=t.embedded?this.grid_header(t)+this.grid_table(t):'<div class="loading-elt-overlay"></div><table><tr><td width="75%">'+this.grid_header(t)+'</td><td></td><td></td></tr><tr><td width="100%" id="grid-message" valign="top"></td><td></td><td></td></tr></table>'+this.grid_table(t),t.info_text&&(e+='<br><div class="toolParamHelp" style="clear: both;">'+t.info_text+"</div>"),e},grid_table:function(){return'\n            <form method="post" onsubmit="return false;">\n                <table id="grid-table" class="grid">\n                    <thead id="grid-table-header"></thead>\n                    <tbody id="grid-table-body"></tbody>\n                    <tfoot id="grid-table-footer"></tfoot>\n                </table>\n            </form>'},grid_header:function(t){var e='<div class="grid-header">';if(t.embedded||(e+="<h2>"+t.title+"</h2>"),t.global_actions){e+='<ul class="manage-table-actions">';var i=t.global_actions.length>=3;i&&(e+='<li><a class="action-button" id="popup-global-actions" class="menubutton">Actions</a></li><div popupmenu="popup-global-actions">');var n=!0,r=!1,a=void 0;try{for(var o,s=t.global_actions[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var l=o.value;e+='<li><a class="action-button use-target" target="'+l.target+'" href="'+l.url_args+'" onclick="return false;" >'+l.label+"</a></li>"}}catch(t){r=!0,a=t}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}i&&(e+="</div>"),e+="</ul>"}return t.insert&&(e+=t.insert),e+=this.grid_filters(t),e+="</div>"},header:function(t){var e="<tr>";t.show_item_checkboxes&&(e+="<th>",t.items.length>0&&(e+='<input type="checkbox" id="check_all" name=select_all_checkbox value="true"><input type="hidden" name=select_all_checkbox value="true">'),e+="</th>");var i=!0,n=!1,r=void 0;try{for(var a,o=t.columns[Symbol.iterator]();!(i=(a=o.next()).done);i=!0){var s=a.value;s.visible&&(e+='<th id="'+s.key+'-header">',s.href?e+='<a href="'+s.href+'" class="sort-link" sort_key="'+s.key+'">'+s.label+"</a>":e+=s.label,e+='<span class="sort-arrow">'+s.extra+"</span></th>")}}catch(t){n=!0,r=t}finally{try{!i&&o.return&&o.return()}finally{if(n)throw r}}return e+="</tr>"},body:function(e){var i="";0===e.items.length&&(i+='<tr><td colspan="100"><em>No Items</em></td></tr>');var n=!0,r=!1,a=void 0;try{for(var o,s=e.items[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var l=o.value;i+="<tr ",e.current_item_id==l.id&&(i+='class="current"'),i+=">",e.show_item_checkboxes&&(i+='<td style="width: 1.5em;"><input type="checkbox" name="id" value="'+l.encode_id+'" id="'+l.encode_id+'" class="grid-row-select-checkbox" /></td>');var c=!0,u=!1,d=void 0;try{for(var h,f=e.columns[Symbol.iterator]();!(c=(h=f.next()).done);c=!0){var p=h.value;if(p.visible){var _="";p.nowrap&&(_='style="white-space:nowrap;"');var m=l.column_config[p.label],g=m.link,v=m.value,w=m.target;"string"===t.type(v)&&(v=v.replace(/\/\//g,"/"));var y="",b="";p.attach_popup&&(y="grid-"+l.encode_id+"-popup",b="menubutton",""!==g&&(b+=" split"),b+=" popup"),i+="<td "+_+">",g?(0!==e.operations.length&&(i+='<div id="'+y+'" class="'+b+'" style="float: left;">'),i+='<a class="menubutton-label use-target" target="'+w+'" href="'+g+'" onclick="return false;">'+v+"</a>",0!==e.operations.length&&(i+="</div>")):i+='<div id="'+y+'" class="'+b+'"><label id="'+p.label_id_prefix+l.encode_id+'" for="'+l.encode_id+'">'+(v||"")+"</label></div>",i+="</td>"}}}catch(t){u=!0,d=t}finally{try{!c&&f.return&&f.return()}finally{if(u)throw d}}i+="</tr>"}}catch(t){r=!0,a=t}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}return i},footer:function(t){var e="";if(t.use_paging&&t.num_pages>1){var i=t.num_page_links,n=t.cur_page_num,r=t.num_pages,a=i/2,o=n-a,s=0;o<=0&&(o=1,s=a-(n-o));var l,c=a+s,u=n+c;u<=r?l=0:(u=r,l=c-(u+1-n)),0!==l&&(o-=l)<1&&(o=1),e+='<tr id="page-links-row">',t.show_item_checkboxes&&(e+="<td></td>"),e+='<td colspan="100"><span id="page-link-container">Page:',o>1&&(e+='<span class="page-link" id="page-link-1"><a href="javascript:void(0);" page_num="1" onclick="return false;">1</a></span> ...');for(var d=o;d<u+1;d++)d==t.cur_page_num?e+='<span class="page-link inactive-link" id="page-link-'+d+'">'+d+"</span>":e+='<span class="page-link" id="page-link-'+d+'"><a href="javascript:void(0);" onclick="return false;" page_num="'+d+'">'+d+"</a></span>";u<r&&(e+='...<span class="page-link" id="page-link-'+r+'"><a href="javascript:void(0);" onclick="return false;" page_num="'+r+'">'+r+"</a></span>"),e+="</span>",e+='\n                    <span class="page-link" id="show-all-link-span"> | <a href="javascript:void(0);" onclick="return false;" page_num="all">Show All</a></span>\n                    </td>\n                </tr>'}if(t.show_item_checkboxes){e+='\n                <tr>\n                    <input type="hidden" id="operation" name="operation" value="">\n                    <td></td>\n                    <td colspan="100">\n                        For <span class="grid-selected-count"></span> selected items: \n            ';var h=!0,f=!1,p=void 0;try{for(var _,m=t.operations[Symbol.iterator]();!(h=(_=m.next()).done);h=!0){var g=_.value;g.allow_multiple&&(e+='<input type="button" value="'+g.label+'" class="operation-button action-button">&nbsp;')}}catch(t){f=!0,p=t}finally{try{!h&&m.return&&m.return()}finally{if(f)throw p}}e+="</td></tr>"}var v=!1,w=!0,y=!1,b=void 0;try{for(var x,k=t.operations[Symbol.iterator]();!(w=(x=k.next()).done);w=!0){if(x.value.global_operation){v=!0;break}}}catch(t){y=!0,b=t}finally{try{!w&&k.return&&k.return()}finally{if(y)throw b}}if(v){e+='<tr><td colspan="100">';var C=!0,S=!1,T=void 0;try{for(var M,O=t.operations[Symbol.iterator]();!(C=(M=O.next()).done);C=!0){var A=M.value;A.global_operation&&(e+='<a class="action-button" href="'+A.global_operation+'">'+A.label+"</a>")}}catch(t){S=!0,T=t}finally{try{!C&&O.return&&O.return()}finally{if(S)throw T}}e+="</td></tr>"}return t.legend&&(e+='<tr><td colspan="100">'+t.legend+"</td></tr>"),e},message:function(t){var e=t.status;return-1!=["success","ok"].indexOf(e)&&(e="done"),'<p><div class="'+e+'message transient-message">'+n.escape(t.message)+'</div><div style="clear: both"></div></p>'},grid_filters:function(t){var e=t.default_filter_dict,i=t.filters,n="none";t.advanced_search&&(n="block");var r=!1,a=!0,o=!1,s=void 0;try{for(var l,c=t.columns[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){var u=l.value;if("advanced"==u.filterable){var d=u.key,h=i[d],f=e[d];h&&f&&h!=f&&(n="block"),r=!0}}}catch(t){o=!0,s=t}finally{try{!a&&c.return&&c.return()}finally{if(o)throw s}}var p="block";"block"==n&&(p="none");var _='<div id="standard-search" style="display: '+p+';"><table><tr><td style="padding: 0;"><table>',m=!0,g=!1,v=void 0;try{for(var w,y=t.columns[Symbol.iterator]();!(m=(w=y.next()).done);m=!0){var b=w.value;"standard"==b.filterable&&(_+=this.grid_column_filter(t,b))}}catch(t){g=!0,v=t}finally{try{!m&&y.return&&y.return()}finally{if(g)throw v}}_+="</table></td></tr><tr><td>",r&&(_+='<a href="" class="advanced-search-toggle">Advanced Search</a>'),_+="</td></tr></table></div>",_+='<div id="advanced-search" style="display: '+n+'; margin-top: 5px; border: 1px solid #ccc;"><table><tr><td style="text-align: left" colspan="100"><a href="" class="advanced-search-toggle">Close Advanced Search</a></td></tr>';var x=!0,k=!1,C=void 0;try{for(var S,T=t.columns[Symbol.iterator]();!(x=(S=T.next()).done);x=!0){var M=S.value;"advanced"==M.filterable&&(_+=this.grid_column_filter(t,M))}}catch(t){k=!0,C=t}finally{try{!x&&T.return&&T.return()}finally{if(k)throw C}}return _+="</table></div>"},grid_column_filter:function(e,i){var n=e.filters,r=i.label,a=i.key;"advanced"==i.filterable&&(r=r.toLowerCase());var o="<tr>";if("advanced"==i.filterable&&(o+='<td align="left" style="padding-left: 10px">'+r+":</td>"),o+='<td style="padding-bottom: 1px;">',i.is_text){o+='<form class="text-filter-form" column_key="'+a+'" action="'+e.url+'" method="get" >';var s=!0,l=!1,c=void 0;try{for(var u,d=e.columns[Symbol.iterator]();!(s=(u=d.next()).done);s=!0){var h=u.value,f=n[h.key];f&&"All"!=f&&(h.is_text&&(f=JSON.stringify(f)),o+='<input type="hidden" id="'+h.key+'" name="f-'+h.key+'" value="'+f+'"/>')}}catch(t){l=!0,c=t}finally{try{!s&&d.return&&d.return()}finally{if(l)throw c}}o+='<span id="'+a+'-filtering-criteria">';var p=n[a];if(p){var _=t.type(p);if("string"==_&&"All"!=p&&(o+=this.filter_element(a,p)),"array"==_)for(var m in p){var g=p;g=g.slice(m),o+=this.filter_element(a,p[m])}}o+="</span>";var v="",w=20;"standard"==i.filterable&&(v=i.label.toLowerCase(),v.length<20&&(w=v.length),w+=4),o+='\n                <span class="search-box">\n                    <input class="search-box-input" id="input-'+a+'-filter" name="f-'+a+'" type="text" placeholder="'+v+'" size="'+w+'"/>\n                    <button type="submit" style="background: transparent; border: none; padding: 4px; margin: 0px;">\n                        <i class="fa fa-search"></i>\n                    </button>\n                </span>\n            </form>'}else{o+='<span id="'+a+'-filtering-criteria">';var y=!1;for(var b in e.categorical_filters[a]){var x=e.categorical_filters[a][b],k="",C="";for(var S in x)k=S,C=x[S];y&&(o+=" | "),y=!0;var T=n[a];T&&x[a]&&T==C?o+='<span class="categorical-filter '+a+'-filter current-filter">'+b+"</span>":o+='<span class="categorical-filter '+a+'-filter"><a href="javascript:void(0);" filter_key="'+k+'" filter_val="'+C+'">'+b+"</a></span>"}o+="</span>"}return o+="</td></tr>"},filter_element:function(t,e){return'<span class="text-filter-val">'+(e=a.default.sanitize(e))+'<a href="javascript:void(0);" filter_key="'+t+'" filter_val="'+e+'"><i class="fa fa-times" style="padding-left: 5px; padding-bottom: 6px;"/></a></span>'}}}).call(e,i(0),i(1))},function(t,e,i){"use strict";(function(t,n){Object.defineProperty(e,"__esModule",{value:!0});var r=i(1),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(r),o=t.View.extend({className:"track-header",initialize:function(){this.model.config.get("name").on("change:value",this.update_name,this),this.render()},render:function(){this.$el.append(n("<div/>").addClass(this.model.drag_handle_class)),this.$el.append(n("<div/>").addClass("track-name").text(this.model.config.get_value("name"))),this.action_icons={},this.render_action_icons(),this.$el.dblclick(function(t){t.stopPropagation()}),this.$el.append(n("<div style='clear: both'/>"))},update_name:function(){this.$el.find(".track-name").text(this.model.config.get_value("name"))},render_action_icons:function(){var t=this;this.icons_div=n("<div/>").addClass("track-icons").hide().appendTo(this.$el),a.each(this.model.action_icons_def,function(e){t.add_action_icon(e.name,e.title,e.css_class,e.on_click_fn,e.prepend,e.hide)}),this.set_display_modes(this.model.display_modes)},add_action_icon:function(t,e,i,r,a,o){var s=this;this.action_icons[t]=n("<a/>").attr("title",e).addClass("icon-button").addClass(i).tooltip().click(function(){r(s.model)}).appendTo(this.icons_div),o&&this.action_icons[t].hide()},set_display_modes:function(t,e){if(t){this.model.display_modes=t,this.model.mode=e||this.model.config.get_value("mode")||this.model.display_modes[0],this.action_icons.mode_icon.attr("title","Set display mode (now: "+this.mode+")");for(var i=this.model,n={},r=0,a=i.display_modes.length;r<a;r++){var o=i.display_modes[r];n[o]=function(t){return function(){i.change_mode(t)}}(o)}make_popupmenu(this.action_icons.mode_icon,n)}}});e.default={TrackHeaderView:o}}).call(e,i(2),i(0))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(1),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(n),a=r.extend,o=function(t,e){this.slot=t,this.feature=e},s=function(t,e,i,n){this.slots={},this.start_end_dct={},this.w_scale=t,this.mode=e,this.include_label="Pack"===e,this.max_rows=i,this.measureText=n};a(s.prototype,{_get_draw_coords:function(t){var e=Math.floor(t[1]*this.w_scale),i=Math.ceil(t[2]*this.w_scale),n=t[3];if(void 0!==n&&this.include_label){var r=this.measureText(n).width+7;e-r>=0?(e-=r,"left"):(i+=r,"right")}return[e,i]},_find_slot:function(t){for(var e=t[0],i=t[1],n=0;n<=this.max_rows;n++){var r=!1,a=this.start_end_dct[n];if(void 0!==a)for(var o=0,s=a.length;o<s;o++){var l=a[o];if(i>l[0]&&e<l[1]){r=!0;break}}if(!r)return n}return-1},slot_features:function(t){for(var e,i,n=this.start_end_dct,r=[],a=0,s=0,l=t.length;s<l;s++){e=t[s],i=e[0];var c=this.slots[i];if(c){if(e[1]<c.feature[1]||c.feature[2]<e[2])for(var u=this._get_draw_coords(c.feature),d=this._get_draw_coords(e),h=this.start_end_dct[c.slot],f=0;f<h.length;f++){var p=h[f];p[0]===u[0]&&p[1]===u[1]&&(h[f]=d)}a=Math.max(a,this.slots[i].slot)}else r.push(s)}for(var s=0,l=r.length;s<l;s++){e=t[r[s]],i=e[0];var _=this._get_draw_coords(e),m=this._find_slot(_);m>=0&&(void 0===n[m]&&(n[m]=[]),n[m].push(_),this.slots[i]=new o(m,e),a=Math.max(a,m))}return a+1}}),e.default={FeatureSlotter:s}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(1),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(n),a=function(t,e){var i=t[0],n=t[1],r=e[0],a=e[1];return i<r?n<=r?1001:n<=a?1003:1002:i>a?1006:n<=a?1005:1004},o=function(t,e){var i=a(t,e);return 1001!==i&&1006!==i},s=function(t,e,i,n,r,a){void 0===a&&(a=4);var o,s=n-e,l=r-i,c=Math.floor(Math.sqrt(s*s+l*l)/a),u=s/c,d=l/c;for(o=0;o<c;o++,e+=u,i+=d)o%2==0&&t.fillRect(e,i,a,1)},l=function(t,e,i,n){var r=e-n/2,a=e+n/2,o=i-Math.sqrt(3*n/2);t.beginPath(),t.moveTo(r,o),t.lineTo(a,o),t.lineTo(e,i),t.lineTo(r,o),t.strokeStyle=this.fillStyle,t.fill(),t.stroke(),t.closePath()},c=function(t){this.default_val=t||1};c.prototype.gen_val=function(t){return this.default_val};var u=function(t){this.incomplete_features=t.incomplete_features,this.feature_mapper=t.feature_mapper},d=function(t,e,i,n,a){this.data=t,this.view_start=e,this.view_end=i,this.prefs=r.extend({},this.default_prefs,n),this.mode=a};d.prototype.default_prefs={},d.prototype.draw=function(t,e,i,n){},d.prototype.get_start_draw_pos=function(t,e){return this._chrom_pos_to_draw_pos(t,e,-.5)},d.prototype.get_end_draw_pos=function(t,e){return this._chrom_pos_to_draw_pos(t,e,.5)},d.prototype.get_draw_pos=function(t,e){return this._chrom_pos_to_draw_pos(t,e,0)},d.prototype._chrom_pos_to_draw_pos=function(t,e,i){return Math.floor(e*(Math.max(0,t-this.view_start)+i))};var h=function(t,e,i,n,r){d.call(this,t,e,i,n,r)};h.prototype.default_prefs={min_value:void 0,max_value:void 0,mode:"Histogram",color:"#000",overflow_color:"#F66"},h.prototype.draw=function(t,e,i,n){var a=!1,o=this.prefs.min_value,s=this.prefs.max_value,l=s-o,c=i,u=this.view_start,d=this.mode,h=this.data;t.save();var f=Math.round(i+o/l*i);"Intensity"!==d&&(t.fillStyle="#aaa",t.fillRect(0,f,e,1)),t.beginPath();var p,_,m;m=h.length>1?r.map(h.slice(0,-1),function(t,e){return Math.ceil((h[e+1][0]-h[e][0])*n)}):[10];for(var g,v=this.prefs.block_color||this.prefs.color,w=parseInt(v.slice(1),16),y=(16711680&w)>>16,b=(65280&w)>>8,x=255&w,k=!1,C=!1,S=0,T=h.length;S<T;S++)if(t.fillStyle=t.strokeStyle=v,k=C=!1,g=m[S],p=Math.floor((h[S][0]-u-.5)*n),null!==(_=h[S][1])){if(_<o?(C=!0,_=o):_>s&&(k=!0,_=s),"Histogram"===d)_=Math.round(_/l*c),t.fillRect(p,f,g,-_);else if("Intensity"===d){var M=(_-o)/l,O=Math.round(y+(255-y)*(1-M)),A=Math.round(b+(255-b)*(1-M)),R=Math.round(x+(255-x)*(1-M));t.fillStyle="rgb("+O+","+A+","+R+")",t.fillRect(p,0,g,c)}else _=Math.round(c-(_-o)/l*c),a?t.lineTo(p,_):(a=!0,"Filled"===d?(t.moveTo(p,c),t.lineTo(p,_)):t.moveTo(p,_));if(t.fillStyle=this.prefs.overflow_color,k||C){var E;"Histogram"===d||"Intensity"===d?E=g:(p-=2,E=4),k&&t.fillRect(p,0,E,3),C&&t.fillRect(p,c-3,E,3)}t.fillStyle=v}else a&&"Filled"===d&&t.lineTo(p,c),a=!1;"Filled"===d?(a&&(t.lineTo(p,f),t.lineTo(0,f)),t.fill()):t.stroke(),t.restore()};var f=function(t){this.feature_positions={},this.slot_height=t,this.translation=0,this.y_translation=0};f.prototype.map_feature_data=function(t,e,i,n){this.feature_positions[e]||(this.feature_positions[e]=[]),this.feature_positions[e].push({data:t,x_start:i,x_end:n})},f.prototype.get_feature_data=function(t,e){var i,n=Math.floor((e-this.y_translation)/this.slot_height);if(!this.feature_positions[n])return null;t+=this.translation;for(var r=0;r<this.feature_positions[n].length;r++)if(i=this.feature_positions[n][r],t>=i.x_start&&t<=i.x_end)return i.data};var p=function(t,e,i,n,r,a,o){d.call(this,t,e,i,n,r),this.alpha_scaler=a||new c,this.height_scaler=o||new c,this.max_label_length=200};p.prototype.default_prefs={block_color:"#FFF",connector_color:"#FFF"},r.extend(p.prototype,{get_required_height:function(t,e){var i=this.get_row_height(),n=i,r=this.mode;return"no_detail"!==r&&"Squish"!==r&&"Pack"!==r||(i=t*n),i+this.get_top_padding(e)},get_top_padding:function(t){return 0},draw:function(t,e,i,n,r){var a=this.data,o=this.view_start,s=this.view_end;t.save(),t.fillStyle=this.prefs.block_color,t.textAlign="right";for(var l,c=this.get_row_height(),d=new f(c),h=[],p=0,_=a.length;p<_;p++){var m=a[p],g=m[0],v=m[1],w=m[2],y=r&&void 0!==r[g]?r[g].slot:null;("Dense"===this.mode||null!==y)&&v<s&&w>o&&(l=this.draw_element(t,this.mode,m,y,o,s,n,c,e),d.map_feature_data(m,y,l[0],l[1]),(v<o||w>s)&&h.push(m))}return t.restore(),d.y_translation=this.get_top_padding(e),new u({incomplete_features:h,feature_mapper:d})},draw_element:function(t,e,i,n,r,a,o,s,l){return[0,0]}});var _=function(t,e,i,n,r,a,o){p.call(this,t,e,i,n,r,a,o),this.draw_background_connector=!0,this.draw_individual_connectors=!1};r.extend(_.prototype,p.prototype,{get_row_height:function(){var t=this.mode;return"Dense"===t?10:"no_detail"===t?3:"Squish"===t?5:10},draw_element:function(t,e,i,n,r,a,o,s,l){var c,u=(i[0],i[1]),d=i[2],h=i[3],f=i[4],p=Math.floor(Math.max(0,(u-r-.5)*o)),_=Math.ceil(Math.min(l,Math.max(0,(d-r-.5)*o))),m=p,g=_,c=("Dense"===e?0:0+n)*s+this.get_top_padding(l),v=null,w=null,y=f&&"+"!==f&&"."!==f?this.prefs.reverse_strand_color:this.prefs.block_color,b=this.prefs.label_color;if(t.globalAlpha=this.alpha_scaler.gen_val(i),"Dense"===e&&(n=1),"no_detail"===e)t.fillStyle=y,t.fillRect(p,c+5,_-p,1);else{var x=i[5],k=i[6],C=i[7],S=!0;x&&k&&(v=Math.floor(Math.max(0,(x-r)*o)),w=Math.ceil(Math.min(l,Math.max(0,(k-r)*o))));var T,M;if("Squish"===e?(T=1,M=3,S=!1):(T=5,M=9),C){var O,A;"Squish"===e||"Dense"===e?(O=c+Math.floor(1.5)+1,A=1):f?(O=c,A=M):(O+=2.5,A=1),this.draw_background_connector&&("Squish"===e||"Dense"===e?t.fillStyle="#ccc":f?"+"===f?t.fillStyle=t.canvas.manager.get_pattern("right_strand"):"-"===f&&(t.fillStyle=t.canvas.manager.get_pattern("left_strand")):t.fillStyle="#ccc",t.fillRect(p,O,_-p,A));for(var R=0,E=C.length;R<E;R++){var z,P,j=C[R],q=Math.floor(Math.max(0,(j[0]-r-.5)*o)),L=Math.ceil(Math.min(l,Math.max((j[1]-r-.5)*o)));if(!(q>L)){if(t.fillStyle=y,t.fillRect(q,c+(M-T)/2+1,L-q,T),void 0!==v&&k>x&&!(q>w||L<v)){var $=Math.max(q,v),N=Math.min(L,w);t.fillRect($,c+1,N-$,M),1===C.length&&"Pack"===e&&("+"===f?t.fillStyle=t.canvas.manager.get_pattern("right_strand_inv"):"-"===f&&(t.fillStyle=t.canvas.manager.get_pattern("left_strand_inv")),$+14<N&&($+=2,N-=2),t.fillRect($,c+1,N-$,M))}this.draw_individual_connectors&&z&&this.draw_connector(t,z,P,q,L,c),z=q,P=L}}if("Pack"===e){t.globalAlpha=1,t.fillStyle="white";var I=this.height_scaler.gen_val(i),D=Math.ceil(M*I),G=Math.round((M-D)/2);1!==I&&(t.fillRect(p,O+1,_-p,G),t.fillRect(p,O+M-G+1,_-p,G))}}else t.fillStyle=y,t.fillRect(p,c+1,_-p,M),f&&S&&("+"===f?t.fillStyle=t.canvas.manager.get_pattern("right_strand_inv"):"-"===f&&(t.fillStyle=t.canvas.manager.get_pattern("left_strand_inv")),t.fillRect(p,c+1,_-p,M));t.globalAlpha=1,h&&"Pack"===e&&u>r&&(t.fillStyle=b,0===r&&p-t.measureText(h).width<0?(t.textAlign="left",t.fillText(h,_+2,c+8,this.max_label_length),g+=t.measureText(h).width+2):(t.textAlign="right",t.fillText(h,p-2,c+8,this.max_label_length),m-=t.measureText(h).width+2))}return t.globalAlpha=1,[m,g]}});var m=function(t,e,i,n,r,a,o,s,l){p.call(this,t,e,i,n,r,a,o),this.ref_seq=s?s.data:null,this.base_color_fn=l};r.extend(m.prototype,p.prototype,{get_row_height:function(){var t,e=this.mode;return"Dense"===e?t=10:"Squish"===e?t=5:(t=10,this.prefs.show_insertions&&(t*=2)),t},_parse_cigar:function(t){var e="MIDNSHP=X",i=[[0,0]],n=i[0],a=0,o=r.map(t.match(/[0-9]+[MIDNSHP=X]/g),function(t){var r=parseInt(t.slice(0,-1),10),o=t.slice(-1);return"N"===o?0!==n[1]&&(n=[a+r,a+r],i.push(n)):-1==="ISHP".indexOf(o)&&(n[1]+=r,a+=r),[e.indexOf(o),r]});return{blocks:i,cigar:o}},draw_read:function(t,e,i,n,r,s,c,u,d,h){var f=function(t){return Math.floor(Math.max(0,(t-r-.5)*i))};t.textAlign="center";var p,_,m=[r,s],g=0,v=0,w=Math.round(i/2),y=t.canvas.manager.char_width_px,b="+"===d?this.prefs.detail_block_color:this.prefs.reverse_strand_color,k="Pack"===e,C=k?9:3,S=n+1,T=new x(t,C,i,e),M=[],O=[],A=this._parse_cigar(u);u=A.cigar,M=A.blocks;for(var R=0;R<M.length;R++){var E=M[R];o([c+E[0],c+E[1]],m)&&(p=f(c+E[0]),_=f(c+E[1]),p===_&&(_+=1),t.fillStyle=b,t.fillRect(p,S,_-p,C))}for(var z=0,P=u.length;z<P;z++){var j=u[z],q="MIDNSHP=X"[j[0]],L=j[1],$=c+g;if(p=f($),_=f($+L),o([$,$+L],m))switch(p===_&&(_+=1),q){case"H":case"S":case"P":break;case"M":g+=L;break;case"=":case"X":var N="";"X"===q?N=h.slice(v,v+L):this.ref_seq&&(N=this.ref_seq.slice(Math.max(0,$-r),Math.min($-r+L,s-r)));for(var I=Math.max($,r),D=0;D<N.length;D++)if(N&&!this.prefs.show_differences||"X"===q){var G=Math.floor(Math.max(0,(I+D-r)*i));t.fillStyle=this.base_color_fn(N[D]),k&&i>y?t.fillText(N[D],G,n+9):i>.05&&t.fillRect(G-w,S,Math.max(1,Math.round(i)),C)}"X"===q&&(v+=L),g+=L;break;case"N":t.fillStyle="#ccc",t.fillRect(p,S+(C-1)/2,_-p,1),g+=L;break;case"D":T.draw_deletion(p,S,L),g+=L;break;case"I":var U=p-w;if(o([$,$+L],m)){var B=h.slice(v,v+L);if(this.prefs.show_insertions){var F=p-(_-p)/2;if(("Pack"===e||"Auto"===this.mode)&&void 0!==h&&i>y){switch(t.fillStyle="yellow",t.fillRect(F-w,n-9,_-p,9),O[O.length]={type:"triangle",data:[U,n+4,5]},t.fillStyle="#ccc",a([$,$+L],m)){case 1003:B=B.slice(r-$);break;case 1004:B=B.slice(0,$-s);break;case 1005:break;case 1002:B=B.slice(r-$,$-s)}for(var D=0,V=B.length;D<V;D++){var G=Math.floor(Math.max(0,($+D-r)*i));t.fillText(B[D],G-(_-p)/2,n)}}else t.fillStyle="yellow",t.fillRect(F,n+("Dense"!==this.mode?2:5),_-p,"Dense"!==e?3:9)}else("Pack"===e||"Auto"===this.mode)&&void 0!==h&&i>y&&O.push({type:"text",data:[B.length,U,n+9]})}v+=L}else g=function(t,e,i){return-1!=="M=NXD".indexOf(e)&&(t+=i),t}(g,q,L),v=function(t,e,i){return-1!=="IX".indexOf(e)&&(t+=i),t}(v,q,L)}t.fillStyle="yellow";for(var H,Y,X,R=0;R<O.length;R++)H=O[R],Y=H.type,X=H.data,"text"===Y?(t.save(),t.font="bold "+t.font,t.fillText(X[0],X[1],X[2]),t.restore()):"triangle"===Y&&l(t,X[0],X[1],X[2])},draw_element:function(t,e,i,n,r,a,o,l,c){var u=(i[0],i[1]),d=i[2],h=i[3],f=Math.floor(Math.max(-.5*o,(u-r-.5)*o)),p=Math.ceil(Math.min(c,Math.max(0,(d-r-.5)*o))),_=("Dense"===e?0:0+n)*l,m="Pack"===e?9:3;this.prefs.label_color;if(i[5]instanceof Array){var g=!0;i[4][1]>=r&&i[4][0]<=a&&i[4][2]?this.draw_read(t,e,o,_,r,a,i[4][0],i[4][2],i[4][3],i[4][4]):g=!1,i[5][1]>=r&&i[5][0]<=a&&i[5][2]?this.draw_read(t,e,o,_,r,a,i[5][0],i[5][2],i[5][3],i[5][4]):g=!1;var v=Math.ceil(Math.min(c,Math.max(-.5*o,(i[4][1]-r-.5)*o))),w=Math.floor(Math.max(-.5*o,(i[5][0]-r-.5)*o));if(g&&w>v){t.fillStyle="#ccc";var y=_+1+(m-1)/2;s(t,v,y,w,y)}}else this.draw_read(t,e,o,_,r,a,u,i[4],i[5],i[6]);return"Pack"===e&&u>=r&&"."!==h&&(t.fillStyle=this.prefs.label_color,0===r&&f-t.measureText(h).width<0?(t.textAlign="left",t.fillText(h,p+2,_+9,this.max_label_length)):(t.textAlign="right",t.fillText(h,f-2,_+9,this.max_label_length))),[0,0]}});var g=function(t,e,i,n,r,a,o){_.call(this,t,e,i,n,r,a,o),this.longest_feature_length=this.calculate_longest_feature_length(),this.draw_background_connector=!1,this.draw_individual_connectors=!0};r.extend(g.prototype,p.prototype,_.prototype,{calculate_longest_feature_length:function(){for(var t=0,e=0,i=this.data.length;e<i;e++){var n=this.data[e],r=n[1],a=n[2];t=Math.max(t,a-r)}return t},get_top_padding:function(t){var e=this.view_end-this.view_start,i=t/e;return Math.min(128,Math.ceil(this.longest_feature_length/2*i))},draw_connector:function(t,e,i,n,r,a){var o=(i+n)/2,s=n-o;Math.PI;s>0&&(t.beginPath(),t.arc(o,a,n-o,Math.PI,0),t.stroke())}});var v=function(t,e){Array.isArray(t)?this.rgb=t:6==t.length?this.rgb=t.match(/.{2}/g).map(function(t){return parseInt(t,16)}):7==t.length?this.rgb=t.substring(1,7).match(/.{2}/g).map(function(t){return parseInt(t,16)}):this.rgb=t.split("").map(function(t){return parseInt(t+t,16)}),this.alpha="number"==typeof e?e:1};v.prototype={eval:function(){return this},toCSS:function(){return this.alpha<1?"rgba("+this.rgb.map(function(t){return Math.round(t)}).concat(this.alpha).join(", ")+")":"#"+this.rgb.map(function(t){return t=Math.round(t),t=(t>255?255:t<0?0:t).toString(16),1===t.length?"0"+t:t}).join("")},toHSL:function(){var t,e,i=this.rgb[0]/255,n=this.rgb[1]/255,r=this.rgb[2]/255,a=this.alpha,o=Math.max(i,n,r),s=Math.min(i,n,r),l=(o+s)/2,c=o-s;if(o===s)t=e=0;else{switch(e=l>.5?c/(2-o-s):c/(o+s),o){case i:t=(n-r)/c+(n<r?6:0);break;case n:t=(r-i)/c+2;break;case r:t=(i-n)/c+4}t/=6}return{h:360*t,s:e,l:l,a:a}},toARGB:function(){return"#"+[Math.round(255*this.alpha)].concat(this.rgb).map(function(t){return t=Math.round(t),t=(t>255?255:t<0?0:t).toString(16),1===t.length?"0"+t:t}).join("")},mix:function(t,e){var i=this,n=e,r=2*n-1,a=i.toHSL().a-t.toHSL().a,o=((r*a==-1?r:(r+a)/(1+r*a))+1)/2,s=1-o,l=[i.rgb[0]*o+t.rgb[0]*s,i.rgb[1]*o+t.rgb[1]*s,i.rgb[2]*o+t.rgb[2]*s],c=i.alpha*n+t.alpha*(1-n);return new v(l,c)}};var w=function(t,e,i,n){this.start_color=new v(t),this.end_color=new v(e),this.start_value=i,this.end_value=n,this.value_range=n-i};w.prototype.map_value=function(t){return t=Math.max(t,this.start_value),t=Math.min(t,this.end_value),t=(t-this.start_value)/this.value_range,this.start_color.mix(this.end_color,1-t).toCSS()};var y=function(t,e,i,n,r){this.positive_ramp=new w(e,i,0,r),this.negative_ramp=new w(e,t,0,-n),this.start_value=n,this.end_value=r};y.prototype.map_value=function(t){return t=Math.max(t,this.start_value),t=Math.min(t,this.end_value),t>=0?this.positive_ramp.map_value(t):this.negative_ramp.map_value(-t)};var b=function(t,e,i,n,r){d.call(this,t,e,i,n,r);var a,o;if(void 0===this.prefs.min_value){var s=1/0;for(a=0,o=this.data.length;a<o;a++)s=Math.min(s,this.data[a][6]);this.prefs.min_value=s}if(void 0===this.prefs.max_value){var l=-1/0;for(a=0,o=this.data.length;a<o;a++)l=Math.max(l,this.data[a][6]);this.prefs.max_value=l}};b.prototype.default_prefs={min_value:void 0,max_value:void 0,mode:"Heatmap",pos_color:"#FF8C00",neg_color:"#4169E1"},b.prototype.draw=function(t,e,i,n){var r,a,o,s,l,c,u=this.prefs.min_value,d=this.prefs.max_value,h=this.view_start,f=(this.mode,this.data),p=1/Math.sqrt(2),_=new y(this.prefs.neg_color,"#FFFFFF",this.prefs.pos_color,u,d),m=function(t){return(t-h)*n};t.save(),t.rotate(-45*Math.PI/180),t.scale(p,p);for(var g=0,v=f.length;g<v;g++)r=f[g],a=m(r[1]),o=m(r[2]),s=m(r[4]),l=m(r[5]),c=r[6],t.fillStyle=_.map_value(c),t.fillRect(a,s,o-a,l-s);t.restore()};var x=function(t,e,i,n){this.ctx=t,this.row_height=e,this.px_per_base=i,this.draw_details=("Pack"===n||"Auto"===n)&&i>=t.canvas.manager.char_width_px,this.delete_details_thickness=.2};r.extend(x.prototype,{draw_deletion:function(t,e,i){this.ctx.fillStyle="black";var n=(this.draw_details?this.delete_details_thickness:1)*this.row_height;e+=.5*(this.row_height-n),this.ctx.fillRect(t,e,i*this.px_per_base,n)}});var k=function(t,e,i,n,r,a){d.call(this,t,e,i,n,r),this.base_color_fn=a,this.divider_height=1};r.extend(k.prototype,d.prototype,{get_row_height:function(){var t=this.mode;return"Dense"===t?10:"Squish"===t?5:10},get_required_height:function(t){var e=this.prefs.summary_height;return t>1&&this.prefs.show_sample_data&&(e+=this.divider_height+t*this.get_row_height()),e},draw:function(t,e,i,n){t.save();var a,o,s,l,c,u,d,h,f,p,_,m=function(t,e){var i=t.length,n=e.length,r=0,a=1,o=null;return"-"===e?(o="deletion",a=t.length):0===t.indexOf(e)&&i>n?(o="deletion",a=i-n,r=n):0===e.indexOf(t)&&i<n&&(o="insertion",a=n-i,r=n),null!==o?{type:o,start:r,len:a}:{}},g=Math.max(1,Math.floor(n)),v=this.data.length?this.data[0][7].split(",").length:0,w="Squish"===this.mode?5:10,y=n<.1?w:"Squish"===this.mode?3:9,b=!0,k=new x(t,w,n,this.mode);1===v&&(w=y=n<t.canvas.manager.char_width_px?this.prefs.summary_height:w,k.row_height=w,b=!1),this.prefs.show_sample_data&&b&&(t.fillStyle="#F3F3F3",t.globalAlpha=1,t.fillRect(0,this.prefs.summary_height-this.divider_height,e,this.divider_height)),t.textAlign="center";for(var C=0;C<this.data.length;C++)if(a=this.data[C],o=a[1],s=a[3],l=[a[4].split(",")],c=a[7].split(","),u=a.slice(8),l=r.map(r.flatten(l),function(t){var e={type:"snp",value:t,start:0},i=m(s,t);return r.extend(e,i)}),!(o<this.view_start||o>this.view_end)){if(b)for(t.fillStyle="#999999",t.globalAlpha=1,_=0;_<l.length;_++)for(h=this.get_start_draw_pos(o+l[_].start,n),t.fillRect(h,0,g,this.prefs.summary_height),f=this.prefs.summary_height,_=0;_<l.length;_++){t.fillStyle="deletion"===l[_].type?"black":this.base_color_fn(l[_].value);var S=u/c.length,T=Math.ceil(this.prefs.summary_height*S);t.fillRect(h,f-T,g,T),f-=T}if(this.prefs.show_sample_data)for(f=b?this.prefs.summary_height+this.divider_height:0,_=0;_<c.length;_++,f+=w)if(p=c[_]?c[_].split(/\/|\|/):["0","0"],d=null,p[0]===p[1]?"."===p[0]||"0"!==p[0]&&(d=l[parseInt(p[0],10)-1],t.globalAlpha=1):(d="0"!==p[0]?p[0]:p[1],d=l[parseInt(d,10)-1],t.globalAlpha=.5),d)if(h=this.get_start_draw_pos(o+d.start,n),"snp"===d.type){var M=d.value;t.fillStyle=this.base_color_fn(M),k.draw_details?t.fillText(M,this.get_draw_pos(o,n),f+w):t.fillRect(h,f+1,g,y)}else"deletion"===d.type&&k.draw_deletion(h,f+1,d.len)}t.restore()}}),e.default={Scaler:c,LinePainter:h,LinkedFeaturePainter:_,ReadPainter:m,ArcLinkedFeaturePainter:g,DiagonalHeatmapPainter:b,VariantPainter:k}},function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var n=i(3),r=function(t){return t&&t.__esModule?t:{default:t}}(n),a=i(1),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(a),s=o.extend,l=function(t){this.manager=null,this.name=t.name,this.index=t.index,this.tool_id=t.tool_id,this.tool_exp_name=t.tool_exp_name};s(l.prototype,{to_dict:function(){return{name:this.name,index:this.index,tool_id:this.tool_id,tool_exp_name:this.tool_exp_name}}});var c=function(e,i,n){return t("<a/>").attr("href","javascript:void(0);").attr("title",e).addClass("icon-button").addClass(i).tooltip().click(n)},u=function(e){l.call(this,e),this.low="low"in e?e.low:-Number.MAX_VALUE,this.high="high"in e?e.high:Number.MAX_VALUE,this.min="min"in e?e.min:Number.MAX_VALUE,this.max="max"in e?e.max:-Number.MAX_VALUE,this.container=null,this.slider=null,this.slider_label=null;var i=this;i.parent_div=t("<div/>").addClass("filter-row slider-row");var n=t("<div/>").addClass("elt-label").appendTo(i.parent_div),r=(t("<span/>").addClass("slider-name").text(i.name+"  ").appendTo(n),t("<span/>").text(this.low+"-"+this.high)),a=t("<span/>").addClass("slider-value").appendTo(n).append("[").append(r).append("]");i.values_span=r;var o=t("<div/>").addClass("slider").appendTo(i.parent_div);i.control_element=t("<div/>").attr("id",i.name+"-filter-control").appendTo(o),i.control_element.slider({range:!0,min:this.min,max:this.max,step:this.get_slider_step(this.min,this.max),values:[this.low,this.high],slide:function(t,e){i.slide(t,e)},change:function(t,e){i.control_element.slider("option","slide").call(i.control_element,t,e)}}),i.slider=i.control_element,i.slider_label=r,function(e,i,n){e.click(function(){var e=i.text(),r=parseFloat(n.slider("option","max")),a=r<=1?4:r<=1e6?r.toString().length:6,o=!1,s=t(this).parents(".slider-row");s.addClass("input"),n.slider("option","values")&&(a=2*a+1,o=!0),i.text(""),t("<input type='text'/>").attr("size",a).attr("maxlength",a).attr("value",e).appendTo(i).focus().select().click(function(t){t.stopPropagation()}).blur(function(){t(this).remove(),i.text(e),s.removeClass("input")}).keyup(function(e){if(27===e.keyCode)t(this).trigger("blur");else if(13===e.keyCode){var i=n.slider("option","min"),r=n.slider("option","max"),a=function(t){return isNaN(t)||t>r||t<i},l=t(this).val();if(o){if(l=l.split("-"),l=[parseFloat(l[0]),parseFloat(l[1])],a(l[0])||a(l[1]))return alert("Parameter value must be in the range ["+i+"-"+r+"]"),t(this)}else if(l=parseFloat(l),a(l))return alert("Parameter value must be in the range ["+i+"-"+r+"]"),t(this);n.slider(o?"values":"value",l),s.removeClass("input")}})})}(a,r,i.control_element);var s=t("<div/>").addClass("display-controls").appendTo(i.parent_div);this.transparency_icon=c("Use filter for data transparency","layer-transparent",function(){i.manager.alpha_filter!==i?(i.manager.alpha_filter=i,i.manager.parent_div.find(".layer-transparent").removeClass("active").hide(),i.transparency_icon.addClass("active").show()):(i.manager.alpha_filter=null,i.transparency_icon.removeClass("active")),i.manager.track.request_draw({force:!0,clear_after:!0})}).appendTo(s).hide(),this.height_icon=c("Use filter for data height","arrow-resize-090",function(){i.manager.height_filter!==i?(i.manager.height_filter=i,i.manager.parent_div.find(".arrow-resize-090").removeClass("active").hide(),i.height_icon.addClass("active").show()):(i.manager.height_filter=null,i.height_icon.removeClass("active")),i.manager.track.request_draw({force:!0,clear_after:!0})}).appendTo(s).hide(),i.parent_div.hover(function(){i.transparency_icon.show(),i.height_icon.show()},function(){i.manager.alpha_filter!==i&&i.transparency_icon.hide(),i.manager.height_filter!==i&&i.height_icon.hide()}),t("<div style='clear: both;'/>").appendTo(i.parent_div)};s(u.prototype,{to_dict:function(){var t=l.prototype.to_dict.call(this);return s(t,{type:"number",min:this.min,max:this.max,low:this.low,high:this.high})},copy:function(){return new u({name:this.name,index:this.index,tool_id:this.tool_id,tool_exp_name:this.tool_exp_name})},get_slider_step:function(t,e){return e-t<=2?.01:1},slide:function(t,e){var i=e.values;this.values_span.text(i[0]+"-"+i[1]),this.low=i[0],this.high=i[1];var n=this;setTimeout(function(){i[0]===n.low&&i[1]===n.high&&n.manager.track.request_draw({force:!0,clear_after:!0})},25)},applies_to:function(t){return t.length>this.index},_keep_val:function(t){return isNaN(t)||t>=this.low&&t<=this.high},keep:function(t){if(!this.applies_to(t))return!0;var e=t[this.index];if(e instanceof Array){for(var i=!0,n=0;n<e.length;n++)if(!this._keep_val(e[n])){i=!1;break}return i}return this._keep_val(t[this.index])},update_attrs:function(t){var e=!1;if(!this.applies_to(t))return e;var i=t[this.index];i instanceof Array||(i=[i]);for(var n=0;n<i.length;n++){var r=i[n];r<this.min&&(this.min=Math.floor(r),e=!0),r>this.max&&(this.max=Math.ceil(r),e=!0)}return e},update_ui_elt:function(){this.min<this.max?this.parent_div.show():this.parent_div.hide();var t=this.slider.slider("option","min"),e=this.slider.slider("option","max");(this.min<t||this.max>e)&&(this.slider.slider("option","min",this.min),this.slider.slider("option","max",this.max),this.slider.slider("option","step",this.get_slider_step(this.min,this.max)),this.slider.slider("option","values",[this.min,this.max]))}});var d=function(e,i){if(this.track=e,this.alpha_filter=null,this.height_filter=null,this.filters=[],this.parent_div=t("<div/>").addClass("filters").hide(),this.parent_div.bind("drag",function(t){t.stopPropagation()}).click(function(t){t.stopPropagation()}).bind("dblclick",function(t){t.stopPropagation()}).bind("keydown",function(t){t.stopPropagation()}),i&&"filters"in i){for(var n,r=("alpha_filter"in i?i.alpha_filter:null),a=("height_filter"in i?i.height_filter:null),o=i.filters,s=0;s<o.length;s++)"number"===o[s].type?(n=new u(o[s]),this.add_filter(n),n.name===r&&(this.alpha_filter=n,n.transparency_icon.addClass("active").show()),n.name===a&&(this.height_filter=n,n.height_icon.addClass("active").show())):console.log("ERROR: unsupported filter: ",name,type);"visible"in i&&i.visible&&this.parent_div.show()}if(0!==this.filters.length){var l=t("<div/>").addClass("param-row").appendTo(this.parent_div),c=this;t("<input type='submit'/>").attr("value","Run on complete dataset").appendTo(l).click(function(){c.run_on_dataset()})}};s(d.prototype,{show:function(){this.parent_div.show()},hide:function(){this.parent_div.hide()},toggle:function(){this.parent_div.toggle()},visible:function(){return this.parent_div.is(":visible")},to_dict:function(){for(var t,e={},i=[],n=0;n<this.filters.length;n++)t=this.filters[n],i.push(t.to_dict());return e.filters=i,e.alpha_filter=this.alpha_filter?this.alpha_filter.name:null,e.height_filter=this.height_filter?this.height_filter.name:null,e.visible=this.parent_div.is(":visible"),e},copy:function(t){for(var e=new d(t),i=0;i<this.filters.length;i++)e.add_filter(this.filters[i].copy());return e},add_filter:function(t){t.manager=this,this.parent_div.append(t.parent_div),this.filters.push(t)},remove_all:function(){this.filters=[],this.parent_div.children().remove()},init_filters:function(){for(var t=0;t<this.filters.length;t++){this.filters[t].update_ui_elt()}},clear_filters:function(){for(var t=0;t<this.filters.length;t++){var e=this.filters[t];e.slider.slider("option","values",[e.min,e.max])}this.alpha_filter=null,this.height_filter=null,this.parent_div.find(".icon-button").hide()},run_on_dataset:function(){for(var e,i,n=(function(t,e,i){return e in t||(t[e]=i),t[e]}),a={},o=0;o<this.filters.length;o++)e=this.filters[o],e.tool_id&&(e.min!==e.low&&(i=n(a,e.tool_id,[]),i[i.length]=e.tool_exp_name+" >= "+e.low),e.max!==e.high&&(i=n(a,e.tool_id,[]),i[i.length]=e.tool_exp_name+" <= "+e.high));var s=[];for(var l in a)s[s.length]=[l,a[l]];!function e(i,n){var a=n[0],o=a[0],s=a[1],l="("+s.join(") and (")+")",c={cond:l,input:i,target_dataset_id:i,tool_id:o};n=n.slice(1),t.getJSON(run_tool_url,c,function(t){t.error?Galaxy.modal.show({title:(0,r.default)("Filter Dataset"),body:"Error running tool "+o,buttons:{Close:Galaxy.modal.hide()}}):0===n.length?Galaxy.modal.show({title:(0,r.default)("Filtering Dataset"),body:"Filter(s) are running on the complete dataset. Outputs are in dataset's history.",buttons:{Close:Galaxy.modal.hide()}}):e(t.dataset_id,n)})}(this.track.dataset_id,s)}}),e.default={FiltersManager:d,NumberFilter:u}}).call(e,i(0))},function(t,e,i){var n=i(79);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);i(50)("c4dd29aa",n,!0)},function(t,e,i){e=t.exports=i(49)(void 0),e.push([t.i,".citations-formatted{word-wrap:break-word}.citations-bibtex-text{width:100%;height:500px}.citation-padding{padding:5px 10px}",""])},function(t,e){t.exports=function(t,e){for(var i=[],n={},r=0;r<e.length;r++){var a=e[r],o=a[0],s=a[1],l=a[2],c=a[3],u={id:t+":"+r,css:s,media:l,sourceMap:c};n[o]?n[o].parts.push(u):i.push(n[o]={id:o,parts:[u]})}return i}},function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var n=i(51),r=function(t){return t&&t.__esModule?t:{default:t}}(n),a=i(101),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(a),s=i(102),l=i(21);e.default={props:{source:{type:String,required:!0},id:{type:String,required:!0},viewRender:{type:Boolean,requried:!1,default:!0}},data:function(){return{citations:[],content:"",errors:[]}},computed:{formattedReferences:function(){var t=this;return this.citations.reduce(function(e,i){return e.concat('<p class="formatted-reference">'+t.formattedReference(i)+"</p>")},"")}},created:function(){var e=this;r.default.get(Galaxy.root+"api/"+this.source+"/"+this.id+"/citations").then(function(i){e.content="";var n=!0,r=!1,a=void 0;try{for(var s,l=i.data[Symbol.iterator]();!(n=(s=l.next()).done);n=!0){var c=s.value;try{var u={fields:{},entryType:void 0},d=o.toJSON(c.content);if(d){d=t.first(d),u.entryType=d.entryType||void 0;for(var h in d.entryTags)u.fields[h.toLowerCase()]=d.entryTags[h]}e.citations.push(u),e.content+=c.content}catch(t){console.warn("Error parsing bibtex: "+t)}}}catch(t){r=!0,a=t}finally{try{!n&&l.return&&l.return()}finally{if(r)throw a}}}).catch(function(t){console.error(t)})},methods:{formattedReference:function(t){var e=t.entryType,i=t.fields,n="",r=this._asSentence((i.author?i.author:"")+(i.year?" ("+i.year+")":""))+" ",a=i.title||"",o=i.pages?"pp. "+i.pages:"",c=i.address;if("article"==e){var u=(i.volume?i.volume:"")+(i.number?" ("+i.number+")":"")+(o?", "+o:"");n=r+this._asSentence(a)+(i.journal?"In <em>"+i.journal+", ":"")+this._asSentence(u)+this._asSentence(i.address)+"</em>"}else n="inproceedings"==e||"proceedings"==e?r+this._asSentence(a)+(i.booktitle?"In <em>"+i.booktitle+", ":"")+(o||"")+(c?", "+c:"")+".</em>":"mastersthesis"==e||"phdthesis"==e?r+this._asSentence(a)+(i.howpublished?i.howpublished+". ":"")+(i.note?i.note+".":""):"techreport"==e?r+this._asSentence(a)+this._asSentence(i.institution)+this._asSentence(i.number)+this._asSentence(i.type):"book"==e||"inbook"==e||"incollection"==e?r+" "+this._formatBookInfo(i):r+" "+this._asSentence(a)+this._asSentence(i.howpublished)+this._asSentence(i.note);var d="";i.doi&&(d="http://dx.doi.org/"+i.doi,n+='[<a href="'+d+'" target="_blank">doi:'+i.doi+"</a>]");var h=i.url||d;return h&&(n+='[<a href="'+h+'" target="_blank">Link</a>]'),(0,s.convertLaTeX)({onError:function(t,e){return"{"+(0,l.stringifyLaTeX)(e)+"}"}},n)},_formatBookInfo:function(t){var e="";return t.chapter&&(e+=t.chapter+" in "),t.title&&(e+="<em>"+t.title+"</em>"),t.editor&&(e+=", Edited by "+t.editor+", "),t.publisher&&(e+=", "+t.publisher),t.pages&&(e+=", pp. "+t.pages),t.series&&(e+=", <em>"+t.series+"</em>"),t.volume&&(e+=", Vol."+t.volume),t.issn&&(e+=", ISBN: "+t.issn),e+"."},_asSentence:function(t){return t&&t.trim()?t+". ":""},toggleViewRender:function(){this.viewRender=!this.viewRender}}}}).call(e,i(1))},function(t,e,i){"use strict";function n(t){var e=new o(t),i=a(o.prototype.request,e);return r.extend(i,o.prototype,e),r.extend(i,e),i}var r=i(6),a=i(31),o=i(84),s=i(20),l=n(s);l.Axios=o,l.create=function(t){return n(r.merge(s,t))},l.Cancel=i(35),l.CancelToken=i(99),l.isCancel=i(34),l.all=function(t){return Promise.all(t)},l.spread=i(100),t.exports=l,t.exports.default=l},function(t,e){function i(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}function n(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&i(t.slice(0,0))}/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
t.exports=function(t){return null!=t&&(i(t)||n(t)||!!t._isBuffer)}},function(t,e,i){"use strict";function n(t){this.defaults=t,this.interceptors={request:new o,response:new o}}var r=i(20),a=i(6),o=i(94),s=i(95);n.prototype.request=function(t){"string"==typeof t&&(t=a.merge({url:arguments[0]},arguments[1])),t=a.merge(r,this.defaults,{method:"get"},t),t.method=t.method.toLowerCase();var e=[s,void 0],i=Promise.resolve(t);for(this.interceptors.request.forEach(function(t){e.unshift(t.fulfilled,t.rejected)}),this.interceptors.response.forEach(function(t){e.push(t.fulfilled,t.rejected)});e.length;)i=i.then(e.shift(),e.shift());return i},a.forEach(["delete","get","head","options"],function(t){n.prototype[t]=function(e,i){return this.request(a.merge(i||{},{method:t,url:e}))}}),a.forEach(["post","put","patch"],function(t){n.prototype[t]=function(e,i,n){return this.request(a.merge(n||{},{method:t,url:e,data:i}))}}),t.exports=n},function(t,e){function i(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function r(t){if(u===setTimeout)return setTimeout(t,0);if((u===i||!u)&&setTimeout)return u=setTimeout,setTimeout(t,0);try{return u(t,0)}catch(e){try{return u.call(null,t,0)}catch(e){return u.call(this,t,0)}}}function a(t){if(d===clearTimeout)return clearTimeout(t);if((d===n||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(t);try{return d(t)}catch(e){try{return d.call(null,t)}catch(e){return d.call(this,t)}}}function o(){_&&f&&(_=!1,f.length?p=f.concat(p):m=-1,p.length&&s())}function s(){if(!_){var t=r(o);_=!0;for(var e=p.length;e;){for(f=p,p=[];++m<e;)f&&f[m].run();m=-1,e=p.length}f=null,_=!1,a(t)}}function l(t,e){this.fun=t,this.array=e}function c(){}var u,d,h=t.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:i}catch(t){u=i}try{d="function"==typeof clearTimeout?clearTimeout:n}catch(t){d=n}}();var f,p=[],_=!1,m=-1;h.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];p.push(new l(t,e)),1!==p.length||_||r(s)},l.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=c,h.addListener=c,h.once=c,h.off=c,h.removeListener=c,h.removeAllListeners=c,h.emit=c,h.prependListener=c,h.prependOnceListener=c,h.listeners=function(t){return[]},h.binding=function(t){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(t){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(t,e,i){"use strict";var n=i(6);t.exports=function(t,e){n.forEach(t,function(i,n){n!==e&&n.toUpperCase()===e.toUpperCase()&&(t[e]=i,delete t[n])})}},function(t,e,i){"use strict";var n=i(33);t.exports=function(t,e,i){var r=i.config.validateStatus;i.status&&r&&!r(i.status)?e(n("Request failed with status code "+i.status,i.config,null,i.request,i)):t(i)}},function(t,e,i){"use strict";t.exports=function(t,e,i,n,r){return t.config=e,i&&(t.code=i),t.request=n,t.response=r,t}},function(t,e,i){"use strict";function n(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var r=i(6);t.exports=function(t,e,i){if(!e)return t;var a;if(i)a=i(e);else if(r.isURLSearchParams(e))a=e.toString();else{var o=[];r.forEach(e,function(t,e){null!==t&&void 0!==t&&(r.isArray(t)&&(e+="[]"),r.isArray(t)||(t=[t]),r.forEach(t,function(t){r.isDate(t)?t=t.toISOString():r.isObject(t)&&(t=JSON.stringify(t)),o.push(n(e)+"="+n(t))}))}),a=o.join("&")}return a&&(t+=(-1===t.indexOf("?")?"?":"&")+a),t}},function(t,e,i){"use strict";var n=i(6),r=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,i,a,o={};return t?(n.forEach(t.split("\n"),function(t){if(a=t.indexOf(":"),e=n.trim(t.substr(0,a)).toLowerCase(),i=n.trim(t.substr(a+1)),e){if(o[e]&&r.indexOf(e)>=0)return;o[e]="set-cookie"===e?(o[e]?o[e]:[]).concat([i]):o[e]?o[e]+", "+i:i}}),o):o}},function(t,e,i){"use strict";var n=i(6);t.exports=n.isStandardBrowserEnv()?function(){function t(t){var e=t;return i&&(r.setAttribute("href",e),e=r.href),r.setAttribute("href",e),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}var e,i=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");return e=t(window.location.href),function(i){var r=n.isString(i)?t(i):i;return r.protocol===e.protocol&&r.host===e.host}}():function(){return function(){return!0}}()},function(t,e,i){"use strict";function n(){this.message="String contains an invalid character"}function r(t){for(var e,i,r=String(t),o="",s=0,l=a;r.charAt(0|s)||(l="=",s%1);o+=l.charAt(63&e>>8-s%1*8)){if((i=r.charCodeAt(s+=.75))>255)throw new n;e=e<<8|i}return o}var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.prototype=new Error,n.prototype.code=5,n.prototype.name="InvalidCharacterError",t.exports=r},function(t,e,i){"use strict";var n=i(6);t.exports=n.isStandardBrowserEnv()?function(){return{write:function(t,e,i,r,a,o){var s=[];s.push(t+"="+encodeURIComponent(e)),n.isNumber(i)&&s.push("expires="+new Date(i).toGMTString()),n.isString(r)&&s.push("path="+r),n.isString(a)&&s.push("domain="+a),!0===o&&s.push("secure"),document.cookie=s.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()},function(t,e,i){"use strict";function n(){this.handlers=[]}var r=i(6);n.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},n.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},n.prototype.forEach=function(t){r.forEach(this.handlers,function(e){null!==e&&t(e)})},t.exports=n},function(t,e,i){"use strict";function n(t){t.cancelToken&&t.cancelToken.throwIfRequested()}var r=i(6),a=i(96),o=i(34),s=i(20),l=i(97),c=i(98);t.exports=function(t){return n(t),t.baseURL&&!l(t.url)&&(t.url=c(t.baseURL,t.url)),t.headers=t.headers||{},t.data=a(t.data,t.headers,t.transformRequest),t.headers=r.merge(t.headers.common||{},t.headers[t.method]||{},t.headers||{}),r.forEach(["delete","get","head","post","put","patch","common"],function(e){delete t.headers[e]}),(t.adapter||s.adapter)(t).then(function(e){return n(t),e.data=a(e.data,e.headers,t.transformResponse),e},function(e){return o(e)||(n(t),e&&e.response&&(e.response.data=a(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)})}},function(t,e,i){"use strict";var n=i(6);t.exports=function(t,e,i){return n.forEach(i,function(i){t=i(t,e)}),t}},function(t,e,i){"use strict";t.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},function(t,e,i){"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},function(t,e,i){"use strict";function n(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise(function(t){e=t});var i=this;t(function(t){i.reason||(i.reason=new r(t),e(i.reason))})}var r=i(35);n.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},n.source=function(){var t;return{token:new n(function(e){t=e}),cancel:t}},t.exports=n},function(t,e,i){"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},function(t,e,i){!function(t){function e(){this.months=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],this.notKey=[",","{","}"," ","="],this.pos=0,this.input="",this.entries=new Array,this.currentEntry="",this.setInput=function(t){this.input=t},this.getEntries=function(){return this.entries},this.isWhitespace=function(t){return" "==t||"\r"==t||"\t"==t||"\n"==t},this.match=function(t,e){if(void 0!=e&&null!=e||(e=!0),this.skipWhitespace(e),this.input.substring(this.pos,this.pos+t.length)!=t)throw"Token mismatch, expected "+t+", found "+this.input.substring(this.pos);this.pos+=t.length,this.skipWhitespace(e)},this.tryMatch=function(t,e){return void 0!=e&&null!=e||(e=!0),this.skipWhitespace(e),this.input.substring(this.pos,this.pos+t.length)==t},this.matchAt=function(){for(;this.input.length>this.pos&&"@"!=this.input[this.pos];)this.pos++;return"@"==this.input[this.pos]},this.skipWhitespace=function(t){for(;this.isWhitespace(this.input[this.pos]);)this.pos++;if("%"==this.input[this.pos]&&1==t){for(;"\n"!=this.input[this.pos];)this.pos++;this.skipWhitespace(t)}},this.value_braces=function(){var t=0;this.match("{",!1);for(var e=this.pos,i=!1;;){if(!i)if("}"==this.input[this.pos]){if(!(t>0)){var n=this.pos;return this.match("}",!1),this.input.substring(e,n)}t--}else if("{"==this.input[this.pos])t++;else if(this.pos>=this.input.length-1)throw"Unterminated value";i="\\"==this.input[this.pos]&&0==i,this.pos++}},this.value_comment=function(){for(var t="",e=0;!this.tryMatch("}",!1)||0!=e;){if(t+=this.input[this.pos],"{"==this.input[this.pos]&&e++,"}"==this.input[this.pos]&&e--,this.pos>=this.input.length-1)throw"Unterminated value:"+this.input.substring(start);this.pos++}return t},this.value_quotes=function(){this.match('"',!1);for(var t=this.pos,e=!1;;){if(!e){if('"'==this.input[this.pos]){var i=this.pos;return this.match('"',!1),this.input.substring(t,i)}if(this.pos>=this.input.length-1)throw"Unterminated value:"+this.input.substring(t)}e="\\"==this.input[this.pos]&&0==e,this.pos++}},this.single_value=function(){var t=this.pos;if(this.tryMatch("{"))return this.value_braces();if(this.tryMatch('"'))return this.value_quotes();var e=this.key();if(e.match("^[0-9]+$"))return e;if(this.months.indexOf(e.toLowerCase())>=0)return e.toLowerCase();throw"Value expected:"+this.input.substring(t)+" for key: "+e},this.value=function(){var t=[];for(t.push(this.single_value());this.tryMatch("#");)this.match("#"),t.push(this.single_value());return t.join("")},this.key=function(t){for(var e=this.pos;;){if(this.pos>=this.input.length)throw"Runaway key";if(this.notKey.indexOf(this.input[this.pos])>=0)return t&&","!=this.input[this.pos]?(this.pos=e,null):this.input.substring(e,this.pos);this.pos++}},this.key_equals_value=function(){var t=this.key();if(this.tryMatch("=")){this.match("=");var e=this.value();return t=t.trim(),[t,e]}throw"... = value expected, equals sign missing:"+this.input.substring(this.pos)},this.key_value_list=function(){var t=this.key_equals_value();for(this.currentEntry.entryTags={},this.currentEntry.entryTags[t[0]]=t[1];this.tryMatch(",")&&(this.match(","),!this.tryMatch("}"));)t=this.key_equals_value(),this.currentEntry.entryTags[t[0]]=t[1]},this.entry_body=function(t){this.currentEntry={},this.currentEntry.citationKey=this.key(!0),this.currentEntry.entryType=t.substring(1),null!=this.currentEntry.citationKey&&this.match(","),this.key_value_list(),this.entries.push(this.currentEntry)},this.directive=function(){return this.match("@"),"@"+this.key()},this.preamble=function(){this.currentEntry={},this.currentEntry.entryType="PREAMBLE",this.currentEntry.entry=this.value_comment(),this.entries.push(this.currentEntry)},this.comment=function(){this.currentEntry={},this.currentEntry.entryType="COMMENT",this.currentEntry.entry=this.value_comment(),this.entries.push(this.currentEntry)},this.entry=function(t){this.entry_body(t)},this.alernativeCitationKey=function(){this.entries.forEach(function(t){!t.citationKey&&t.entryTags&&(t.citationKey="",t.entryTags.author&&(t.citationKey+=t.entryTags.author.split(",")[0]+=", "),t.citationKey+=t.entryTags.year)})},this.bibtex=function(){for(;this.matchAt();){var t=this.directive();this.match("{"),"@STRING"==t.toUpperCase()?this.string():"@PREAMBLE"==t.toUpperCase()?this.preamble():"@COMMENT"==t.toUpperCase()?this.comment():this.entry(t),this.match("}")}this.alernativeCitationKey()}}t.toJSON=function(t){var i=new e;return i.setInput(t),i.bibtex(),i.entries},t.toBibtex=function(t){var e="";for(var i in t){if(e+="@"+t[i].entryType,e+="{",t[i].citationKey&&(e+=t[i].citationKey+", "),t[i].entry&&(e+=t[i].entry),t[i].entryTags){var n="";for(var r in t[i].entryTags)0!=n.length&&(n+=", "),n+=r+"= {"+t[i].entryTags[r]+"}";e+=n}e+="}\n\n"}return e}}(e)},function(t,e,i){"use strict";function n(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}Object.defineProperty(e,"__esModule",{value:!0}),n(i(103)),n(i(104)),n(i(36)),n(i(39)),n(i(9)),n(i(40)),n(i(145)),n(i(146)),n(i(43))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.aliases={mathfrak:"frak",mathcal:"cal",mathbb:"bb",mathbf:"bf",dfrac:"frac",ldots:"dots"}},function(t,e,i){"use strict";function n(t,e){return a(t,s.mustNotBeUndefined(s.mustBeOk(s.latexParser.parse(e)).value))}function r(t){return a({translateTo:"unicode",mode:"Any"},s.mustNotBeUndefined(s.mustBeOk(s.latexParser.parse(t)).value))}function a(t,e){var i=t.translateTo;switch(i){case"html":throw new Error("Unsupported format: '"+i+"'. Use one of: "+Object.keys(o.supportedMarkups));case"unicode":default:return l.convertLaTeXBlocksToUnicode(t,e).result}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(36),s=i(21),l=i(106);e.convertLaTeX=n,e.convertLaTeXToUnicode=r,e.convertLaTeXBlocks=a},function(t,e,i){"use strict";function n(t,e){var i=t.length,n=e.length;if(0===i)return e;if(0===n)return t;for(var r={},a=0;a<i;a++)r[t[a]]=!0;for(var o=0;o<n;o++)r[e[o]]=!0;var s=[];for(var l in r)r.hasOwnProperty(l)&&s.push(l);return s.sort(),s}function r(t,e){if(!e)return t;if(t.furthest>e.furthest)return t;var i=t.furthest===e.furthest?n(t.expected,e.expected):e.expected;return{status:t.status,index:t.index,value:t.value,furthest:e.furthest,expected:i}}function a(t,e,i,n){return k.Parser(function(a,o){for(var s=n,l=0,c=void 0;o<a.length;){var u=e._(a,o);if(u.status){o=T.mustBeNumber(u.index);break}var d=t._(a,o);if(b(d))return d;if(c=T.mustNotBeUndefined(r(d,c)),b(c))return c;l++;var h=T.mustNotBeUndefined(c.value);s=i(s,h),o=T.mustBeNumber(c.index)}return x(r(k.makeSuccess(o,s),c))})}function o(t,e){return a(t,e,function(t,e){return t.concat([e])},[])}function s(t){return k.Parser(function(e,i){var n=e.charAt(i);if(i>=e.length||t(n))return M.makeFailure(i,"text character");var r=[n];i++;for(var a=e.charAt(i);!t(a)&&i<e.length;)r.push(a),i++,a=e.charAt(i);return k.makeSuccess(i,r.join(""))})}function l(t){return s(u(t)).map(function(t){return S.newTeXRaw(t)})}function c(t,i){return(void 0===i?e.specialCharsDefault:i).hasOwnProperty(t)}function u(t){return function(e){return t.hasOwnProperty(e)}}function d(t,i,n){switch(void 0===i&&(i="_"),void 0===n&&(n="^"),t){case"Math":return e.latexBlockParserMathMode(i,n);default:return e.latexBlockParserTextMode}}function h(t){return t>="A"&&t<="Z"}function f(t){return t>="a"&&t<="z"}function p(t){return q.then(o(d(t,"_"),L)).map(C.newFixArg)}function _(t){return E.then(o(d(t),z)).map(C.newOptArg)}function m(t){return k.alt(p(t),_(t))}function g(t){return k.alt(k.string("{}").map(function(){return[]}),m(t).map(function(t){return t}).atLeast(0)).map(function(t){return t})}function v(t){return k.seqMap(e.commandSymbol,k.alt(e.specialChar,e.takeTill(e.endCmd)),g(t),function(t,e,i){return void 0!==i?C.newTeXComm.apply(void 0,[e].concat(i)):C.newTeXComm(e)}).map(function(t){return t})}function w(t,i,n){return k.seqMap(e.subOrSuperscriptSymbolParser(i,n),g(t),function(t,e){return C.newSubOrSuperScript(t,t===C.SubOrSuperSymbol.SUB?i:n,e)}).map(function(t){return t})}function y(t){return void 0!==t&&!0===t.status}function b(t){return void 0!==t&&!1===t.status}function x(t){if(!y(t))throw new Error("Expected parse to be success: "+JSON.stringify(t));return t}Object.defineProperty(e,"__esModule",{value:!0});var k=i(38),C=i(23),S=i(23),T=i(22),M=i(38);e.defaultParserConf={verbatimEnvironments:["verbatim"]},e.takeTill=function(t){return k.takeWhile(function(e){return!t(e)})};var O=k.regexp(/[^\n]*/),A=k.regexp(/\n?/),R=(k.regexp(/\s*/m),k.string("%")),E=k.string("["),z=k.string("]");e.notTextDefault={$:!0,"%":!0,"\\":!0,"{":!0,"]":!0,"}":!0},e.notTextMathMode={"^":!0,_:!0,$:!0,"%":!0,"\\":!0,"{":!0,"]":!0,"}":!0},e.notTextMathModeAndNotClosingBracket={"^":!0,_:!0,$:!0,"%":!0,"\\":!0,"{":!0,"}":!0},e.notTextDefaultAndNotClosingBracket={$:!0,"%":!0,"\\":!0,"{":!0,"}":!0},e.textParser=l;var P=(l(e.notTextDefault),l(e.notTextDefaultAndNotClosingBracket),k.regexp(/ */).map(S.newTeXRaw));e.comment=R.then(O).skip(A).map(C.newTeXComment),e.specialCharsDefault={"'":!0,"(":!0,")":!0,",":!0,".":!0,"-":!0,'"':!0,"!":!0,"^":!0,$:!0,"&":!0,"#":!0,"{":!0,"}":!0,"%":!0,"~":!0,"|":!0,"/":!0,":":!0,";":!0,"=":!0,"[":!0,"]":!0,"\\":!0,"`":!0," ":!0},e.isSpecialCharacter=c,e.isNotText=u,e.mathSymbol=k.string("$"),e.commandSymbol=k.string("\\"),e.latexBlockParser=d,e.latexBlockParserTextMode=k.lazy(function(){return k.alt(k.alt(l(e.notTextDefault),e.dolMath,e.comment,l(e.notTextDefaultAndNotClosingBracket),e.environment,v("Paragraph")))}),e.latexBlockParserMathMode=function(t,i){return k.lazy(function(){return k.alt(k.alt(w("Math",t,i),l(e.notTextMathMode),e.dolMath,e.comment,l(e.notTextMathModeAndNotClosingBracket),e.environment,v("Math")))})},e.latexParser=e.latexBlockParserTextMode.many();var j=k.string("{").then(e.latexBlockParserTextMode.many()).skip(k.string("}"));e.env=k.Parser(function(t,i){var n=k.string("\\begin").then(k.string("{")).then(P).then(k.regexp(/[a-zA-Z]+/)).skip(P).skip(k.string("}"))._(t,i);if(b(n))return n;i=T.mustBeNumber(n.index);var r=n.value;return o(e.latexBlockParserTextMode,k.string("\\end").then(k.string("{")).then(P).then(k.string(r)).then(P).then(k.string("}"))).map(function(t){return C.newTeXEnv(r,t)})._(t,i)}),e.environment=k.alt(j,e.env),e.specialChar=k.test(c),e.endCmd=function(t){return!f(t)&&!h(t)};var q=k.string("{"),L=k.string("}");e.fixArg=p,e.optArg=_,e.cmdArg=m,e.cmdArgs=g,e.command=v,e.subOrSuperscriptSymbolParser=function(t,e){return k.alt(k.string(t),k.string(e)).map(function(e){return e===t?C.SubOrSuperSymbol.SUB:C.SubOrSuperSymbol.SUP})},e.shiftedScript=w,e.dolMath=function(t,e,i){return void 0===t&&(t="Dollar"),void 0===e&&(e="$"),void 0===i&&(i="$"),k.string(e).then(d("Math","_").many().map(function(n){return C.newTeXMath(t,e,i,n)})).skip(k.string(i))}(),e.isOk=y,e.isNotOk=b,e.mustBeOk=x},function(t,e,i){"use strict";function n(t){return"string"==typeof t}function r(t,e){var i=t;do{t++}while(h.isTeXChar(e[t]));return{result:e.slice(i,t).map(function(t){return t.string}).join(""),blockIndex:t}}function a(t,e,i,r){var a=d(t,r);if(n(a))return{result:a,blockIndex:e+1};for(var o=[],l=[];o.length<a.argumentCount&&e<i.length-1;){e++;var c=e;if(i.length<c-1)throw new Error("Could not gobble "+a.argumentCount+" arguments for "+r.name);var u=i[c];if(h.isTeXRaw(u)){for(var f=/\s+/g,p=u.text.replace(x,""),_=-1,m=0;o.length<a.argumentCount;){var g=f.exec(p);if(!g){o.push.apply(o,b.convertToTeXCharsDefault(p));break}var v=p.substring(m,g.index);_=g.index,m=g.index+v.length,o.push.apply(o,b.convertToTeXCharsDefault(v))}_>=0&&l.push(p.substring(_))}else o.push(u)}e++;var w=o.map(function(e){return s(t,[e]).result}).map(h.newTeXRaw).map(function(t){return h.newFixArg([t])});if(w.length<a.argumentCount)throw new Error("Could not find enough arguments for command \\"+a.name+". Expected "+a.argumentCount+", but found "+w.length);var y=[a.apply(function(){},w)];return l.length>0&&y.push(l.join("")),{result:y.join(""),blockIndex:e}}function o(t){return void 0!==t&&"string"==typeof t.string&&"number"==typeof t.category}function s(t,e){var i=0;if(e.length<=0)return{result:"",blockIndex:i};for(var n=[];i<e.length;){var l=e[i];try{if(o(l)){var c=r(i,e);i=c.blockIndex,n.push(c.result)}else if(h.isTeXComm(l)){var u=a(t,i,e,l);i=u.blockIndex,n.push(u.result)}else if(h.isFixArg(l)||h.isOptArg(l)){var u=s(t,l.latex);n.push(u.result),i++}else if(h.isTextHaving(l))n.push(l.text),i++;else{if(h.isTeXMath(l))return s(t,l.latex);if(h.isTeXRaw(l))n.push(l.text),i++;else if(h.isSubOrSuperScript(l)){var d=l.arguments?l.arguments:[],u=a(t,i,e,h.newTeXComm.apply(void 0,[l.type===h.SubOrSuperSymbol.SUB?"mathsubscript":"mathsuperscript"].concat(d)));i=u.blockIndex,n.push(u.result)}else{if(!h.isArray(l))throw new Error("Can't handle LaTeX block yet: "+JSON.stringify(l)+". Leave an issue at https://github.com/digitalheir/tex-to-unicode/issues");var u=s(t,l);n.push(u.result),i++}}}catch(e){if(void 0===t.onError)throw e;var f=t.onError(e,l);if(void 0===f)throw e;n.push(f),i++}}return{result:n.join(""),blockIndex:i}}function l(t,e){if(e.arguments.length>0){var i=m.expand1argsCommand(e.name,s(t,[e.arguments[0]]).result||"");return e.arguments.length>1?i+s(t,e.arguments.slice(1)).result:i}return _.createCommandHandler(e.name,0,1,function(i,n){var r=n[0],a=n.slice(1);return m.expand1argsCommand(e.name,s(t,[r]).result)+s(t,a).result})}function c(t,e){if(e.arguments.length>1){var i=w.expand2argsCommand(e.name,s(t,[e.arguments[0]]).result||"",s(t,[e.arguments[1]]).result||"");return e.arguments.length>2?i+s(t,e.arguments.slice(1)).result:i}return _.createCommandHandler(e.name,0,2,function(i,n){var r=n[0],a=n[1],o=n.slice(2);return w.expand2argsCommand(e.name,s(t,[r]).result,s(t,[a]).result)+s(t,o).result})}function u(t,e){for(var i=void 0,n=void 0,r=0;void 0===n&&r<e.arguments.length;){var a=e.arguments[r],o=s(t,[a]).result;h.isOptArg(a)&&!i?i=o:n=o,r++}return n?v.convertSqrtToUnicode(n,i):_.createCommandHandler(e.name,1,1,function(e,i){var n=i[0],r=v.convertSqrtToUnicode(s(t,[n]).result);if(i.length>1){var a=i.slice(1);return r+s(t,a).result}return r})}function d(t,e){var i=e.name,n=p.expand0argsCommand(i);if(n)return e.arguments&&e.arguments.length>0?n+s(t,e.arguments).result:n;if(g.is1argsCommand(i))return l(t,e);if(y.is2argsCommand(i))return c(t,e);if("sqrt"===i)return u(t,e);throw f.unknownCommandError(i)}Object.defineProperty(e,"__esModule",{value:!0});var h=i(21),f=i(39),p=i(107),_=i(40),m=i(114),g=i(43),v=i(139),w=i(140),y=i(143),b=i(37),x=/^\s*/;e.isTeXChar2=o,e.convertLaTeXBlocksToUnicode=s,e.convertCommand=d},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(108),r=i(109),a=i(110),o=i(111),s=i(112),l=i(113);e.expand0argsCommand=function(t){for(var e=0,i=[a.barredLUnicode,n.spaceUnicode,o.slashedOUnicode,r.characterUnicode,l.specialCharacter,s.cyrillicUnicode];e<i.length;e++){var c=i[e],u=c(t);if(u)return u}}},function(t,e,i){"use strict";function n(t){return e.spaceCharactersUnicode.hasOwnProperty(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.mathSpace="芇",e.spaceCharactersUnicode={",":" ",quad:" ",qquad:"  "," ":" ",space:" ",";":"　",":":"　",hfill:"\t"},e.isSpaceCharactersUnicode=n,e.spaceUnicode=function(t){return n(t)?e.spaceCharactersUnicode[t]:void 0}},function(t,e,i){"use strict";function n(t){return e.characterUnicodeChart.hasOwnProperty(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.characterUnicodeChart={leftrightsquigarrow:"↭",Longleftrightarrow:"⟺",blacktriangleright:"▶",longleftrightarrow:"⟷",blacktriangledown:"▼",blacktriangleleft:"◀",leftrightharpoons:"⇋",rightleftharpoons:"⇌",twoheadrightarrow:"↠",circlearrowright:"↻",downharpoonright:"⇂",rightharpoondown:"⇁",rightrightarrows:"⇉",twoheadleftarrow:"↞",vartriangleright:"⊳",bigtriangledown:"▽",circlearrowleft:"↺",curvearrowright:"↷",downharpoonleft:"⇃",leftharpoondown:"↽",leftrightarrows:"⇆",rightleftarrows:"⇄",rightsquigarrow:"⇝",rightthreetimes:"⋌",trianglerighteq:"⊵",vartriangleleft:"⊲",Leftrightarrow:"⇔",Longrightarrow:"⟹",curvearrowleft:"↶",dashrightarrow:"⇢",doublebarwedge:"⩞",downdownarrows:"⇊",hookrightarrow:"↪",leftleftarrows:"⇇",leftrightarrow:"↔",leftthreetimes:"⋋",longrightarrow:"⟶",looparrowright:"↬",rightarrowtail:"↣",rightharpoonup:"⇀",sphericalangle:"∢",textregistered:"®",trianglelefteq:"⊴",upharpoonright:"↾",Longleftarrow:"⟸",bigtriangleup:"△",blacktriangle:"▲",dashleftarrow:"⇠",divideontimes:"⋇",fallingdotseq:"≒",hookleftarrow:"↩",leftarrowtail:"↢",leftharpoonup:"↼",longleftarrow:"⟵",looparrowleft:"↫",measuredangle:"∡",shortparallel:"∥",smallsetminus:"∖",texttrademark:"™",triangleright:"▷",upharpoonleft:"↿",blacklozenge:"◆",risingdotseq:"≓",triangledown:"▽",triangleleft:"◁",Rrightarrow:"⇛",Updownarrow:"⇕",backepsilon:"∍",blacksquare:"■",circledcirc:"⊚",circleddash:"⊝",curlyeqprec:"⋞",curlyeqsucc:"⋟",diamondsuit:"♢",preccurlyeq:"≼",succcurlyeq:"≽",textgreater:">",thickapprox:"≈",updownarrow:"↕",vartriangle:"△",Lleftarrow:"⇚",Rightarrow:"⇒",circledast:"⊛",complement:"∁",curlywedge:"⋏",longmapsto:"⟼",registered:"®",rightarrow:"→",smallfrown:"⌢",smallsmile:"⌣",sqsubseteq:"⊑",sqsupseteq:"⊒",textlangle:"〈",textrangle:"〉",upuparrows:"⇈",varepsilon:"ε",varnothing:"∅",Downarrow:"⇓",Leftarrow:"⇐",backprime:"‵",bigotimes:"⨂",centerdot:"⋅",copyright:"©",downarrow:"↓",gtreqless:"⋛",heartsuit:"♡",leftarrow:"←",lesseqgtr:"⋚",pitchfork:"⋔",spadesuit:"♠",therefore:"∴",trademark:"™",triangleq:"≜",varpropto:"∝",approxeq:"≊",barwedge:"⊼",bigoplus:"⨁",bigsqcup:"⨆",biguplus:"⨄",bigwedge:"⋀",boxminus:"⊟",boxtimes:"⊠",circledS:"Ⓢ",clubsuit:"♣",curlyvee:"⋎",doteqdot:"≑",emptyset:"∅",intercal:"⊺",leqslant:"⩽",multimap:"⊸",parallel:"∥",setminus:"∖",sqsubset:"⊏",sqsupset:"⊐",subseteq:"⊆",supseteq:"⊇",textless:"<",thicksim:"∼",triangle:"△",varkappa:"ϰ",varsigma:"ς",vartheta:"ϑ",Diamond:"◇",Uparrow:"⇑",Upsilon:"Υ",backsim:"∽",because:"∵",between:"≬",bigodot:"⨀",bigstar:"★",boxplus:"⊞",ddagger:"‡",diamond:"⋄",digamma:"Ϝ",dotplus:"∔",epsilon:"∊",gtrless:"≷",implies:"⇒",leadsto:"↝",lessdot:"⋖",lessgtr:"≶",lesssim:"≲",lozenge:"◊",natural:"♮",nearrow:"↗",nexists:"∄",nwarrow:"↖",partial:"∂",pilcrow:"¶",precsim:"≾",searrow:"↘",section:"§",succsim:"≿",swarrow:"↙",textbar:"|",uparrow:"↑",upsilon:"υ",Bumpeq:"≎",Lambda:"Λ",Subset:"⋐",Supset:"⋑",Vvdash:"⊪",approx:"≈",bigcap:"⋂",bigcup:"⋃",bigvee:"⋁",bowtie:"⋈",boxdot:"⊡",bullet:"∙",bumpeq:"≏",circeq:"≗",coprod:"∐",dagger:"†",daleth:"ד",degree:"°",eqcirc:"≖",exists:"∃",forall:"∀",gtrdot:"⋗",gtrsim:"≳",hslash:"ℏ",lambda:"λ",lfloor:"⌊",ltimes:"⋉",mapsto:"↦",models:"⊨",ominus:"⊖",oslash:"⊘",otimes:"⊗",preceq:"⪯",propto:"∝",rfloor:"⌋",rtimes:"⋊",square:"□",subset:"⊂",succeq:"⪰",supset:"⊃",varphi:"φ",varrho:"ϱ",veebar:"⊻",Delta:"Δ",Gamma:"Γ",Omega:"Ω",Theta:"Θ",Vdash:"⊩",aleph:"ℵ",Alpha:"Α",alpha:"α",angle:"∠",asymp:"≍",cdots:"⋯",cents:"¢",dashv:"⊣",ddots:"⋱",delta:"δ",doteq:"≐",equiv:"≡",frown:"⌢",gamma:"γ",gimel:"ℷ",infty:"∞",kappa:"κ",Kappa:"Κ",lceil:"⌈",nabla:"∇",notin:"∉",omega:"ω",oplus:"⊕",pound:"£",prime:"′",qquad:"  ",rceil:"⌉",sharp:"♯",sigma:"σ",simeq:"≃",smile:"⌣",space:"␣",sqcap:"⊓",sqcup:"⊔",theta:"θ",times:"×",unlhd:"⊴",unrhd:"⊵",uplus:"⊎",vDash:"⊨",varpi:"ϖ",vdash:"⊢",vdots:"⋮",wedge:"∧",Finv:"Ⅎ",Join:"⋈",atop:"¦",beta:"β",Beta:"Β",beth:"ב",cdot:"⋅",circ:"∘",cong:"≅",dots:"…",euro:"€",flat:"♭",geqq:"≧",hbar:"ℏ",iota:"ι",leqq:"≦",odot:"⊙",oint:"∮",perp:"⊥",prec:"≺",prod:"∏",quad:" ",star:"⋆",succ:"≻",surd:"√",zeta:"ζ",Box:"□",Cap:"⋒",Cup:"⋓",Lsh:"↰",Phi:"Φ",Psi:"Ψ",Rsh:"↱",ast:"∗",bot:"⊥",cap:"∩",chi:"χ",Chi:"Χ",cup:"∪",div:"÷",ell:"ℓ",eta:"η",eth:"ð",geq:"≥",ggg:"⋙",int:"∫",leq:"≤",lhd:"⊲",lll:"⋘",mho:"℧",mid:"∣",neg:"¬",neq:"≠",phi:"ϕ",psi:"ψ",rhd:"⊳",rho:"ρ",Rho:"Ρ",sim:"∼",sum:"∑",tau:"τ",Tau:"Τ",top:"⊤",vee:"∨",Im:"ℑ",Pi:"Π",Re:"ℜ",Xi:"Ξ",ge:"≥",gg:"≫",in:"∈",le:"≤",ll:"≪",mp:"∓",mu:"μ",Mu:"Μ",ni:"∋",nu:"ν",Nu:"Ν",pi:"π",pm:"±",wp:"℘",wr:"≀",xi:"ξ",Omicron:"Ο",omicron:"ο",textdollar:"$",textquotesingle:"'",textbackslash:"\\",textasciigrave:"`",lbrace:"{",vert:"|",rbrace:"}",textasciitilde:"~",textexclamdown:"¡",textcent:"¢",textsterling:"£",textcurrency:"¤",textyen:"¥",textbrokenbar:"¦",textsection:"§",textasciidieresis:"¨",textcopyright:"©",textordfeminine:"ª",guillemotleft:"«",lnot:"¬",textasciimacron:"¯",textdegree:"°",textasciiacute:"´",textparagraph:"¶",textordmasculine:"º",guillemotright:"»",textonequarter:"¼",textonehalf:"½",textthreequarters:"¾",textquestiondown:"¿",AA:"Å",AE:"Æ",DH:"Ð",texttimes:"×",TH:"Þ",ss:"ß",aa:"å",ae:"æ",dh:"ð",th:"þ",DJ:"Đ",dj:"đ",Elzxh:"ħ",i:"ı",NG:"Ŋ",ng:"ŋ",OE:"Œ",oe:"œ",texthvlig:"ƕ",textnrleg:"ƞ",textdoublepipe:"ǂ",Elztrna:"ɐ",Elztrnsa:"ɒ",Elzopeno:"ɔ",Elzrtld:"ɖ",Elzschwa:"ə",Elzpgamma:"ɣ",Elzpbgam:"ɤ",Elztrnh:"ɥ",Elzbtdl:"ɬ",Elzrtll:"ɭ",Elztrnm:"ɯ",Elztrnmlr:"ɰ",Elzltlmr:"ɱ",Elzltln:"ɲ",Elzrtln:"ɳ",Elzclomeg:"ɷ",textphi:"ɸ",Elztrnr:"ɹ",Elztrnrl:"ɺ",Elzrttrnr:"ɻ",Elzrl:"ɼ",Elzrtlr:"ɽ",Elzfhr:"ɾ",Elzrtls:"ʂ",Elzesh:"ʃ",Elztrnt:"ʇ",Elzrtlt:"ʈ",Elzpupsil:"ʊ",Elzpscrv:"ʋ",Elzinvv:"ʌ",Elzinvw:"ʍ",Elztrny:"ʎ",Elzrtlz:"ʐ",Elzyogh:"ʒ",Elzglst:"ʔ",Elzreglst:"ʕ",Elzinglst:"ʖ",textturnk:"ʞ",Elzdyogh:"ʤ",Elztesh:"ʧ",textasciicaron:"ˇ",Elzverts:"ˈ",Elzverti:"ˌ",Elzlmrk:"ː",Elzhlmrk:"ˑ",Elzsbrhr:"˒",Elzsblhr:"˓",Elzrais:"˔",Elzlow:"˕",textasciibreve:"˘",textperiodcentered:"˙",texttildelow:"˜",Epsilon:"Ε",Zeta:"Ζ",Eta:"Η",Iota:"Ι",Sigma:"Σ",texttheta:"θ",textvartheta:"ϑ",Stigma:"Ϛ",Digamma:"Ϝ",Koppa:"Ϟ",Sampi:"Ϡ",textTheta:"ϴ",textendash:"–",textemdash:"—",Vert:"‖",Elzreapos:"‛",textquotedblleft:"“",textquotedblright:"”",textdagger:"†",textdaggerdbl:"‡",textbullet:"•",ldots:"…",textperthousand:"‰",textpertenthousand:"‱",guilsinglleft:"‹",guilsinglright:"›",nolinebreak:"⁠",Elzxrat:"℞",nleftarrow:"↚",nrightarrow:"↛",arrowwaveleft:"↜",arrowwaveright:"↝",nleftrightarrow:"↮",dblarrowupdown:"⇅",nLeftarrow:"⇍",nLeftrightarrow:"⇎",nRightarrow:"⇏",DownArrowUpArrow:"⇵",rightangle:"∟",nmid:"∤",nparallel:"∦",surfintegral:"∯",volintegral:"∰",clwintegral:"∱",Colon:"∷",homothetic:"∻",lazysinv:"∾",NotEqualTilde:"≂",approxnotequal:"≆",tildetrpl:"≋",allequal:"≌",NotHumpDownHump:"≎",NotHumpEqual:"≏",estimates:"≙",starequal:"≛",lneqq:"≨",lvertneqq:"≨",gneqq:"≩",gvertneqq:"≩",NotLessLess:"≪",NotGreaterGreater:"≫",lessequivlnt:"≲",greaterequivlnt:"≳",notlessgreater:"≸",notgreaterless:"≹",precapprox:"≾",NotPrecedesTilde:"≾",succapprox:"≿",NotSucceedsTilde:"≿",subsetneq:"⊊",varsubsetneqq:"⊊",supsetneq:"⊋",varsupsetneq:"⊋",NotSquareSubset:"⊏",NotSquareSuperset:"⊐",truestate:"⊧",forcesextra:"⊨",VDash:"⊫",nvdash:"⊬",nvDash:"⊭",nVdash:"⊮",nVDash:"⊯",original:"⊶",image:"⊷",hermitconjmatrix:"⊹",rightanglearc:"⊾",backsimeq:"⋍",verymuchless:"⋘",verymuchgreater:"⋙",Elzsqspne:"⋥",lnsim:"⋦",gnsim:"⋧",precedesnotsimilar:"⋨",succnsim:"⋩",ntriangleleft:"⋪",ntriangleright:"⋫",ntrianglelefteq:"⋬",ntrianglerighteq:"⋭",upslopeellipsis:"⋰",downslopeellipsis:"⋱",perspcorrespond:"⌆",recorder:"⌕",ulcorner:"⌜",urcorner:"⌝",llcorner:"⌞",lrcorner:"⌟",langle:"〈",rangle:"〉",Elzdlcorn:"⎣",lmoustache:"⎰",rmoustache:"⎱",textvisiblespace:"␣",Elzdshfnc:"┆",Elzsqfnw:"┙",diagup:"╱",Elzvrecto:"▯",Elzcirfl:"◐",Elzcirfr:"◑",Elzcirfb:"◒",Elzrvbull:"◘",Elzsqfl:"◧",Elzsqfr:"◨",Elzsqfse:"◪",bigcirc:"◯",rightmoon:"☾",mercury:"☿",venus:"♀",male:"♂",jupiter:"♃",saturn:"♄",uranus:"♅",neptune:"♆",pluto:"♇",aries:"♈",taurus:"♉",gemini:"♊",cancer:"♋",leo:"♌",virgo:"♍",libra:"♎",scorpio:"♏",sagittarius:"♐",capricornus:"♑",aquarius:"♒",pisces:"♓",quarternote:"♩",eighthnote:"♪",UpArrowBar:"⤒",DownArrowBar:"⤓",Elolarr:"⥀",Elorarr:"⥁",ElzRlarr:"⥂",ElzrLarr:"⥄",Elzrarrx:"⥇",LeftRightVector:"⥎",RightUpDownVector:"⥏",DownLeftRightVector:"⥐",LeftUpDownVector:"⥑",LeftVectorBar:"⥒",RightVectorBar:"⥓",RightUpVectorBar:"⥔",RightDownVectorBar:"⥕",DownLeftVectorBar:"⥖",DownRightVectorBar:"⥗",LeftUpVectorBar:"⥘",LeftDownVectorBar:"⥙",LeftTeeVector:"⥚",RightTeeVector:"⥛",RightUpTeeVector:"⥜",RightDownTeeVector:"⥝",DownLeftTeeVector:"⥞",DownRightTeeVector:"⥟",LeftUpTeeVector:"⥠",LeftDownTeeVector:"⥡",UpEquilibrium:"⥮",ReverseUpEquilibrium:"⥯",RoundImplies:"⥰",Elztfnc:"⦀",Elroang:"⦆",Elzddfnc:"⦙",Angle:"⦜",Elzlpargt:"⦠",ElzLap:"⧊",Elzdefas:"⧋",LeftTriangleBar:"⧏",NotLeftTriangleBar:"⧏",RightTriangleBar:"⧐",NotRightTriangleBar:"⧐",RuleDelayed:"⧴",Elxuplus:"⨄",ElzThr:"⨅",Elxsqcup:"⨆",ElzInf:"⨇",ElzSup:"⨈",ElzCint:"⨍",clockoint:"⨏",sqrint:"⨖",ElzTimes:"⨯",amalg:"⨿",ElzAnd:"⩓",ElzOr:"⩔",ElOr:"⩖",Elzminhat:"⩟",Equal:"⩵",nleqslant:"⩽",geqslant:"⩾",ngeqslant:"⩾",lessapprox:"⪅",gtrapprox:"⪆",lneq:"⪇",gneq:"⪈",lnapprox:"⪉",gnapprox:"⪊",lesseqqgtr:"⪋",gtreqqless:"⪌",eqslantless:"⪕",eqslantgtr:"⪖",NestedLessLess:"⪡",NotNestedLessLess:"⪡",NestedGreaterGreater:"⪢",NotNestedGreaterGreater:"⪢",precneqq:"⪵",succneqq:"⪶",precnapprox:"⪹",succnapprox:"⪺",subseteqq:"⫅",nsubseteqq:"⫅",supseteqq:"⫆",subsetneqq:"⫋",supsetneqq:"⫌",Elztdcol:"⫶",openbracketleft:"〚",openbracketright:"〛"},e.isCharacterUnicode=n,e.characterUnicode=function(t){return n(t)?e.characterUnicodeChart[t]:void 0}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.barredLUnicodeChart={l:"ł",L:"Ł"},e.barredLUnicode=function(t){return e.barredLUnicodeChart[t]}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.slashed_o="ø",e.slashed_O="Ø",e.slashedOUnicodeChart={o:e.slashed_o,O:e.slashed_O},e.slashedOUnicode=function(t){return e.slashedOUnicodeChart[t]}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.cyrillicUnicodeChart={CYRF:"Ф",CYRII:"І",CYROMEGA:"Ѡ",CYRG:"Г",cyrkvcrs:"ҝ",cyryo:"ё",CYRH:"Х",CYRZHDSC:"Җ",cyrphk:"ҧ",CYRTDSC:"Ҭ",CYRI:"И",cyryi:"ї",CYRDZHE:"Џ",cyriote:"ѥ",CYRK:"К",CYRSHHA:"Һ",CYRL:"Л",CYRM:"М",CYRCHLDSC:"Ӌ",CYRNJE:"Њ",CYRYAT:"Ѣ",CYRA:"А",CYRB:"Б",cyrchrdsc:"ҷ",cyrschwa:"ә",CYRDZE:"Ѕ",CYRIE:"Є",CYRC:"Ц",CYRZH:"Ж",CYRD:"Д",CYRABHCHDSC:"Ҿ",CYRFITA:"Ѳ",CYRE:"Е",CYRABHHA:"Ҩ",cyrya:"я",cyrdzhe:"џ",CYRIOTLYUS:"Ѩ",cyrsemisftsn:"ҍ",CYRV:"В",cyrishrt:"й",cyrdje:"ђ",cyrchldsc:"ӌ",CYRY:"Ү",cyrndsc:"ң",CYRZ:"З",CYRKHCRS:"Ҟ",CYRNG:"Ҥ",CYRCHRDSC:"Ҷ",CYRYHCRS:"Ұ",CYRSHCH:"Щ",CYRUSHRT:"Ў",cyryu:"ю",cyrksi:"ѯ",CYRN:"Н",CYRO:"О",CYRBYUS:"Ѫ",CYRP:"П",CYRZDSC:"Ҙ",CYRAE:"Ӕ",CYRR:"Р",CYRS:"С",CYRT:"Т",CYRABHCH:"Ҽ",cyruk:"ѹ",CYRU:"У",cyrii:"і",CYRSEMISFTSN:"Ҍ",cyrghcrs:"ғ",CYRISHRT:"Й",cyromegatitlo:"ѽ",cyrkbeak:"ҡ",cyrie:"є",cyrzdsc:"ҙ",CYRNDSC:"Ң",CYRGUP:"Ґ",cyrshch:"щ",CYRKHK:"Ӄ",cyrzh:"ж",CYRJE:"Ј",cyrthousands:"҂",cyrabhch:"ҽ",textnumero:"№",cyrng:"ҥ",CYRPSI:"Ѱ",CYRTETSE:"Ҵ",CYRIOTBYUS:"Ѭ",cyrnje:"њ",CYRIOTE:"Ѥ",cyrdze:"ѕ",cyrae:"ӕ",CYRHRDSN:"Ъ",CYRKOPPA:"Ҁ",CYRRTICK:"Ҏ",CYRSCHWA:"Ә",cyrtdsc:"ҭ",CYRGHK:"Ҕ",cyrabhha:"ҩ",cyrshha:"һ",CYRSH:"Ш",cyru:"у",cyrkhcrs:"ҟ",cyrt:"т",CYRERY:"Ы",cyrs:"с",cyrr:"р",CYROT:"Ѿ",cyrlyus:"ѧ",CYRNHK:"Ӈ",CYRSFTSN:"Ь",cyrghk:"ҕ",cyrp:"п",cyrabhdze:"ӡ",cyro:"о",CYRTSHE:"Ћ",cyrn:"н",CYRSDSC:"Ҫ",cyryhcrs:"ұ",cyrpsi:"ѱ",cyrz:"з",cyry:"ү",cyrje:"ј",cyrv:"в",cyrchvcrs:"ҹ",cyrkhk:"ӄ",cyre:"е",cyromega:"ѡ",cyrd:"д",cyrc:"ц",cyrb:"б",CYROTLD:"Ө",cyrgup:"ґ",CYRLJE:"Љ",cyra:"а",CYROMEGATITLO:"Ѽ",CYRGHCRS:"Ғ",CYRCHVCRS:"Ҹ",cyrm:"м",cyrl:"л",cyrsh:"ш",cyrk:"к",cyri:"и",cyrh:"х",CYRHDSC:"Ҳ",CYRIZH:"Ѵ",CYRABHDZE:"Ӡ",cyrkdsc:"қ",cyrg:"г",CYRCH:"Ч",cyrf:"ф",CYRYI:"Ї",cyrmillions:"҉",CYRKSI:"Ѯ",CYROMEGARND:"Ѻ",cyrot:"ѿ",cyrtetse:"ҵ",cyrhdsc:"ҳ",cyrushrt:"ў",cyriotlyus:"ѩ",CYRYA:"Я",cyrlje:"љ",cyrotld:"ө",CYRKDSC:"Қ",cyrhrdsn:"ъ",cyrrtick:"ҏ",cyrkoppa:"ҁ",CYRDJE:"Ђ",cyriotbyus:"ѭ",cyrhundredthousands:"҈",CYRpalochka:"Ӏ",CYRKVCRS:"Ҝ",cyromegarnd:"ѻ",cyrsftsn:"ь",cyrabhchdsc:"ҿ",cyrzhdsc:"җ",cyrerev:"э",CYRLYUS:"Ѧ",CYRKBEAK:"Ҡ",cyrery:"ы",CYREREV:"Э",cyrnhk:"ӈ",cyrsdsc:"ҫ",cyrch:"ч",cyrtshe:"ћ",CYRPHK:"Ҧ",CYRYO:"Ё",CYRYU:"Ю",CYRUK:"Ѹ"},e.cyrillicUnicode=function(t){return e.cyrillicUnicodeChart[t]}},function(t,e,i){"use strict";function n(t){return e.specialCharacters.hasOwnProperty(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.specialCharacters={i:"ı",j:"ȷ",oe:"œ",OE:"Œ",ae:"æ",AE:"Æ",aa:"å",AA:"Å",o:"ø",O:"Ø",ss:"ß",l:"ł",L:"Ł"},e.isSpecialCharacter=n,e.specialCharacter=function(t){return n(t)?e.specialCharacters[t]:void 0}},function(t,e,i){"use strict";function n(t,e){switch(t){case"cyrchar":var i=o.translateCharToCyrillic(e);if(i)return i;break;default:for(var n=0,s=[r.diacriticUnicode,a.formattingUnicode];n<s.length;n++){var l=s[n],c=l(t,e);if(c)return c}}throw new Error("No implementation found to expand \\"+t+" with argument {"+e+"}")}Object.defineProperty(e,"__esModule",{value:!0});var r=i(115),a=i(127),o=i(136);e.expand1argsCommand=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(116),r=i(117),a=i(118),o=i(119),s=i(120),l=i(121),c=i(122),u=i(123),d=i(9),h=i(124),f=i(125),p=i(126);e.barUnderLetter=d.simpleSuffix("̱"),e.dotUnderLetter=d.simpleSuffix("̣"),e.breve=d.simpleSuffix("̆"),e.macrron=d.simpleSuffix("̄"),e.dotOverLetter=d.simpleSuffix("̇"),e.longHungarianUmlaut=d.simpleSuffix("̋"),e.modifiersTextModeUnicodeChart={"`":a.graveAccent,"'":r.acuteAccent,"^":o.circumflex,"~":s.tilde,"=":e.macrron,".":e.dotOverLetter,'"':l.dieresis,H:e.longHungarianUmlaut,c:c.cedilla,k:h.ogonek,b:e.barUnderLetter,d:e.dotUnderLetter,r:n.ringOverLetter,u:e.breve,v:u.caron,t:f.tieLetters},e.modifiersMathModeUnicodeChart={check:u.caron,acute:r.acuteAccent,grave:r.acuteAccent,breve:e.breve,vec:p.vectorArrow,mathring:n.ringOverLetter},e.diacriticUnicode=function(t,i){var n=e.modifiersTextModeUnicodeChart[t];return n||(n=e.modifiersMathModeUnicodeChart[t]),n&&n(i)}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(8);e.ringOverLetter=n.lookupOrAppend({a:"å",A:"Å",y:"ẙ"},"̊")},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(8);e.acuteAccent=n.lookupOrAppend({e:"é",y:"ý",u:"ú",i:"í",o:"ó",a:"á",E:"É",Y:"Ý",U:"Ú",I:"Í",O:"Ó",A:"Á",cyrk:"ќ",cyrg:"ѓ",CYRK:"Ќ",CYRG:"Ѓ"},"́")},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(8);e.graveAccent=n.lookupOrAppend({e:"è",u:"ù",i:"ì",o:"ò",a:"à",E:"È",U:"Ù",I:"Ì",O:"Ò",A:"À"},"̀")},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(8);e.circumflex=n.lookupOrAppend({e:"ê",u:"û",i:"î",o:"ô",a:"â",E:"Ê",U:"Û",I:"Î",O:"Ô",A:"Â"},"̂")},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(8);e.tilde=n.lookupOrAppend({o:"õ",a:"ã",n:"ñ",O:"Õ",A:"Ã",N:"Ñ"},"̃")},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(8);e.dieresis=n.lookupOrAppend({e:"ë",y:"ÿ",u:"ü",i:"ï",o:"ö",a:"ä",E:"Ë",Y:"Ÿ",U:"Ü",I:"Ï",O:"Ö",A:"Ä"},"̈")},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(8);e.cedilla=n.lookupOrAppend({c:"ç"},"̧")},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(8);e.caron=n.lookupOrAppend({s:"š"},"̌")},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(9);e.ogonek=n.simpleSuffix("̨")},function(t,e,i){"use strict";function n(t){return r(t.charAt(0),t.substring(1))}function r(t,e){return t+"͡"+e}function a(t){return"t"===t}Object.defineProperty(e,"__esModule",{value:!0}),e.tieLetters=n,e.tie2Letters=r,e.isTieLetters=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(8);e.vectorArrow=n.lookupOrAppend({},"⃗")},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(128),r=i(129),a=i(130),o=i(131),s=i(132),l=i(133),c=i(41),u=i(134),d=i(42),h=i(135);e.formattingUnicode=function(t,e){var i=void 0;if(c.isBbCmd(t)?i=n.translateCharToBlackboard:c.isBfCmd(t)?i=r.translateCharToBold:c.isFrakCmd(t)?i=a.translateCharToFraktur:c.isItCmd(t)?i=o.translateCharToItalic:c.isTtCmd(t)?i=s.translateCharToMonospace:c.isCalCmd(t)?i=l.translateCharToCalligraphic:c.isSubCmd(t)?i=u.translateCharToSubscript:c.isSupCmd(t)?i=d.translateCharToSuperscript:c.isMonoCmd(t)&&(i=h.translateCharToMono),i){var f=i;return e.split("").map(function(t){return f(t)||t}).join("")}}},function(t,e,i){"use strict";function n(t){return e.blackboardCharacters.hasOwnProperty(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.blackboardCharacters={A:"𝔸",B:"𝔹",C:"ℂ",D:"𝔻",E:"𝔼",F:"𝔽",G:"𝔾",H:"ℍ",I:"𝕀",J:"𝕁",K:"𝕂",L:"𝕃",M:"𝕄",N:"ℕ",O:"𝕆",P:"ℙ",Q:"ℚ",R:"ℝ",S:"𝕊",T:"𝕋",U:"𝕌",V:"𝕍",W:"𝕎",X:"𝕏",Y:"𝕐",Z:"ℤ",a:"𝕒",b:"𝕓",c:"𝕔",d:"𝕕",e:"𝕖",f:"𝕗",g:"𝕘",h:"𝕙",i:"𝕚",j:"𝕛",k:"𝕜",l:"𝕝",m:"𝕞",n:"𝕟",o:"𝕠",p:"𝕡",q:"𝕢",r:"𝕣",s:"𝕤",t:"𝕥",u:"𝕦",v:"𝕧",w:"𝕨",x:"𝕩",y:"𝕪",z:"𝕫",0:"𝟘",1:"𝟙",2:"𝟚",3:"𝟛",4:"𝟜",5:"𝟝",6:"𝟞",7:"𝟟",8:"𝟠",9:"𝟡"},e.isBlackboardCharacter=n,e.translateCharToBlackboard=function(t){return n(t)?e.blackboardCharacters[t]:void 0}},function(t,e,i){"use strict";function n(t){return e.boldCharacters.hasOwnProperty(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.boldCharacters={A:"𝐀",B:"𝐁",C:"𝐂",D:"𝐃",E:"𝐄",F:"𝐅",G:"𝐆",H:"𝐇",I:"𝐈",J:"𝐉",K:"𝐊",L:"𝐋",M:"𝐌",N:"𝐍",O:"𝐎",P:"𝐏",Q:"𝐐",R:"𝐑",S:"𝐒",T:"𝐓",U:"𝐔",V:"𝐕",W:"𝐖",X:"𝐗",Y:"𝐘",Z:"𝐙",a:"𝐚",b:"𝐛",c:"𝐜",d:"𝐝",e:"𝐞",f:"𝐟",g:"𝐠",h:"𝐡",i:"𝐢",j:"𝐣",k:"𝐤",l:"𝐥",m:"𝐦",n:"𝐧",o:"𝐨",p:"𝐩",q:"𝐪",r:"𝐫",s:"𝐬",t:"𝐭",u:"𝐮",v:"𝐯",w:"𝐰",x:"𝐱",y:"𝐲",z:"𝐳","Α":"𝚨","Β":"𝚩","Γ":"𝚪","Δ":"𝚫","Ε":"𝚬","Ζ":"𝚭","Η":"𝚮","Θ":"𝚯","Ι":"𝚰","Κ":"𝚱","Λ":"𝚲","Μ":"𝚳","Ν":"𝚴","Ξ":"𝚵","Ο":"𝚶","Π":"𝚷","Ρ":"𝚸","ϴ":"𝚹","Σ":"𝚺","Τ":"𝚻","Υ":"𝚼","Φ":"𝚽","Χ":"𝚾","Ψ":"𝚿","Ω":"𝛀","∇":"𝛁","α":"𝛂","β":"𝛃","γ":"𝛄","δ":"𝛅","ε":"𝛆","ζ":"𝛇","η":"𝛈","θ":"𝛉","ι":"𝛊","κ":"𝛋","λ":"𝛌","μ":"𝛍","ν":"𝛎","ξ":"𝛏","ο":"𝛐","π":"𝛑","ρ":"𝛒","ς":"𝛓","σ":"𝛔","τ":"𝛕","υ":"𝛖","φ":"𝛗","χ":"𝛘","ψ":"𝛙","ω":"𝛚","∂":"𝛛","ϵ":"𝛜","ϑ":"𝛝","ϰ":"𝛞","ϕ":"𝛟","ϱ":"𝛠","ϖ":"𝛡",0:"𝟎",1:"𝟏",2:"𝟐",3:"𝟑",4:"𝟒",5:"𝟓",6:"𝟔",7:"𝟕",8:"𝟖",9:"𝟗"},e.isBlackboardCharacter=n,e.translateCharToBold=function(t){return n(t)?e.boldCharacters[t]:void 0}},function(t,e,i){"use strict";function n(t){return e.frakturCharacters.hasOwnProperty(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.frakturCharacters={A:"𝔄",B:"𝔅",C:"ℭ",D:"𝔇",E:"𝔈",F:"𝔉",G:"𝔊",H:"ℌ",I:"ℑ",J:"𝔍",K:"𝔎",L:"𝔏",M:"𝔐",N:"𝔑",O:"𝔒",P:"𝔓",Q:"𝔔",R:"ℜ",S:"𝔖",T:"𝔗",U:"𝔘",V:"𝔙",W:"𝔚",X:"𝔛",Y:"𝔜",Z:"ℨ",a:"𝔞",b:"𝔟",c:"𝔠",d:"𝔡",e:"𝔢",f:"𝔣",g:"𝔤",h:"𝔥",i:"𝔦",j:"𝔧",k:"𝔨",l:"𝔩",m:"𝔪",n:"𝔫",o:"𝔬",p:"𝔭",q:"𝔮",r:"𝔯",s:"𝔰",t:"𝔱",u:"𝔲",v:"𝔳",w:"𝔴",x:"𝔵",y:"𝔶",z:"𝔷"},e.isFrakturCharacter=n,e.translateCharToFraktur=function(t){return n(t)?e.frakturCharacters[t]:void 0}},function(t,e,i){"use strict";function n(t){return e.italicCharacters.hasOwnProperty(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.italicCharacters={A:"𝐴",B:"𝐵",C:"𝐶",D:"𝐷",E:"𝐸",F:"𝐹",G:"𝐺",H:"𝐻",I:"𝐼",J:"𝐽",K:"𝐾",L:"𝐿",M:"𝑀",N:"𝑁",O:"𝑂",P:"𝑃",Q:"𝑄",R:"𝑅",S:"𝑆",T:"𝑇",U:"𝑈",V:"𝑉",W:"𝑊",X:"𝑋",Y:"𝑌",Z:"𝑍",a:"𝑎",b:"𝑏",c:"𝑐",d:"𝑑",e:"𝑒",f:"𝑓",g:"𝑔",h:"ℎ",i:"𝑖",j:"𝑗",k:"𝑘",l:"𝑙",m:"𝑚",n:"𝑛",o:"𝑜",p:"𝑝",q:"𝑞",r:"𝑟",s:"𝑠",t:"𝑡",u:"𝑢",v:"𝑣",w:"𝑤",x:"𝑥",y:"𝑦",z:"𝑧","Α":"𝛢","Β":"𝛣","Γ":"𝛤","Δ":"𝛥","Ε":"𝛦","Ζ":"𝛧","Η":"𝛨","Θ":"𝛩","Ι":"𝛪","Κ":"𝛫","Λ":"𝛬","Μ":"𝛭","Ν":"𝛮","Ξ":"𝛯","Ο":"𝛰","Π":"𝛱","Ρ":"𝛲","ϴ":"𝛳","Σ":"𝛴","Τ":"𝛵","Υ":"𝛶","Φ":"𝛷","Χ":"𝛸","Ψ":"𝛹","Ω":"𝛺","∇":"𝛻","α":"𝛼","β":"𝛽","γ":"𝛾","δ":"𝛿","ε":"𝜀","ζ":"𝜁","η":"𝜂","θ":"𝜃","ι":"𝜄","κ":"𝜅","λ":"𝜆","μ":"𝜇","ν":"𝜈","ξ":"𝜉","ο":"𝜊","π":"𝜋","ρ":"𝜌","ς":"𝜍","σ":"𝜎","τ":"𝜏","υ":"𝜐","φ":"𝜑","χ":"𝜒","ψ":"𝜓","ω":"𝜔","∂":"𝜕","ϵ":"𝜖","ϑ":"𝜗","ϰ":"𝜘","ϕ":"𝜙","ϱ":"𝜚","ϖ":"𝜛"},e.isItalicCharacter=n,e.translateCharToItalic=function(t){return n(t)?e.italicCharacters[t]:void 0}},function(t,e,i){"use strict";function n(t){return e.monospaceCharacters.hasOwnProperty(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.monospaceCharacters={A:"𝙰",B:"𝙱",C:"𝙲",D:"𝙳",E:"𝙴",F:"𝙵",G:"𝙶",H:"𝙷",I:"𝙸",J:"𝙹",K:"𝙺",L:"𝙻",M:"𝙼",N:"𝙽",O:"𝙾",P:"𝙿",Q:"𝚀",R:"𝚁",S:"𝚂",T:"𝚃",U:"𝚄",V:"𝚅",W:"𝚆",X:"𝚇",Y:"𝚈",Z:"𝚉",a:"𝚊",b:"𝚋",c:"𝚌",d:"𝚍",e:"𝚎",f:"𝚏",g:"𝚐",h:"𝚑",i:"𝚒",j:"𝚓",k:"𝚔",l:"𝚕",m:"𝚖",n:"𝚗",o:"𝚘",p:"𝚙",q:"𝚚",r:"𝚛",s:"𝚜",t:"𝚝",u:"𝚞",v:"𝚟",w:"𝚠",x:"𝚡",y:"𝚢",z:"𝚣",0:"𝟶",1:"𝟷",2:"𝟸",3:"𝟹",4:"𝟺",5:"𝟻",6:"𝟼",7:"𝟽",8:"𝟾",9:"𝟿"},e.isMonospaceCharacter=n,e.translateCharToMonospace=function(t){return n(t)?e.monospaceCharacters[t]:void 0}},function(t,e,i){"use strict";function n(t){return e.calligraphicLetters.hasOwnProperty(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.calligraphicLetters={A:"𝓐",B:"𝓑",C:"𝓒",D:"𝓓",E:"𝓔",F:"𝓕",G:"𝓖",H:"𝓗",I:"𝓘",J:"𝓙",K:"𝓚",L:"𝓛",M:"𝓜",N:"𝓝",O:"𝓞",P:"𝓟",Q:"𝓠",R:"𝓡",S:"𝓢",T:"𝓣",U:"𝓤",V:"𝓥",W:"𝓦",X:"𝓧",Y:"𝓨",Z:"𝓩",a:"𝓪",b:"𝓫",c:"𝓬",d:"𝓭",e:"𝓮",f:"𝓯",g:"𝓰",h:"𝓱",i:"𝓲",j:"𝓳",k:"𝓴",l:"𝓵",m:"𝓶",n:"𝓷",o:"𝓸",p:"𝓹",q:"𝓺",r:"𝓻",s:"𝓼",t:"𝓽",u:"𝓾",v:"𝓿",w:"𝔀",x:"𝔁",y:"𝔂",z:"𝔃"},e.isCalligraphicLetter=n,e.translateCharToCalligraphic=function(t){return n(t)?e.calligraphicLetters[t]:void 0}},function(t,e,i){"use strict";function n(t){return e.subscriptCharacters.hasOwnProperty(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.subscriptCharacters={0:"₀",1:"₁",2:"₂",3:"₃",4:"₄",5:"₅",6:"₆",7:"₇",8:"₈",9:"₉","+":"₊","-":"₋","=":"₌","(":"₍",")":"₎",a:"ₐ",e:"ₑ",h:"ₕ",i:"ᵢ",j:"ⱼ",k:"ₖ",l:"ₗ",m:"ₘ",n:"ₙ",o:"ₒ",p:"ₚ",r:"ᵣ",s:"ₛ",t:"ₜ",u:"ᵤ",v:"ᵥ",x:"ₓ","β":"ᵦ","γ":"ᵧ","ρ":"ᵨ","φ":"ᵩ","χ":"ᵪ"},e.isSubscriptCharacter=n,e.translateCharToSubscript=function(t){return n(t)?e.subscriptCharacters[t]:void 0}},function(t,e,i){"use strict";function n(t){return e.monoCharacters.hasOwnProperty(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.monoCharacters={A:"𝙰",B:"𝙱",C:"𝙲",D:"𝙳",E:"𝙴",F:"𝙵",G:"𝙶",H:"𝙷",I:"𝙸",J:"𝙹",K:"𝙺",L:"𝙻",M:"𝙼",N:"𝙽",O:"𝙾",P:"𝙿",Q:"𝚀",R:"𝚁",S:"𝚂",T:"𝚃",U:"𝚄",V:"𝚅",W:"𝚆",X:"𝚇",Y:"𝚈",Z:"𝚉",a:"𝚊",b:"𝚋",c:"𝚌",d:"𝚍",e:"𝚎",f:"𝚏",g:"𝚐",h:"𝚑",i:"𝚒",j:"𝚓",k:"𝚔",l:"𝚕",m:"𝚖",n:"𝚗",o:"𝚘",p:"𝚙",q:"𝚚",r:"𝚛",s:"𝚜",t:"𝚝",u:"𝚞",v:"𝚟",w:"𝚠",x:"𝚡",y:"𝚢",z:"𝚣",0:"𝟶",1:"𝟷",2:"𝟸",3:"𝟹",4:"𝟺",5:"𝟻",6:"𝟼",7:"𝟽",8:"𝟾",9:"𝟿"},e.isMonoCharacter=n,e.translateCharToMono=function(t){return n(t)?e.monoCharacters[t]:void 0}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.cyrillicCharacters={"Ф":"Ф","І":"І","Ѡ":"Ѡ","Г":"Г","ҝ":"ҝ","ё":"ё","Х":"Х","Җ":"Җ","ҧ":"ҧ","Ҭ":"Ҭ","И":"И","ї":"ї","Џ":"Џ","ѥ":"ѥ","К":"К","Һ":"Һ","Л":"Л","М":"М","Ӌ":"Ӌ","Њ":"Њ","Ѣ":"Ѣ","А":"А","Б":"Б","ҷ":"ҷ","ә":"ә","Ѕ":"Ѕ","Є":"Є","Ц":"Ц","Ж":"Ж","Д":"Д","Ҿ":"Ҿ","Ѳ":"Ѳ","Е":"Е","Ҩ":"Ҩ","я":"я","џ":"џ","Ѩ":"Ѩ","ҍ":"ҍ","В":"В","й":"й","ђ":"ђ","ӌ":"ӌ","Ү":"Ү","ң":"ң","З":"З","Ҟ":"Ҟ","Ҥ":"Ҥ","Ҷ":"Ҷ","Ұ":"Ұ","Щ":"Щ","Ў":"Ў","ю":"ю","ѯ":"ѯ","Н":"Н","О":"О","Ѫ":"Ѫ","П":"П","Ҙ":"Ҙ","Ӕ":"Ӕ","Р":"Р","С":"С","Т":"Т","Ҽ":"Ҽ","ѹ":"ѹ","У":"У","і":"і","Ҍ":"Ҍ","ғ":"ғ","Й":"Й","ѽ":"ѽ","ҡ":"ҡ","є":"є","ҙ":"ҙ","Ң":"Ң","Ґ":"Ґ","щ":"щ","Ӄ":"Ӄ","ж":"ж","Ј":"Ј","҂":"҂","ҽ":"ҽ","№":"№","ҥ":"ҥ","Ѱ":"Ѱ","Ҵ":"Ҵ","Ѭ":"Ѭ","њ":"њ","Ѥ":"Ѥ","ѕ":"ѕ","ӕ":"ӕ","Ъ":"Ъ","Ҁ":"Ҁ","Ҏ":"Ҏ","Ә":"Ә","ҭ":"ҭ","Ҕ":"Ҕ","ҩ":"ҩ","һ":"һ","Ш":"Ш","у":"у","ҟ":"ҟ","т":"т","Ы":"Ы","с":"с","р":"р","Ѿ":"Ѿ","ѧ":"ѧ","Ӈ":"Ӈ","Ь":"Ь","ҕ":"ҕ","п":"п","ӡ":"ӡ","о":"о","Ћ":"Ћ","н":"н","Ҫ":"Ҫ","ұ":"ұ","ѱ":"ѱ","з":"з","ү":"ү","̏":"̏","ј":"ј","в":"в","ҹ":"ҹ","ӄ":"ӄ","е":"е","ѡ":"ѡ","д":"д","ц":"ц","б":"б","Ө":"Ө","ґ":"ґ","Љ":"Љ","а":"а","Ѽ":"Ѽ","Ғ":"Ғ","Ҹ":"Ҹ","м":"м","л":"л","ш":"ш","к":"к","и":"и","х":"х","Ҳ":"Ҳ","Ѵ":"Ѵ","Ӡ":"Ӡ","қ":"қ","г":"г","Ч":"Ч","ф":"ф","Ї":"Ї","҉":"҉","Ѯ":"Ѯ","Ѻ":"Ѻ","ѿ":"ѿ","ҵ":"ҵ","ҳ":"ҳ","ў":"ў","ѩ":"ѩ","Я":"Я","љ":"љ","ө":"ө","Қ":"Қ","ъ":"ъ","ҏ":"ҏ","ҁ":"ҁ","Ђ":"Ђ","ѭ":"ѭ","҈":"҈","Ӏ":"Ӏ","Ҝ":"Ҝ","ѻ":"ѻ","ь":"ь","ҿ":"ҿ","җ":"җ","э":"э","Ѧ":"Ѧ","Ҡ":"Ҡ","ы":"ы","Э":"Э","ӈ":"ӈ","ҫ":"ҫ","ч":"ч","ћ":"ћ","Ҧ":"Ҧ","Ё":"Ё","Ю":"Ю","Ѹ":"Ѹ","ќ":"ќ","ѓ":"ѓ","Ќ":"Ќ","Ѓ":"Ѓ"},e.isCyrillicCharacter=function(t){return e.cyrillicCharacters.hasOwnProperty(t)},e.translateCharToCyrillic=function(t){return e.isCyrillicCharacter(t)?e.cyrillicCharacters[t]:void 0}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.spaceCmds1arg={kern:!0,hskip:!0,hspace:!0,hphantom:!0}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.diacriticsTextMode={"`":!0,"'":!0,"^":!0,"~":!0,"=":!0,".":!0,'"':!0,H:!0,c:!0,k:!0,b:!0,d:!0,r:!0,u:!0,v:!0},e.diacriticsMathMode={hat:!0,widehat:!0,check:!0,tilde:!0,widetilde:!0,acute:!0,grave:!0,dot:!0,ddot:!0,breve:!0,bar:!0,vec:!0,mathring:!0}},function(t,e,i){"use strict";function n(t){var e=t?t.trim():void 0;if(!e)return"√";switch(e){case"2":return"√";case"3":return"∛";case"4":return"∜";default:for(var i=[],n=0;n<e.length;n++){var r=a.translateCharToSuperscript(e.charAt(n));if(!r)throw new Error('Could not translate "'+r+'" to superscript');i.push(r)}return i.join("")+"√"}}function r(t,e){var i=n(e),r=t.trim();return""===r?i:i+"("+r+")"}Object.defineProperty(e,"__esModule",{value:!0});var a=i(42);e.convertSqrtToUnicode=r},function(t,e,i){"use strict";function n(t,e,i){switch(t){case"frac":case"nfrac":case"cfrac":case"xfrac":case"sfrac":return r.convertFracToUnicode(e,i);case"binom":return a.convertBinom(e,i)}throw new Error("No implementation found to expand \\"+t+" with arguments {"+e+", "+i)}Object.defineProperty(e,"__esModule",{value:!0});var r=i(141),a=i(142);e.expand2argsCommand=n},function(t,e,i){"use strict";function n(t,e){return"1"===t&&"2"===e?"½":"1"===t&&"3"===e?"⅓":"1"===t&&"4"===e?"¼":"1"===t&&"5"===e?"⅕":"1"===t&&"6"===e?"⅙":"1"===t&&"8"===e?"⅛":"2"===t&&"3"===e?"⅔":"2"===t&&"5"===e?"⅖":"3"===t&&"4"===e?"¾":"3"===t&&"5"===e?"⅗":"3"===t&&"8"===e?"⅜":"4"===t&&"5"===e?"⅘":"5"===t&&"6"===e?"⅚":"5"===t&&"8"===e?"⅝":"7"===t&&"8"===e?"⅞":o.test(t)&&o.test(e)?a+t+"⁄"+e+a:(t=r.isSingleTerm.test(t)?t:r.addParenthesis(t),e=r.isSingleTerm.test(e)?e:r.addParenthesis(e),"("+t+" / "+e+")")}Object.defineProperty(e,"__esModule",{value:!0});var r=i(9),a="‌",o=/^[0-9]*$/;e.convertFracToUnicode=n},function(t,e,i){"use strict";function n(t,e){return t=a.test(t)?t:r.addParenthesis(t),e=a.test(e)?e:r.addParenthesis(e),"("+t+" ¦ "+e+")"}Object.defineProperty(e,"__esModule",{value:!0});var r=i(9),a=/^.$|^[0-9]+$/;e.convertBinom=n},function(t,e,i){"use strict";function n(t){return e.twoArgsCommands.hasOwnProperty(t)}Object.defineProperty(e,"__esModule",{value:!0});var r=i(144);e.twoArgsCommands=Object.assign({},r.fracCmds,{binom:!0}),e.is2argsCommand=n},function(t,e,i){"use strict";function n(t){return e.fracCmds.hasOwnProperty(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.fracCmds={frac:!0,nfrac:!0,cfrac:!0,xfrac:!0,sfrac:!0},e.isFracCmd=n},function(t,e,i){"use strict";function n(t){return{name:t,optionalArguments:0,argumentCount:0}}Object.defineProperty(e,"__esModule",{value:!0}),e.createKnownCommand=n},function(t,e,i){"use strict";function n(t){return{name:t,optionalArguments:0,argumentCount:1}}Object.defineProperty(e,"__esModule",{value:!0}),e.createKnownCommandWith1Arg=n},function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"toolForm"},[i("div",{staticClass:"toolFormTitle"},[t._v("\n        Citations\n        "),t.viewRender?i("button",{staticClass:"btn btn-xs citations-to-bibtex",attrs:{type:"button",title:"Show all in BibTeX format."},on:{click:t.toggleViewRender}},[i("i",{staticClass:"fa fa-pencil-square-o"}),t._v("\n            Show BibTeX\n        ")]):i("button",{staticClass:"btn btn-xs citations-to-formatted",attrs:{type:"button",title:"Return to formatted citation list."},on:{click:t.toggleViewRender}},[i("i",{staticClass:"fa fa-times"}),t._v("\n            Hide BibTeX\n        ")])]),t._v(" "),i("div",{staticClass:"citations-bibtex toolFormBody citation-padding"},["histories"===t.source?i("div",{staticClass:"infomessage"},[t._v("\n            When writing up your analysis, remember to include all references that should be cited in order\n            to completely describe your work. Also, please remember to "),i("a",{attrs:{href:"https://galaxyproject.org/citing-galaxy"}},[t._v("cite Galaxy")]),t._v(".\n        ")]):t._e(),t._v(" "),t.viewRender?i("span",{staticClass:"citations-formatted"},[i("p",{domProps:{innerHTML:t._s(t.formattedReferences)}})]):i("textarea",{staticClass:"citations-bibtex-text"},[t._v("            "+t._s(t.content)+"\n        ")])])])},r=[],a={render:n,staticRenderFns:r};e.a=a},function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var n=i(11),r=function(t){return t&&t.__esModule?t:{default:t}}(n),a=i(149),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(a),s=r.default.GenomeDataManager.extend({load_data:function(e,i,n,r){var a=t.Deferred();this.set_data(e,a);var s=Galaxy.root+"datasets/"+this.get("dataset").id+"/display",l=this;new t.Deferred;return t.when(o.makeBwg(s)).then(function(i,n){t.when(i.readWigData(e.get("chrom"),e.get("start"),e.get("end"))).then(function(t){var i=[],n={max:Number.MIN_VALUE};t.forEach(function(t){n.max!==t.min-1&&(i.push([n.max+1,0]),i.push([t.min-2,0])),i.push([t.min-1,t.score]),i.push([t.max,t.score]),n=t});var r={data:i,region:e,dataset_type:"bigwig"};l.set_data(e,r),a.resolve(r)})}),a}});e.default={BBIDataManager:s}}).call(e,i(0))},function(t,e,i){(function(n){var r,a;r=[i(150),i(151),i(152)],void 0!==(a=function(t,e){"use strict";function i(){}function r(t){t&&(this.id=t)}function a(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}function o(t,e,i){Math.pow(10,6);return n.ajax({type:"GET",dataType:"native",url:t,timeout:5e3,beforeSend:function(t){t.setRequestHeader("Range","bytes="+e+"-"+(e+(i-1)))},xhrFields:{responseType:"arraybuffer"}})}function s(t,e){return t[e]+t[e+1]*b+t[e+2]*x+t[e+3]*k+t[e+4]*C}function l(){}function c(t,e,i,n){this.bwg=t,this.cirTreeOffset=e,this.cirTreeLength=i,this.isSummary=n}function u(t){var e=n.Deferred(),i=new l;return i.url=t,n.when(o(i.url,0,512)).then(function(t){if(!t)return e.resolve(null,"Couldn't fetch file");var r=t,a=new Uint8Array(r),o=new Int16Array(r),l=new Int32Array(r),c=a[0]+b*a[1]+x*a[2]+k*a[3];if(c==g)i.type="bigwig";else{if(c!=w)return c==v||c==y?e.resolve(null,"Currently don't support big-endian BBI files"):e.resolve(null,"Not a supported format, magic=0x"+c.toString(16));i.type="bigbed"}i.version=o[2],i.numZoomLevels=o[3],i.chromTreeOffset=s(a,8),i.unzoomedDataOffset=s(a,16),i.unzoomedIndexOffset=s(a,24),i.fieldCount=o[16],i.definedFieldCount=o[17],i.asOffset=s(a,36),i.totalSummaryOffset=s(a,44),i.uncompressBufSize=l[13],i.extHeaderOffset=s(a,56),i.zoomLevels=[];for(var u=0;u<i.numZoomLevels;++u){var d=l[6*u+16],h=s(a,24*u+72),f=s(a,24*u+80);i.zoomLevels.push({reduction:d,dataOffset:h,indexOffset:f})}n.when(i.readChromTree()).then(function(){i.getAutoSQL(function(t){return i.schema=t,e.resolve(i)})})}),e}function d(t,e,i,n,r){this.bbi=t,this.type=e,this.fieldCount=i,this.offset=n,this.field=r}var h=t.Range,f=t.union,p=t.intersection,_=e.inflateBuffer,m=e.arrayCopy,g=2291137574,v=654086024,w=2273964779,y=3958540679,b=256,x=65536,k=16777216,C=4294967296,S=new RegExp("^[0-9]+,[0-9]+,[0-9]+");return l.prototype.readChromTree=function(){var t=this;this.chromsToIDs={},this.idsToChroms={},this.maxID=0;var e=this.unzoomedDataOffset;return e=e+4-(e-this.chromTreeOffset&3),n.when(o(this.url,this.chromTreeOffset,e-this.chromTreeOffset)).then(function(e){var i=new Uint8Array(e),n=new Int16Array(e),r=new Int32Array(e),a=(r[0],r[1],r[2]),o=(r[3],s(i,16),function(e){var r=i[e],l=n[e/2+1];e+=4;for(var c=0;c<l;++c)if(0===r){e+=a;var u=s(i,e);e+=8,u-=t.chromTreeOffset,o(u)}else{for(var d="",h=0;h<a;++h){var f=i[e++];0!==f&&(d+=String.fromCharCode(f))}var p=i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e+0];i[e+7],i[e+6],i[e+5],i[e+4],e+=8,t.chromsToIDs[d]=p,0===d.indexOf("chr")&&(t.chromsToIDs[d.substr(3)]=p),t.idsToChroms[p]=d,t.maxID=Math.max(t.maxID,p)}});o(32)})},c.prototype.readWigData=function(t,e,i){var n=this.bwg.chromsToIDs[t];return void 0===n?[]:this.readWigDataById(n,e,i)},c.prototype.readWigDataById=function(t,e,i){var r=this,a=n.Deferred();if(!this.cirHeader)return n.when(o(r.bwg.url,this.cirTreeOffset,48)).then(function(o){r.cirHeader=o;var s=new Int32Array(r.cirHeader);r.cirBlockSize=s[1],n.when(r.readWigDataById(t,e,i)).then(function(t){a.resolve(t)})}),a;var l=[],c=0,u=(Date.now(),function(n,r,a,o){return(t<0||n==t)&&r<=i&&a>=e}),d=function(t,e){if(r.bwg.instrument&&console.log("level="+e+"; offset="+t+"; time="+(0|Date.now())),c+=t.length,1==t.length&&t[0]-r.cirTreeOffset==48&&r.cachedCirRoot)return _(r.cachedCirRoot,0,e),void(0===--c&&n.when(r.fetchFeatures(u,l)).then(function(t){a.resolve(t)}));for(var i,o=4+32*r.cirBlockSize,s=0;s<t.length;++s){var d=new h(t[s],t[s]+o);i=i?f(i,d):d}for(var m=i.ranges(),g=0;g<m.length;++g){var v=m[g];p(t,v,e)}},p=function(t,e,i,s){e.max(),e.min();n.when(o(r.bwg.url,e.min(),e.max()-e.min())).then(function(o){for(var s=0;s<t.length;++s)e.contains(t[s])&&(_(o,t[s]-e.min(),i),t[s]-r.cirTreeOffset==48&&t[s]-e.min()==0&&(r.cachedCirRoot=o),0===--c&&n.when(r.fetchFeatures(u,l)).then(function(t){a.resolve(t)}))})},_=function(n,r,a){var o=new Uint8Array(n),c=new Int16Array(n),u=new Int32Array(n),h=o[r],f=c[r/2+1];if(r+=4,0!==h)for(var p=0;p<f;++p){var _=r/4,m=u[_],g=u[_+1],v=u[_+2],w=u[_+3],y=s(o,r+16),b=s(o,r+24);(t<0||m<t||m==t&&g<=i)&&(t<0||v>t||v==t&&w>=e)&&l.push({offset:y,size:b}),r+=32}else{for(var x=[],p=0;p<f;++p){var _=r/4,m=u[_],g=u[_+1],v=u[_+2],w=u[_+3],y=s(o,r+16);(t<0||m<t||m==t&&g<=i)&&(t<0||v>t||v==t&&w>=e)&&x.push(y),r+=24}x.length>0&&d(x,a+1)}};return d([r.cirTreeOffset+48],1),a},c.prototype.fetchFeatures=function(t,e){var r=this,a=n.Deferred();if(e.sort(function(t,e){return(0|t.offset)-(0|e.offset)}),0===e.length)return[];var s=[],l=function(t,e,n,a){a||(a={});var o=new i;o._chromId=t,o.segment=r.bwg.idsToChroms[t],o.min=e,o.max=n,o.type=r.bwg.type;for(var l in a)o[l]=a[l];s.push(o)},c=function(){if(0===e.length){Date.now();return a.resolve(s)}var i=e[0];if(i.data)r.parseFeatures(i.data,l,t),e.splice(0,1),c();else{for(var u=i.offset,d=i.size,h=1;h<e.length&&e[h].offset==u+d;)d+=e[h].size,++h;n.when(o(r.bwg.url,u,d)).then(function(t){for(var i=0,n=0;i<d;){var a,o=e[n];if(r.bwg.uncompressBufSize>0)a=_(t,i+2,o.size-2);else{var s=new Uint8Array(o.size);m(new Uint8Array(t,i,o.size),0,s,0,o.size),a=s.buffer}o.data=a,i+=o.size,++n}c()})}};return c(),a},c.prototype.parseFeatures=function(t,e,i){var a=new Uint8Array(t);if(this.isSummary)for(var o=new Int16Array(t),s=new Int32Array(t),l=new Float32Array(t),c=t.byteLength/32,u=0;u<c;++u){var d=s[8*u],_=s[8*u+1],m=s[8*u+2],g=s[8*u+3],v=(l[8*u+4],l[8*u+5]),w=l[8*u+6];l[8*u+7];if(i(d,_+1,m)){var y={type:"bigwig",score:w/g,maxScore:v};"bigbed"==this.bwg.type&&(y.type="density"),e(d,_+1,m,y)}}else if("bigwig"==this.bwg.type){var o=new Int16Array(t),s=new Int32Array(t),l=new Float32Array(t),d=s[0],b=s[1],x=(s[2],s[3]),k=s[4],C=a[20],c=o[11];if(3==C)for(var u=0;u<c;++u){var T=l[u+6],M=b+u*x+1,O=b+u*x+k;i(d,M,O)&&e(d,M,O,{score:T})}else if(2==C)for(var u=0;u<c;++u){var _=s[2*u+6]+1,m=_+k-1,T=l[2*u+7];i(d,_,m)&&e(d,_,m,{score:T})}else if(1==C)for(var u=0;u<c;++u){var _=s[3*u+6]+1,m=s[3*u+7],T=l[3*u+8];_>m&&(_=m),i(d,_,m)&&e(d,_,m,{score:T})}else console.log("Currently not handling bwgType="+C)}else{if("bigbed"!=this.bwg.type)throw Error("Don't know what to do with "+this.bwg.type);for(var A=0,R=this.bwg.definedFieldCount,E=this.bwg.schema;A<a.length;){var d=a[A+3]<<24|a[A+2]<<16|a[A+1]<<8|a[A+0],_=a[A+7]<<24|a[A+6]<<16|a[A+5]<<8|a[A+4],m=a[A+11]<<24|a[A+10]<<16|a[A+9]<<8|a[A+8];A+=12;for(var z="";;){var P=a[A++];if(0==P)break;z+=String.fromCharCode(P)}var j,q={};if(j=z.length>0?z.split("\t"):[],j.length>0&&R>3&&(q.label=j[0]),j.length>1&&R>4){var T=parseInt(j[1]);isNaN(T)||(q.score=T)}if(j.length>2&&R>5&&(q.orientation=j[2]),j.length>5&&R>8){var L=j[5];S.test(L)&&(q.itemRgb="rgb("+L+")")}if(j.length>R-3&&E)for(var $=R-3;$<j.length;++$)q[E.fields[$+3].name]=j[$];if(i(d,_+1,m,j))if(R<12)e(d,_+1,m,q);else{var N=0|j[3],I=0|j[4],D=0|j[6],G=j[7].split(","),U=j[8].split(",");if(q.exonFrames){var B=q.exonFrames.split(",");q.exonFrames=void 0}q.type="transcript";var F=new r;for(var V in q)F[V]=q[V];if(F.id=j[0],F.segment=this.bwg.idsToChroms[d],F.min=_+1,F.max=m,F.notes=[],q.groups=[F],j.length>9){var H=q.geneName||j[9],Y=H;j.length>10&&(Y=j[10]),q.geneName2&&(Y=q.geneName2);var X=n.extend({},F);X.id=H,X.label=Y,X.type="gene",q.groups.push(X)}for(var J=[],W=0;W<D;++W){var K=(0|U[W])+_,Z=K+(0|G[W]),Q=new h(K,Z);J.push(Q)}for(var tt=f(J),et=tt.ranges(),it=0;it<et.length;++it){var nt=et[it];e(d,nt.min()+1,nt.max(),q)}if(I>N){var rt="+"==q.orientation?new h(N,I+3):new h(N-3,I),at=p(tt,rt);if(at){q.type="translation";for(var ot=at.ranges(),st=0,lt=0;ot[0].min()>et[lt].max();)lt++;for(var it=0;it<ot.length;++it){var ct=it;"-"==q.orientation&&(ct=ot.length-it-1);var nt=ot[ct];if(q.readframe=st,B){var ut=parseInt(B[ct+lt]);"number"==typeof ut&&ut>=0&&ut<=2&&(q.readframe=ut,q.readframeExplicit=!0)}var dt=nt.max()-nt.min();st=(st+dt)%3,e(d,nt.min()+1,nt.max(),q)}}}}}}},c.prototype.getFirstAdjacent=function(t,e,i,n){var r=this.bwg.chromsToIDs[t];if(void 0===r)return n([]);this.getFirstAdjacentById(r,e,i,n)},c.prototype.getFirstAdjacentById=function(t,e,i,n){var r=this;if(!this.cirHeader)return void this.bwg.data.slice(this.cirTreeOffset,48).fetch(function(a){r.cirHeader=a;var o=new Int32Array(r.cirHeader);r.cirBlockSize=o[1],r.getFirstAdjacentById(t,e,i,n)});var a=null,o=-1,l=-1,c=0,u=(Date.now(),function(t,e){c+=t.length;for(var i,n=4+32*r.cirBlockSize,a=0;a<t.length;++a){var o=new h(t[a],t[a]+n);i=i?f(i,o):o}for(var s=i.ranges(),l=0;l<s.length;++l){var u=s[l];d(t,u,e)}}),d=function(o,s,l,u){s.max(),s.min();r.bwg.data.slice(s.min(),s.max()-s.min()).fetch(function(u){for(var d=0;d<o.length;++d)if(s.contains(o[d])&&(p(u,o[d]-s.min(),l),0==--c)){if(!a)return i>0&&(0!=t||e>0)?r.getFirstAdjacentById(0,0,i,n):i<0&&(t!=r.bwg.maxID||e<1e9)?r.getFirstAdjacentById(r.bwg.maxID,1e9,i,n):n([]);r.fetchFeatures(function(n,r,a,o){return i<0&&(n<t||a<e)||i>0&&(n>t||r>e)},[a],function(t){for(var e=null,r=-1,a=-1,o=0;o<t.length;++o){var s=t[o],l=s._chromId,c=s.min,u=s.max;(null==e||i<0&&(l>r||u>a)||i>0&&(l<r||c<a))&&(e=s,a=i<0?u:c,r=l)}return n(null!=e?[e]:[])})}})},p=function(n,c,d){var h=new Uint8Array(n),f=new Int16Array(n),p=new Int32Array(n),_=h[c],m=f[c/2+1];if(c+=4,0!=_)for(var g=0;g<m;++g){var v=c/4,w=p[v],y=p[v+1],b=p[v+2],x=p[v+3],k=s(h,c+16),C=s(h,c+24);(i<0&&(w<t||w==t&&y<=e)||i>0&&(b>t||b==t&&x>=e))&&(/_random/.exec(r.bwg.idsToChroms[w])||(null==a||i<0&&(b>o||b==o&&x>l)||i>0&&(w<o||w==o&&y<l))&&(a={offset:k,size:C},l=i<0?x:y,o=i<0?b:w)),c+=32}else{for(var S=-1,T=-1,g=0;g<m;++g){var v=c/4,w=p[v],y=p[v+1],b=p[v+2],x=p[v+3],k=p[v+4]<<32|p[v+5];(i<0&&(w<t||w==t&&y<=e)&&b>=t||i>0&&(b>t||b==t&&x>=e)&&w<=t)&&(S<0||x>T)&&(S=k,T=i<0?x:y,i<0?b:w),c+=24}S>=0&&u([S],d+1)}};u([r.cirTreeOffset+48],1)},l.prototype.readWigData=function(t,e,i){var n,r=i-e;if(r<=25e3||0===this.zoomLevels.length)n=this.getUnzoomedView();else for(var a=0;a<this.zoomLevels.length;a++)if(r/this.zoomLevels[a].reduction<25e3){n=this.getZoomedView(a);break}return n.readWigData(t,e,i)},l.prototype.getUnzoomedView=function(){if(!this.unzoomedView){var t=4e3;this.zoomLevels[0]&&(t=this.zoomLevels[0].dataOffset-this.unzoomedIndexOffset),this.unzoomedView=new c(this,this.unzoomedIndexOffset,t,!1)}return this.unzoomedView},l.prototype.getZoomedView=function(t){var e=this.zoomLevels[t];return e.view||(e.view=new c(this,e.indexOffset,4e3,!0)),e.view},l.prototype._tsFetch=function(t,e,i,n,r){var a=this;if(!(t>=this.zoomLevels.length-1)){var o;return o=t<0?this.getUnzoomedView():this.getZoomedView(t),o.readWigDataById(e,i,n,r)}if(this.topLevelReductionCache){for(var s=[],l=this.topLevelReductionCache,c=0;c<l.length;++c)l[c]._chromId==e&&s.push(l[c]);return r(s)}this.getZoomedView(this.zoomLevels.length-1).readWigDataById(-1,0,3e8,function(o){return a.topLevelReductionCache=o,a._tsFetch(t,e,i,n,r)})},l.prototype.thresholdSearch=function(t,e,i,n,r){function a(){if(0==l.length)return r(null);l.sort(function(t,e){var n=t.zoom-e.zoom;return 0!=n?n:(n=t.chrOrd-e.chrOrd,0!=n?n:t.min-e.min*i)});var t=l.splice(0,1)[0];o._tsFetch(t.zoom,t.chr,t.min,t.max,function(o){var s=i>0?0:3e8;t.fromRef&&(s=e);for(var c=0;c<o.length;++c){var u,d=o[c];if(u=void 0!=d.maxScore?d.maxScore:d.score,i>0){if(u>n)if(t.zoom<0){if(d.min>s)return r(d)}else d.max>s&&l.push({chr:t.chr,chrOrd:t.chrOrd,zoom:t.zoom-2,min:d.min,max:d.max,fromRef:t.fromRef})}else if(u>n)if(t.zoom<0){if(d.max<s)return r(d)}else d.min<s&&l.push({chr:t.chr,chrOrd:t.chrOrd,zoom:t.zoom-2,min:d.min,max:d.max,fromRef:t.fromRef})}a()})}i=i<0?-1:1;for(var o=this,s=this.chromsToIDs[t],l=[{chrOrd:0,chr:s,zoom:o.zoomLevels.length-4,min:0,max:3e8,fromRef:!0}],c=1;c<=this.maxID+1;++c){var u=(s+i*c)%(this.maxID+1);u<0&&(u+=this.maxID+1),l.push({chrOrd:c,chr:u,zoom:o.zoomLevels.length-1,min:0,max:3e8})}a()},l.prototype.getAutoSQL=function(t){if(!this.asOffset)return t(null);n.when(o(this.url,this.asOffset,2048)).then(function(e){for(var i=new Uint8Array(e),n="",r=0;r<i.length&&0!=i[r];++r)n+=String.fromCharCode(i[r]);var a=/(\w+)\s+(\w+)\s+("([^"]+)")?\s+\(\s*/,o=/([\w\[\]]+)\s+(\w+)\s*;\s*("([^"]+)")?\s*/g,s=a.exec(n);if(s){var l={declType:s[1],name:s[2],comment:s[4],fields:[]};n=n.substring(s[0]);for(var c=o.exec(n);null!=c;c=o.exec(n))l.fields.push({type:c[1],name:c[2],comment:c[4]});return t(l)}})},l.prototype.getExtraIndices=function(t){var e=this;if(this.version<4||0==this.extHeaderOffset||"bigbed"!=this.type)return t(null);this.data.slice(this.extHeaderOffset,64).fetch(function(i){if(!i)return t(null,"Couldn't fetch extension header");var n=new Uint8Array(i),r=new Int16Array(i),a=(new Int32Array(i),r[0],r[1]),o=s(n,4);if(0==a)return t(null);e.data.slice(o,20*a).fetch(function(i){if(!i)return t(null,"Couldn't fetch index info");for(var n=new Uint8Array(i),r=new Int16Array(i),o=(new Int32Array(i),[]),l=0;l<a;++l){var c=r[10*l],u=r[10*l+1],h=s(n,20*l+4),f=r[10*l+8],p=new d(e,c,u,h,f);o.push(p)}t(o)})})},d.prototype.lookup=function(t,e){var i=this;this.bbi.data.slice(this.offset,32).fetch(function(n){function r(n){i.bbi.data.slice(n,4+c*(u+d)).fetch(function(n){var o=new Uint8Array(n),l=new Uint16Array(n),c=(new Uint32Array(n),o[0]),h=l[1],f=4;if(0!=c){for(var p=0;p<h;++p){for(var _="",m=0;m<u;++m){var g=o[f++];0!=g&&(_+=String.fromCharCode(g))}if(_==t){var v=s(o,f),w=a(o,f+8);return i.bbi.getUnzoomedView().fetchFeatures(function(e,n,r,a){if(a&&a.length>i.field-3)return a[i.field-3]==t},[{offset:v,size:w}],e)}f+=d}return e([])}for(var y=null,p=0;p<h;++p){for(var _="",m=0;m<u;++m){var g=o[f++];0!=g&&(_+=String.fromCharCode(g))}var b=s(o,f);if(f+=8,t.localeCompare(_)<0&&y)return void r(y);y=b}r(y)})}var o=new Uint8Array(n),l=(new Int16Array(n),new Int32Array(n)),c=(l[0],l[1]),u=l[2],d=l[3];s(o,16);r(i.offset+32)})},{makeBwg:u}}.apply(e,r))&&(t.exports=a)}).call(e,i(0))},function(t,e,i){var n,r;n=[],void 0!==(r=function(){"use strict";function t(t,e){if("number"!=typeof t||"number"!=typeof e)throw"Bad range "+t+","+e;this._min=t,this._max=e}function e(t){var e=t.sort(o),i=[],n=e.shift();e.forEach(function(t){t._min<=n._max?t._max>n._max&&(n._max=t._max):(i.push(n),n=t)}),i.push(n),this._ranges=i}function i(t,i){return t instanceof e||(t instanceof Array||(t=[t]),t=new e(t)),i&&t.insertRange(i),t}function n(i,n){for(var r=i.ranges(),a=n.ranges(),o=r.length,s=a.length,l=0,c=0,u=[];l<o&&c<s;){var i=r[l],n=a[c],d=Math.max(i.min(),n.min()),h=Math.min(i.max(),n.max());h>=d&&u.push(new t(d,h)),i.max()>n.max()?++c:++l}return 0==u.length?null:1==u.length?u[0]:new e(u)}function r(t){for(var e=0,i=t.ranges(),n=0;n<i.length;++n){var r=i[n];e+=r.max()-r.min()+1}return e}function a(t,e){return t.min()<e.min()?-1:t.min()>e.min()?1:t.max()<e.max()?-1:e.max()>t.max()?1:0}function o(t,e){return t._min<e._min?-1:t._min>e._min?1:t._max<e._max?-1:e._max>t._max?1:0}return t.prototype.min=function(){return this._min},t.prototype.max=function(){return this._max},t.prototype.contains=function(t){return t>=this._min&&t<=this._max},t.prototype.isContiguous=function(){return!0},t.prototype.ranges=function(){return[this]},t.prototype._pushRanges=function(t){t.push(this)},t.prototype.toString=function(){return"["+this._min+"-"+this._max+"]"},e.prototype.min=function(){return this._ranges[0].min()},e.prototype.max=function(){return this._ranges[this._ranges.length-1].max()},e.prototype.lower_bound=function(t){var e=this.ranges();if(t>this.max())return e.length;if(t<this.min())return 0;for(var i=0,n=e.length-1;i<=n;){var r=Math.floor((i+n)/2);if(t>e[r]._max)i=r+1;else{if(!(t<e[r]._min))return r;n=r-1}}return i},e.prototype.contains=function(t){var e=this.lower_bound(t);return!!(e<this._ranges.length&&this._ranges[e].contains(t))},e.prototype.insertRange=function(t){var e=this.lower_bound(t._min);if(e===this._ranges.length)return void this._ranges.push(t);var i=this.ranges();if(t._max<i[e]._min)return void this._ranges.splice(e,0,t);i[e]._min<t._min&&(t._min=i[e]._min);for(var n=e+1;n<i.length&&i[n]._min<=t._max;)n++;n--,i[n]._max>t._max&&(t._max=i[n]._max),this._ranges.splice(e,n-e+1,t)},e.prototype.isContiguous=function(){return this._ranges.length>1},e.prototype.ranges=function(){return this._ranges},e.prototype._pushRanges=function(t){for(var e=0;e<this._ranges.length;++e)t.push(this._ranges[e])},e.prototype.toString=function(){for(var t="",e=0;e<this._ranges.length;++e)e>0&&(t+=","),t+=this._ranges[e].toString();return t},{Range:t,union:i,intersection:n,coverage:r,rangeOver:a,_rangeOrder:o}}.apply(e,n))&&(t.exports=r)},function(t,e,i){var n,r;n=[],void 0!==(r=function(){function t(){}function e(){this.was=[0]}function i(t,e,i){this.hufts=new Int32Array(3*d),this.window=new Uint8Array(i),this.end=i,this.checkfn=e,this.mode=g,this.reset(t,null),this.left=0,this.table=0,this.index=0,this.blens=null,this.bb=new Int32Array(1),this.tb=new Int32Array(1),this.codes=new n,this.last=0,this.bitk=0,this.bitb=0,this.read=0,this.write=0,this.check=0,this.inftree=new r}function n(){}function r(){}function a(t,e,i,n,r){return t[0]=v,e[0]=w,i[0]=y,n[0]=b,f}function o(t,e,i,n,r){if(0!=r){if(!t)throw"Undef src";if(!i)throw"Undef dest";0==e&&r==t.length?l(t,i,n):A?l(t.subarray(e,e+r),i,n):1==t.BYTES_PER_ELEMENT&&r>100?l(new Uint8Array(t.buffer,t.byteOffset+e,r),i,n):s(t,e,i,n,r)}}function s(t,e,i,n,r){for(var a=0;a<r;++a)i[n+a]=t[e+a]}function l(t,e,i){e.set(t,i)}function c(e,i,n,r){e=i?n?new Uint8Array(e,i,n):new Uint8Array(e,i,e.byteLength-i):new Uint8Array(e);var a=new t;a.inflateInit(u,!0),a.next_in=e,a.next_in_index=0,a.avail_in=e.length;for(var s=[],l=0;;){var c=new Uint8Array(32e3);a.next_out=c,a.next_out_index=0,a.avail_out=c.length;var d=a.inflate(h);if(d!=f&&d!=p&&d!=_)throw a.msg;if(0!=a.avail_out){var m=new Uint8Array(c.length-a.avail_out);o(c,0,m,0,c.length-a.avail_out),c=m}if(s.push(c),l+=c.length,d==p||d==_)break}if(r&&(r[0]=(i||0)+a.next_in_index),1==s.length)return s[0].buffer;for(var g=new Uint8Array(l),v=0,w=0;w<s.length;++w){var y=s[w];o(y,0,g,v,y.length),v+=y.length}return g.buffer}var u=15,d=1440,h=0,f=0,p=1,_=-5,m=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],g=0,v=9,w=5,y=[96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,192,80,7,10,0,8,96,0,8,32,0,9,160,0,8,0,0,8,128,0,8,64,0,9,224,80,7,6,0,8,88,0,8,24,0,9,144,83,7,59,0,8,120,0,8,56,0,9,208,81,7,17,0,8,104,0,8,40,0,9,176,0,8,8,0,8,136,0,8,72,0,9,240,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,200,81,7,13,0,8,100,0,8,36,0,9,168,0,8,4,0,8,132,0,8,68,0,9,232,80,7,8,0,8,92,0,8,28,0,9,152,84,7,83,0,8,124,0,8,60,0,9,216,82,7,23,0,8,108,0,8,44,0,9,184,0,8,12,0,8,140,0,8,76,0,9,248,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,196,81,7,11,0,8,98,0,8,34,0,9,164,0,8,2,0,8,130,0,8,66,0,9,228,80,7,7,0,8,90,0,8,26,0,9,148,84,7,67,0,8,122,0,8,58,0,9,212,82,7,19,0,8,106,0,8,42,0,9,180,0,8,10,0,8,138,0,8,74,0,9,244,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,204,81,7,15,0,8,102,0,8,38,0,9,172,0,8,6,0,8,134,0,8,70,0,9,236,80,7,9,0,8,94,0,8,30,0,9,156,84,7,99,0,8,126,0,8,62,0,9,220,82,7,27,0,8,110,0,8,46,0,9,188,0,8,14,0,8,142,0,8,78,0,9,252,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,194,80,7,10,0,8,97,0,8,33,0,9,162,0,8,1,0,8,129,0,8,65,0,9,226,80,7,6,0,8,89,0,8,25,0,9,146,83,7,59,0,8,121,0,8,57,0,9,210,81,7,17,0,8,105,0,8,41,0,9,178,0,8,9,0,8,137,0,8,73,0,9,242,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,202,81,7,13,0,8,101,0,8,37,0,9,170,0,8,5,0,8,133,0,8,69,0,9,234,80,7,8,0,8,93,0,8,29,0,9,154,84,7,83,0,8,125,0,8,61,0,9,218,82,7,23,0,8,109,0,8,45,0,9,186,0,8,13,0,8,141,0,8,77,0,9,250,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,198,81,7,11,0,8,99,0,8,35,0,9,166,0,8,3,0,8,131,0,8,67,0,9,230,80,7,7,0,8,91,0,8,27,0,9,150,84,7,67,0,8,123,0,8,59,0,9,214,82,7,19,0,8,107,0,8,43,0,9,182,0,8,11,0,8,139,0,8,75,0,9,246,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,206,81,7,15,0,8,103,0,8,39,0,9,174,0,8,7,0,8,135,0,8,71,0,9,238,80,7,9,0,8,95,0,8,31,0,9,158,84,7,99,0,8,127,0,8,63,0,9,222,82,7,27,0,8,111,0,8,47,0,9,190,0,8,15,0,8,143,0,8,79,0,9,254,96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,193,80,7,10,0,8,96,0,8,32,0,9,161,0,8,0,0,8,128,0,8,64,0,9,225,80,7,6,0,8,88,0,8,24,0,9,145,83,7,59,0,8,120,0,8,56,0,9,209,81,7,17,0,8,104,0,8,40,0,9,177,0,8,8,0,8,136,0,8,72,0,9,241,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,201,81,7,13,0,8,100,0,8,36,0,9,169,0,8,4,0,8,132,0,8,68,0,9,233,80,7,8,0,8,92,0,8,28,0,9,153,84,7,83,0,8,124,0,8,60,0,9,217,82,7,23,0,8,108,0,8,44,0,9,185,0,8,12,0,8,140,0,8,76,0,9,249,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,197,81,7,11,0,8,98,0,8,34,0,9,165,0,8,2,0,8,130,0,8,66,0,9,229,80,7,7,0,8,90,0,8,26,0,9,149,84,7,67,0,8,122,0,8,58,0,9,213,82,7,19,0,8,106,0,8,42,0,9,181,0,8,10,0,8,138,0,8,74,0,9,245,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,205,81,7,15,0,8,102,0,8,38,0,9,173,0,8,6,0,8,134,0,8,70,0,9,237,80,7,9,0,8,94,0,8,30,0,9,157,84,7,99,0,8,126,0,8,62,0,9,221,82,7,27,0,8,110,0,8,46,0,9,189,0,8,14,0,8,142,0,8,78,0,9,253,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,195,80,7,10,0,8,97,0,8,33,0,9,163,0,8,1,0,8,129,0,8,65,0,9,227,80,7,6,0,8,89,0,8,25,0,9,147,83,7,59,0,8,121,0,8,57,0,9,211,81,7,17,0,8,105,0,8,41,0,9,179,0,8,9,0,8,137,0,8,73,0,9,243,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,203,81,7,13,0,8,101,0,8,37,0,9,171,0,8,5,0,8,133,0,8,69,0,9,235,80,7,8,0,8,93,0,8,29,0,9,155,84,7,83,0,8,125,0,8,61,0,9,219,82,7,23,0,8,109,0,8,45,0,9,187,0,8,13,0,8,141,0,8,77,0,9,251,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,199,81,7,11,0,8,99,0,8,35,0,9,167,0,8,3,0,8,131,0,8,67,0,9,231,80,7,7,0,8,91,0,8,27,0,9,151,84,7,67,0,8,123,0,8,59,0,9,215,82,7,19,0,8,107,0,8,43,0,9,183,0,8,11,0,8,139,0,8,75,0,9,247,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,207,81,7,15,0,8,103,0,8,39,0,9,175,0,8,7,0,8,135,0,8,71,0,9,239,80,7,9,0,8,95,0,8,31,0,9,159,84,7,99,0,8,127,0,8,63,0,9,223,82,7,27,0,8,111,0,8,47,0,9,191,0,8,15,0,8,143,0,8,79,0,9,255],b=[80,5,1,87,5,257,83,5,17,91,5,4097,81,5,5,89,5,1025,85,5,65,93,5,16385,80,5,3,88,5,513,84,5,33,92,5,8193,82,5,9,90,5,2049,86,5,129,192,5,24577,80,5,2,87,5,385,83,5,25,91,5,6145,81,5,7,89,5,1537,85,5,97,93,5,24577,80,5,4,88,5,769,84,5,49,92,5,12289,82,5,13,90,5,3073,86,5,193,192,5,24577],x=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],k=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,112,112],C=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],S=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];t.prototype.inflateInit=function(t,i){return t||(t=u),i&&(i=!1),this.istate=new e,this.istate.inflateInit(this,i?-t:t)},t.prototype.inflate=function(t){return null==this.istate?-2:this.istate.inflate(this,t)},t.prototype.inflateEnd=function(){if(null==this.istate)return-2;var t=istate.inflateEnd(this);return this.istate=null,t},t.prototype.inflateSync=function(){return istate.inflateSync(this)},t.prototype.inflateSetDictionary=function(t,e){return istate.inflateSetDictionary(this,t,e)},e.prototype.inflateReset=function(t){return null==t||null==t.istate?-2:(t.total_in=t.total_out=0,t.msg=null,t.istate.mode=0!=t.istate.nowrap?7:0,t.istate.blocks.reset(t,null),f)},e.prototype.inflateEnd=function(t){return null!=this.blocks&&this.blocks.free(t),this.blocks=null,f},e.prototype.inflateInit=function(t,e){return t.msg=null,this.blocks=null,nowrap=0,e<0&&(e=-e,nowrap=1),e<8||e>15?(this.inflateEnd(t),-2):(this.wbits=e,t.istate.blocks=new i(t,0!=t.istate.nowrap?null:this,1<<e),this.inflateReset(t),f)},e.prototype.inflate=function(t,e){var i,n;if(null==t||null==t.istate||null==t.next_in)return-2;for(e=4==e?_:f,i=_;;)switch(t.istate.mode){case 0:if(0==t.avail_in)return i;if(i=e,t.avail_in--,t.total_in++,8!=(15&(t.istate.method=t.next_in[t.next_in_index++]))){t.istate.mode=13,t.msg="unknown compression method",t.istate.marker=5;break}if(8+(t.istate.method>>4)>t.istate.wbits){t.istate.mode=13,t.msg="invalid window size",t.istate.marker=5;break}t.istate.mode=1;case 1:if(0==t.avail_in)return i;if(i=e,t.avail_in--,t.total_in++,n=255&t.next_in[t.next_in_index++],((t.istate.method<<8)+n)%31!=0){t.istate.mode=13,t.msg="incorrect header check",t.istate.marker=5;break}if(0==(32&n)){t.istate.mode=7;break}t.istate.mode=2;case 2:if(0==t.avail_in)return i;i=e,t.avail_in--,t.total_in++,t.istate.need=(255&t.next_in[t.next_in_index++])<<24&4278190080,t.istate.mode=3;case 3:if(0==t.avail_in)return i;i=e,t.avail_in--,t.total_in++,t.istate.need+=(255&t.next_in[t.next_in_index++])<<16&16711680,t.istate.mode=4;case 4:if(0==t.avail_in)return i;i=e,t.avail_in--,t.total_in++,t.istate.need+=(255&t.next_in[t.next_in_index++])<<8&65280,t.istate.mode=5;case 5:return 0==t.avail_in?i:(i=e,t.avail_in--,t.total_in++,t.istate.need+=255&t.next_in[t.next_in_index++],t.adler=t.istate.need,t.istate.mode=6,2);case 6:return t.istate.mode=13,t.msg="need dictionary",t.istate.marker=0,-2;case 7:if(-3==(i=t.istate.blocks.proc(t,i))){t.istate.mode=13,t.istate.marker=0;break}if(i==f&&(i=e),i!=p)return i;if(i=e,t.istate.blocks.reset(t,t.istate.was),0!=t.istate.nowrap){t.istate.mode=12;break}t.istate.mode=8;case 8:if(0==t.avail_in)return i;i=e,t.avail_in--,t.total_in++,t.istate.need=(255&t.next_in[t.next_in_index++])<<24&4278190080,t.istate.mode=9;case 9:if(0==t.avail_in)return i;i=e,t.avail_in--,t.total_in++,t.istate.need+=(255&t.next_in[t.next_in_index++])<<16&16711680,t.istate.mode=10;case 10:if(0==t.avail_in)return i;i=e,t.avail_in--,t.total_in++,t.istate.need+=(255&t.next_in[t.next_in_index++])<<8&65280,t.istate.mode=11;case 11:if(0==t.avail_in)return i;if(i=e,t.avail_in--,t.total_in++,t.istate.need+=255&t.next_in[t.next_in_index++],t.istate.was[0]!=t.istate.need){t.istate.mode=13,t.msg="incorrect data check",t.istate.marker=5;break}t.istate.mode=12;case 12:return p;case 13:return-3;default:return-2}},e.prototype.inflateSetDictionary=function(t,e,i){var n=0,r=i;return null==t||null==t.istate||6!=t.istate.mode?-2:t._adler.adler32(1,e,0,i)!=t.adler?-3:(t.adler=t._adler.adler32(0,null,0,0),r>=1<<t.istate.wbits&&(r=(1<<t.istate.wbits)-1,n=i-r),t.istate.blocks.set_dictionary(e,n,r),t.istate.mode=7,f)};var T=[0,0,255,255];e.prototype.inflateSync=function(t){var e,i,n,r,a;if(null==t||null==t.istate)return-2;if(13!=t.istate.mode&&(t.istate.mode=13,t.istate.marker=0),0==(e=t.avail_in))return _;for(i=t.next_in_index,n=t.istate.marker;0!=e&&n<4;)t.next_in[i]==T[n]?n++:n=0!=t.next_in[i]?0:4-n,i++,e--;return t.total_in+=i-t.next_in_index,t.next_in_index=i,t.avail_in=e,t.istate.marker=n,4!=n?-3:(r=t.total_in,a=t.total_out,this.inflateReset(t),t.total_in=r,t.total_out=a,t.istate.mode=7,f)},e.prototype.inflateSyncPoint=function(t){return null==t||null==t.istate||null==t.istate.blocks?-2:t.istate.blocks.sync_point()};var M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];i.prototype.reset=function(t,e){e&&(e[0]=this.check),6==this.mode&&this.codes.free(t),this.mode=g,this.bitk=0,this.bitb=0,this.read=this.write=0,this.checkfn&&(t.adler=this.check=t._adler.adler32(0,null,0,0))},i.prototype.proc=function(t,e){var i,n,r,s,l,c,u;for(s=t.next_in_index,l=t.avail_in,n=this.bitb,r=this.bitk,c=this.write,u=c<this.read?this.read-c-1:this.end-c;;)switch(this.mode){case g:for(;r<3;){if(0==l)return this.bitb=n,this.bitk=r,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=c,this.inflate_flush(t,e);e=f,l--,n|=(255&t.next_in[s++])<<r,r+=8}switch(i=7&n,this.last=1&i,i>>>1){case 0:n>>>=3,r-=3,i=7&r,n>>>=i,r-=i,this.mode=1;break;case 1:var d=new Int32Array(1),h=new Int32Array(1),_=[],v=[];a(d,h,_,v,t),this.codes.init(d[0],h[0],_[0],0,v[0],0,t),n>>>=3,r-=3,this.mode=6;break;case 2:n>>>=3,r-=3,this.mode=3;break;case 3:return n>>>=3,r-=3,this.mode=13,t.msg="invalid block type",e=-3,this.bitb=n,this.bitk=r,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=c,this.inflate_flush(t,e)}break;case 1:for(;r<32;){if(0==l)return this.bitb=n,this.bitk=r,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=c,this.inflate_flush(t,e);e=f,l--,n|=(255&t.next_in[s++])<<r,r+=8}if((~n>>>16&65535)!=(65535&n))return this.mode=13,t.msg="invalid stored block lengths",e=-3,this.bitb=n,this.bitk=r,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=c,this.inflate_flush(t,e);this.left=65535&n,n=r=0,this.mode=0!=this.left?2:0!=this.last?7:g;break;case 2:if(0==l)return this.bitb=n,this.bitk=r,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,write=c,this.inflate_flush(t,e);if(0==u&&(c==end&&0!=read&&(c=0,u=c<this.read?this.read-c-1:this.end-c),0==u&&(this.write=c,e=this.inflate_flush(t,e),c=this.write,u=c<this.read?this.read-c-1:this.end-c,c==this.end&&0!=this.read&&(c=0,u=c<this.read?this.read-c-1:this.end-c),0==u)))return this.bitb=n,this.bitk=r,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=c,this.inflate_flush(t,e);if(e=f,i=this.left,i>l&&(i=l),i>u&&(i=u),o(t.next_in,s,this.window,c,i),s+=i,l-=i,c+=i,u-=i,0!=(this.left-=i))break;this.mode=0!=this.last?7:g;break;case 3:for(;r<14;){if(0==l)return this.bitb=n,this.bitk=r,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=c,this.inflate_flush(t,e);e=f,l--,n|=(255&t.next_in[s++])<<r,r+=8}if(this.table=i=16383&n,(31&i)>29||(i>>5&31)>29)return this.mode=9,t.msg="too many length or distance symbols",e=-3,this.bitb=n,this.bitk=r,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=c,this.inflate_flush(t,e);if(i=258+(31&i)+(i>>5&31),null==this.blens||this.blens.length<i)this.blens=new Int32Array(i);else for(var w=0;w<i;w++)this.blens[w]=0;n>>>=14,r-=14,this.index=0,mode=4;case 4:for(;this.index<4+(this.table>>>10);){for(;r<3;){if(0==l)return this.bitb=n,this.bitk=r,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=c,this.inflate_flush(t,e);e=f,l--,n|=(255&t.next_in[s++])<<r,r+=8}this.blens[M[this.index++]]=7&n,n>>>=3,r-=3}for(;this.index<19;)this.blens[M[this.index++]]=0;if(this.bb[0]=7,(i=this.inftree.inflate_trees_bits(this.blens,this.bb,this.tb,this.hufts,t))!=f)return e=i,-3==e&&(this.blens=null,this.mode=9),this.bitb=n,this.bitk=r,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,write=c,this.inflate_flush(t,e);this.index=0,this.mode=5;case 5:for(;;){if(i=this.table,!(this.index<258+(31&i)+(i>>5&31)))break;var w,y,b;for(i=this.bb[0];r<i;){if(0==l)return this.bitb=n,this.bitk=r,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=c,this.inflate_flush(t,e);e=f,l--,n|=(255&t.next_in[s++])<<r,r+=8}if(i=this.hufts[3*(this.tb[0]+(n&m[i]))+1],(b=this.hufts[3*(this.tb[0]+(n&m[i]))+2])<16)n>>>=i,r-=i,this.blens[this.index++]=b;else{for(w=18==b?7:b-14,y=18==b?11:3;r<i+w;){if(0==l)return this.bitb=n,this.bitk=r,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=c,this.inflate_flush(t,e);e=f,l--,n|=(255&t.next_in[s++])<<r,r+=8}if(n>>>=i,r-=i,y+=n&m[w],n>>>=w,r-=w,w=this.index,i=this.table,w+y>258+(31&i)+(i>>5&31)||16==b&&w<1)return this.blens=null,this.mode=9,t.msg="invalid bit length repeat",e=-3,this.bitb=n,this.bitk=r,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=c,this.inflate_flush(t,e);b=16==b?this.blens[w-1]:0;do{this.blens[w++]=b}while(0!=--y);this.index=w}}this.tb[0]=-1;var d=new Int32Array(1),h=new Int32Array(1),_=new Int32Array(1),v=new Int32Array(1);if(d[0]=9,h[0]=6,i=this.table,(i=this.inftree.inflate_trees_dynamic(257+(31&i),1+(i>>5&31),this.blens,d,h,_,v,this.hufts,t))!=f)return-3==i&&(this.blens=null,this.mode=13),e=i,this.bitb=n,this.bitk=r,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=c,this.inflate_flush(t,e);this.codes.init(d[0],h[0],this.hufts,_[0],this.hufts,v[0],t),this.mode=6;case 6:if(this.bitb=n,this.bitk=r,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=c,(e=this.codes.proc(this,t,e))!=p)return this.inflate_flush(t,e);if(e=f,this.codes.free(t),s=t.next_in_index,l=t.avail_in,n=this.bitb,r=this.bitk,c=this.write,u=c<this.read?this.read-c-1:this.end-c,0==this.last){this.mode=g;break}this.mode=7;case 7:if(this.write=c,e=this.inflate_flush(t,e),c=this.write,u=c<this.read?this.read-c-1:this.end-c,this.read!=this.write)return this.bitb=n,this.bitk=r,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=c,this.inflate_flush(t,e);mode=12;case 8:return e=p,this.bitb=n,this.bitk=r,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=c,this.inflate_flush(t,e);case 9:return e=-3,this.bitb=n,this.bitk=r,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=c,this.inflate_flush(t,e);default:return e=-2,this.bitb=n,this.bitk=r,t.avail_in=l,t.total_in+=s-t.next_in_index,t.next_in_index=s,this.write=c,this.inflate_flush(t,e)}},i.prototype.free=function(t){this.reset(t,null),this.window=null,this.hufts=null},i.prototype.set_dictionary=function(t,e,i){o(t,e,window,0,i),this.read=this.write=i},i.prototype.sync_point=function(){return 1==this.mode},i.prototype.inflate_flush=function(t,e){var i,n,r;return n=t.next_out_index,r=this.read,i=(r<=this.write?this.write:this.end)-r,i>t.avail_out&&(i=t.avail_out),0!=i&&e==_&&(e=f),t.avail_out-=i,t.total_out+=i,null!=this.checkfn&&(t.adler=this.check=t._adler.adler32(this.check,this.window,r,i)),o(this.window,r,t.next_out,n,i),n+=i,r+=i,r==this.end&&(r=0,this.write==this.end&&(this.write=0),i=this.write-r,i>t.avail_out&&(i=t.avail_out),0!=i&&e==_&&(e=f),t.avail_out-=i,t.total_out+=i,null!=this.checkfn&&(t.adler=this.check=t._adler.adler32(this.check,this.window,r,i)),o(this.window,r,t.next_out,n,i),n+=i,r+=i),t.next_out_index=n,this.read=r,e};n.prototype.init=function(t,e,i,n,r,a,o){this.mode=0,this.lbits=t,this.dbits=e,this.ltree=i,this.ltree_index=n,this.dtree=r,this.dtree_index=a,this.tree=null},n.prototype.proc=function(t,e,i){var n,r,a,o,s,l,c,u=0,d=0,h=0;for(h=e.next_in_index,o=e.avail_in,u=t.bitb,d=t.bitk,s=t.write,l=s<t.read?t.read-s-1:t.end-s;;)switch(this.mode){case 0:if(l>=258&&o>=10&&(t.bitb=u,t.bitk=d,e.avail_in=o,e.total_in+=h-e.next_in_index,e.next_in_index=h,t.write=s,i=this.inflate_fast(this.lbits,this.dbits,this.ltree,this.ltree_index,this.dtree,this.dtree_index,t,e),h=e.next_in_index,o=e.avail_in,u=t.bitb,d=t.bitk,s=t.write,l=s<t.read?t.read-s-1:t.end-s,i!=f)){this.mode=i==p?7:9;break}this.need=this.lbits,this.tree=this.ltree,this.tree_index=this.ltree_index,this.mode=1;case 1:for(n=this.need;d<n;){if(0==o)return t.bitb=u,t.bitk=d,e.avail_in=o,e.total_in+=h-e.next_in_index,e.next_in_index=h,t.write=s,t.inflate_flush(e,i);i=f,o--,u|=(255&e.next_in[h++])<<d,d+=8}if(r=3*(this.tree_index+(u&m[n])),u>>>=this.tree[r+1],d-=this.tree[r+1],0==(a=this.tree[r])){this.lit=this.tree[r+2],this.mode=6;break}if(0!=(16&a)){this.get=15&a,this.len=this.tree[r+2],this.mode=2;break}if(0==(64&a)){this.need=a,this.tree_index=r/3+this.tree[r+2];break}if(0!=(32&a)){this.mode=7;break}return this.mode=9,e.msg="invalid literal/length code",i=-3,t.bitb=u,t.bitk=d,e.avail_in=o,e.total_in+=h-e.next_in_index,e.next_in_index=h,t.write=s,t.inflate_flush(e,i);case 2:for(n=this.get;d<n;){if(0==o)return t.bitb=u,t.bitk=d,e.avail_in=o,e.total_in+=h-e.next_in_index,e.next_in_index=h,t.write=s,t.inflate_flush(e,i);i=f,o--,u|=(255&e.next_in[h++])<<d,d+=8}this.len+=u&m[n],u>>=n,d-=n,this.need=this.dbits,this.tree=this.dtree,this.tree_index=this.dtree_index,this.mode=3;case 3:for(n=this.need;d<n;){if(0==o)return t.bitb=u,t.bitk=d,e.avail_in=o,e.total_in+=h-e.next_in_index,e.next_in_index=h,t.write=s,t.inflate_flush(e,i);i=f,o--,u|=(255&e.next_in[h++])<<d,d+=8}if(r=3*(this.tree_index+(u&m[n])),u>>=this.tree[r+1],d-=this.tree[r+1],0!=(16&(a=this.tree[r]))){this.get=15&a,this.dist=this.tree[r+2],this.mode=4;break}if(0==(64&a)){this.need=a,this.tree_index=r/3+this.tree[r+2];break}return this.mode=9,e.msg="invalid distance code",i=-3,t.bitb=u,t.bitk=d,e.avail_in=o,e.total_in+=h-e.next_in_index,e.next_in_index=h,t.write=s,t.inflate_flush(e,i);case 4:for(n=this.get;d<n;){if(0==o)return t.bitb=u,t.bitk=d,e.avail_in=o,e.total_in+=h-e.next_in_index,e.next_in_index=h,t.write=s,t.inflate_flush(e,i);i=f,o--,u|=(255&e.next_in[h++])<<d,d+=8}this.dist+=u&m[n],u>>=n,d-=n,this.mode=5;case 5:for(c=s-this.dist;c<0;)c+=t.end;for(;0!=this.len;){if(0==l&&(s==t.end&&0!=t.read&&(s=0,l=s<t.read?t.read-s-1:t.end-s),0==l&&(t.write=s,i=t.inflate_flush(e,i),s=t.write,l=s<t.read?t.read-s-1:t.end-s,s==t.end&&0!=t.read&&(s=0,l=s<t.read?t.read-s-1:t.end-s),0==l)))return t.bitb=u,t.bitk=d,e.avail_in=o,e.total_in+=h-e.next_in_index,e.next_in_index=h,t.write=s,t.inflate_flush(e,i);t.window[s++]=t.window[c++],l--,c==t.end&&(c=0),this.len--}this.mode=0;break;case 6:if(0==l&&(s==t.end&&0!=t.read&&(s=0,l=s<t.read?t.read-s-1:t.end-s),0==l&&(t.write=s,i=t.inflate_flush(e,i),s=t.write,l=s<t.read?t.read-s-1:t.end-s,s==t.end&&0!=t.read&&(s=0,l=s<t.read?t.read-s-1:t.end-s),0==l)))return t.bitb=u,t.bitk=d,e.avail_in=o,e.total_in+=h-e.next_in_index,e.next_in_index=h,t.write=s,t.inflate_flush(e,i);i=f,t.window[s++]=this.lit,l--,this.mode=0;break;case 7:if(d>7&&(d-=8,o++,h--),t.write=s,i=t.inflate_flush(e,i),s=t.write,l=s<t.read?t.read-s-1:t.end-s,t.read!=t.write)return t.bitb=u,t.bitk=d,e.avail_in=o,e.total_in+=h-e.next_in_index,e.next_in_index=h,t.write=s,t.inflate_flush(e,i);this.mode=8;case 8:return i=p,t.bitb=u,t.bitk=d,e.avail_in=o,e.total_in+=h-e.next_in_index,e.next_in_index=h,t.write=s,t.inflate_flush(e,i);case 9:return i=-3,t.bitb=u,t.bitk=d,e.avail_in=o,e.total_in+=h-e.next_in_index,e.next_in_index=h,t.write=s,t.inflate_flush(e,i);default:return i=-2,t.bitb=u,t.bitk=d,e.avail_in=o,e.total_in+=h-e.next_in_index,e.next_in_index=h,t.write=s,t.inflate_flush(e,i)}},n.prototype.free=function(t){},n.prototype.inflate_fast=function(t,e,i,n,r,a,s,l){var c,u,d,h,_,g,v,w,y,b,x,k,C,S,T,M;v=l.next_in_index,w=l.avail_in,_=s.bitb,g=s.bitk,y=s.write,b=y<s.read?s.read-y-1:s.end-y,x=m[t],k=m[e];do{for(;g<20;)w--,_|=(255&l.next_in[v++])<<g,g+=8;if(c=_&x,u=i,d=n,M=3*(d+c),0!=(h=u[M]))for(;;){if(_>>=u[M+1],g-=u[M+1],0!=(16&h)){for(h&=15,C=u[M+2]+(_&m[h]),_>>=h,g-=h;g<15;)w--,_|=(255&l.next_in[v++])<<g,g+=8;for(c=_&k,u=r,d=a,M=3*(d+c),h=u[M];;){if(_>>=u[M+1],g-=u[M+1],0!=(16&h)){for(h&=15;g<h;)w--,_|=(255&l.next_in[v++])<<g,g+=8;if(S=u[M+2]+(_&m[h]),_>>=h,g-=h,b-=C,y>=S)T=y-S,s.window[y++]=s.window[T++],s.window[y++]=s.window[T++],C-=2;else{T=y-S;do{T+=s.end}while(T<0);if(h=s.end-T,C>h){if(C-=h,y-T>0&&h>y-T)do{s.window[y++]=s.window[T++]}while(0!=--h);else o(s.window,T,s.window,y,h),y+=h,T+=h,h=0;T=0}}do{s.window[y++]=s.window[T++]}while(0!=--C);break}if(0!=(64&h))return l.msg="invalid distance code",C=l.avail_in-w,C=g>>3<C?g>>3:C,w+=C,v-=C,g-=C<<3,s.bitb=_,s.bitk=g,l.avail_in=w,l.total_in+=v-l.next_in_index,l.next_in_index=v,s.write=y,-3;c+=u[M+2],c+=_&m[h],M=3*(d+c),h=u[M]}break}if(0!=(64&h))return 0!=(32&h)?(C=l.avail_in-w,C=g>>3<C?g>>3:C,w+=C,v-=C,g-=C<<3,s.bitb=_,s.bitk=g,l.avail_in=w,l.total_in+=v-l.next_in_index,l.next_in_index=v,s.write=y,p):(l.msg="invalid literal/length code",C=l.avail_in-w,C=g>>3<C?g>>3:C,w+=C,v-=C,g-=C<<3,s.bitb=_,s.bitk=g,l.avail_in=w,l.total_in+=v-l.next_in_index,l.next_in_index=v,s.write=y,-3);if(c+=u[M+2],c+=_&m[h],M=3*(d+c),0==(h=u[M])){_>>=u[M+1],g-=u[M+1],s.window[y++]=u[M+2],b--;break}}else _>>=u[M+1],g-=u[M+1],s.window[y++]=u[M+2],b--}while(b>=258&&w>=10);return C=l.avail_in-w,C=g>>3<C?g>>3:C,w+=C,v-=C,g-=C<<3,s.bitb=_,s.bitk=g,l.avail_in=w,l.total_in+=v-l.next_in_index,l.next_in_index=v,s.write=y,f},r.prototype.huft_build=function(t,e,i,n,r,a,s,l,c,u,h){var p,m,g,v,w,y,b,x,k,C,S,T,M,O,A;C=0,w=i;do{this.c[t[e+C]]++,C++,w--}while(0!=w);if(this.c[0]==i)return s[0]=-1,l[0]=0,f;for(x=l[0],y=1;y<=15&&0==this.c[y];y++);for(b=y,x<y&&(x=y),w=15;0!=w&&0==this.c[w];w--);for(g=w,x>w&&(x=w),l[0]=x,O=1<<y;y<w;y++,O<<=1)if((O-=this.c[y])<0)return-3;if((O-=this.c[w])<0)return-3;for(this.c[w]+=O,this.x[1]=y=0,C=1,M=2;0!=--w;)this.x[M]=y+=this.c[C],M++,C++;w=0,C=0;do{0!=(y=t[e+C])&&(this.v[this.x[y]++]=w),C++}while(++w<i);for(i=this.x[g],this.x[0]=w=0,C=0,v=-1,T=-x,this.u[0]=0,S=0,A=0;b<=g;b++)for(p=this.c[b];0!=p--;){for(;b>T+x;){if(v++,T+=x,A=g-T,A=A>x?x:A,(m=1<<(y=b-T))>p+1&&(m-=p+1,M=b,y<A))for(;++y<A&&!((m<<=1)<=this.c[++M]);)m-=this.c[M];if(A=1<<y,this.hn[0]+A>d)return-3;this.u[v]=S=this.hn[0],this.hn[0]+=A,0!=v?(this.x[v]=w,this.r[0]=y,this.r[1]=x,y=w>>>T-x,this.r[2]=S-this.u[v-1]-y,o(this.r,0,c,3*(this.u[v-1]+y),3)):s[0]=S}for(this.r[1]=b-T,C>=i?this.r[0]=192:h[C]<n?(this.r[0]=this.v[C]<256?0:96,this.r[2]=this.v[C++]):(this.r[0]=a[this.v[C]-n]+16+64,this.r[2]=r[this.v[C++]-n]),m=1<<b-T,y=w>>>T;y<A;y+=m)o(this.r,0,c,3*(S+y),3);for(y=1<<b-1;0!=(w&y);y>>>=1)w^=y;for(w^=y,k=(1<<T)-1;(w&k)!=this.x[v];)v--,T-=x,k=(1<<T)-1}return 0!=O&&1!=g?_:f},r.prototype.inflate_trees_bits=function(t,e,i,n,r){var a;return this.initWorkArea(19),this.hn[0]=0,a=this.huft_build(t,0,19,19,null,null,i,e,n,this.hn,this.v),-3==a?r.msg="oversubscribed dynamic bit lengths tree":a!=_&&0!=e[0]||(r.msg="incomplete dynamic bit lengths tree",a=-3),a},r.prototype.inflate_trees_dynamic=function(t,e,i,n,r,a,o,s,l){var c;return this.initWorkArea(288),this.hn[0]=0,(c=this.huft_build(i,0,t,257,x,k,a,n,s,this.hn,this.v))!=f||0==n[0]?(-3==c?l.msg="oversubscribed literal/length tree":-4!=c&&(l.msg="incomplete literal/length tree",c=-3),c):(this.initWorkArea(288),c=this.huft_build(i,t,e,0,C,S,o,r,s,this.hn,this.v),c!=f||0==r[0]&&t>257?(-3==c?l.msg="oversubscribed distance tree":c==_?(l.msg="incomplete distance tree",c=-3):-4!=c&&(l.msg="empty distance tree with lengths",c=-3),c):f)},r.prototype.initWorkArea=function(t){null==this.hn&&(this.hn=new Int32Array(1),this.v=new Int32Array(t),this.c=new Int32Array(16),this.r=new Int32Array(3),this.u=new Int32Array(15),this.x=new Int32Array(16)),this.v.length<t&&(this.v=new Int32Array(t));for(var e=0;e<t;e++)this.v[e]=0;for(var e=0;e<16;e++)this.c[e]=0;for(var e=0;e<3;e++)this.r[e]=0;o(this.c,0,this.u,0,15),o(this.c,0,this.x,0,16)};var O=new Uint8Array(1),A="function"==typeof O.subarray;return{inflateBuffer:c,arrayCopy:o}}.apply(e,n))&&(t.exports=r)},function(t,e,i){(function(n){var r,a,o;!function(n,s){a=[i(0)],r=s,void 0!==(o="function"==typeof r?r.apply(e,a):r)&&(t.exports=o)}(0,function(t){var e=t.ajaxSettings;e.responseFields.native="responseNative",e.converters["* native"]=!0;var i={},r=0,a={0:200,1223:204},o={},s=n.ajaxSettings.xhr();window.ActiveXObject&&t(window).on("unload",function(){for(var t in o)o[t]()}),i.cors=!!s&&"withCredentials"in s,i.ajax=s=!!s,t.ajaxTransport("native",function(t){var e;if(i.cors||s&&!t.crossDomain)return{send:function(i,n){var s,l=t.xhr(),c=++r,u={};if(l.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(s in t.xhrFields)l[s]=t.xhrFields[s];t.mimeType&&l.overrideMimeType&&l.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(s in i)l.setRequestHeader(s,i[s]);e=function(t){return function(){e&&(delete o[c],e=l.onload=l.onerror=null,"abort"===t?l.abort():"error"===t?n(l.status,l.statusText):(l.response&&(u.native=l.response),n(a[l.status]||l.status,l.statusText,u,l.getAllResponseHeaders())))}},l.onload=e(),l.onerror=e("error"),e=o[c]=e("abort");try{l.send(t.hasContent&&t.data||null)}catch(t){if(e)throw t}},abort:function(){e&&e()}}}),t.getNative=function(e,i){return t.ajax({dataType:"native",url:e,xhrFields:{responseType:"arraybuffer"},success:i})}})}).call(e,i(0))},function(t,e,i){"use strict";(function(t,n,r){function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(5),s=a(o),l=i(3),c=a(l),u=t.View.extend(s.default.LoggableMixin).extend({_logNamespace:"user",options:{warnAtPercent:85,errorAtPercent:100},initialize:function(t){this.log(this+".initialize:",t),n.extend(this.options,t),this.listenTo(this.model,"change:quota_percent change:total_disk_usage",this.render)},update:function(t){return this.log(this+" updating user data...",t),this.model.loadFromApi(this.model.get("id"),t),this},isOverQuota:function(){return null!==this.model.get("quota_percent")&&this.model.get("quota_percent")>=this.options.errorAtPercent},_render_quota:function(){var t=this.model.toJSON(),e=t.quota_percent,i=r(this._templateQuotaMeter(t)),n=i.find(".progress-bar");return this.isOverQuota()?(n.attr("class","progress-bar progress-bar-danger"),i.find(".quota-meter-text").css("color","white"),this.trigger("quota:over",t)):e>=this.options.warnAtPercent?(n.attr("class","progress-bar progress-bar-warning"),this.trigger("quota:under quota:under:approaching",t)):(n.attr("class","progress-bar progress-bar-success"),this.trigger("quota:under quota:under:ok",t)),i},_render_usage:function(){var t=r(this._templateUsage(this.model.toJSON()));return this.log(this+".rendering usage:",t),t},render:function(){var t=null;return this.log(this+".model.quota_percent:",this.model.get("quota_percent")),t=null===this.model.get("quota_percent")||void 0===this.model.get("quota_percent")?this._render_usage():this._render_quota(),this.$el.html(t),this.$el.find(".quota-meter-text").tooltip(),this},_templateQuotaMeter:function(t){return['<div id="quota-meter" class="quota-meter progress">','<div class="progress-bar" style="width: ',t.quota_percent,'%"></div>','<div class="quota-meter-text" data-placement="left" style="top: 6px"',t.nice_total_disk_usage?' title="Using '+t.nice_total_disk_usage+'.  This value is recalculated when you log out.">':">",(0,c.default)("Using")," ",t.quota_percent,"%","</div>","</div>"].join("")},_templateUsage:function(t){return['<div id="quota-meter" class="quota-meter" style="background-color: transparent">','<div class="quota-meter-text" data-placement="left" data-original-title="This value is recalculated when you log out." style="top: 6px; color: white">',t.nice_total_disk_usage?(0,c.default)("Using ")+t.nice_total_disk_usage:"","</div>","</div>"].join("")},toString:function(){return"UserQuotaMeter("+this.model+")"}});e.default={UserQuotaMeter:u}}).call(e,i(2),i(1),i(0))},,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,i){"use strict";(function(t,n,r){function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(67),s=a(o),l=i(177),c=a(l),u=i(12),d=a(u),h=i(4),f=a(h),p=t.View.extend({el:"body",className:"full-content",_panelids:["left","right"],initialize:function(e){var i=this;this.config=n.defaults(e.config||{},{message_box_visible:!1,message_box_content:"",message_box_class:"info",show_inactivity_warning:!1,inactivity_box_content:""}),Galaxy.modal=this.modal=new d.default.View,Galaxy.display=this.display=function(t){t.title?(f.default.setWindowTitle(t.title),t.allow_title_display=!1):(f.default.setWindowTitle(),t.allow_title_display=!0),i.center.display(t)},Galaxy.router=this.router=e.Router&&new e.Router(i,e),this.masthead=new s.default.View(this.config),this.center=new c.default.CenterPanel,this.$el.attr("scroll","no"),this.$el.html(this._template()),this.$("#masthead").replaceWith(this.masthead.$el),this.$("#center").append(this.center.$el),this.$el.append(this.masthead.frame.$el),this.$el.append(this.modal.$el),this.$messagebox=this.$("#messagebox"),this.$inactivebox=this.$("#inactivebox"),this.panels={},n.each(this._panelids,function(t){var n=t.charAt(0).toUpperCase()+t.slice(1),r=e[n];if(r){var a=new r(i,e);i[a.toString()]=a,i.panels[t]=new c.default.SidePanel({id:t,el:i.$("#"+t),view:a})}}),this.render(),this.router&&t.history.start({root:Galaxy.root,pushState:!0})},render:function(){return r(".select2-hidden-accessible").remove(),this.masthead.render(),this.renderMessageBox(),this.renderInactivityBox(),this.renderPanels(),this._checkCommunicationServerOnline(),this},renderMessageBox:function(){if(this.config.message_box_visible){var t=this.config.message_box_content||"",e=this.config.message_box_class||"info";this.$el.addClass("has-message-box"),this.$messagebox.attr("class","panel-"+e+"-message").html(t).toggle(!!t).show()}else this.$el.removeClass("has-message-box"),this.$messagebox.hide();return this},renderInactivityBox:function(){if(this.config.show_inactivity_warning){var t=this.config.inactivity_box_content||"",e=r("<a/>").attr("href",Galaxy.root+"user/resend_verification").text("Resend verification");this.$el.addClass("has-inactivity-box"),this.$inactivebox.html(t+" ").append(e).toggle(!!t).show()}else this.$el.removeClass("has-inactivity-box"),this.$inactivebox.hide();return this},renderPanels:function(){var t=this;return n.each(this._panelids,function(e){var i=t.panels[e];i?i.render():(t.$("#center").css(e,0),t.$("#"+e).hide())}),this},_template:function(){return['<div id="everything">','<div id="background"/>','<div id="masthead"/>','<div id="messagebox"/>','<div id="inactivebox" class="panel-warning-message" />','<div id="left" />','<div id="center" />','<div id="right" />',"</div>",'<div id="dd-helper" />'].join("")},toString:function(){return"PageLayoutView"},_checkCommunicationServerOnline:function(){var t=window.Galaxy.config.communication_server_host,e=window.Galaxy.config.communication_server_port,i=window.Galaxy.user.attributes.preferences,n=r("#show-chat-online");i&&-1!=["1","true"].indexOf(i.communication_server)?r.ajax({url:t+":"+e}).success(function(t){null!==window.Galaxy.user.id&&"hidden"===n.css("visibility")&&n.css("visibility","visible")}).error(function(t){n.css("visibility","hidden")}):n.css("visibility","hidden")}});e.default={View:p}}).call(e,i(2),i(1),i(0))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,i){"use strict";(function(t,e){function n(t){return t&&t.__esModule?t:{default:t}}var r=i(0),a=n(r),o=i(65),s=n(o),l=i(3),c=n(l),u=i(178),d=n(u),h=a.default;window.app=function(i,n){window.Galaxy=new s.default.GalaxyApp(i,n),Galaxy.debug("login app");var r=encodeURI(i.redirect);if(!i.show_welcome_with_login){var o=a.default.param({use_panels:"True",redirect:r});return void(window.location.href=Galaxy.root+"user/login?"+o)}var l=t.View.extend({initialize:function(e){this.page=e,this.model=new t.Model({title:(0,c.default)("Login required")}),this.setElement(this._template())},render:function(){this.page.$("#galaxy_main").prop("src",i.welcome_url)},_template:function(){return'<iframe src="'+i.root+"user/login?"+h.param({redirect:r})+'" frameborder="0" style="width: 100%; height: 100%;"/>'}});h(function(){Galaxy.page=new d.default.View(e.extend(i,{Right:l}))})}}).call(e,i(2),i(1))}],[240]);