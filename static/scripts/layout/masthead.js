define("layout/masthead",["exports","layout/menu","layout/scratchbook","mvc/user/user-quotameter"],function(a,t,e,n){"use strict";function i(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(a,"__esModule",{value:!0});var r=i(t),o=i(e),s=i(n),l=Backbone.View.extend({initialize:function(a){var t=this;this.options=a,this.setElement(this._template()),this.$navbarBrandLink=this.$(".navbar-brand-link"),this.$navbarBrandImage=this.$(".navbar-brand-image"),this.$navbarBrandTitle=this.$(".navbar-brand-title"),this.$navbarTabs=this.$(".navbar-tabs"),this.$quoteMeter=this.$(".quota-meter-container"),this.collection=new r.default.Collection,this.collection.on("add",function(a){t.$navbarTabs.append(new r.default.Tab({model:a}).render().$el)}).on("reset",function(){t.$navbarTabs.empty()}).on("dispatch",function(a){t.collection.each(function(t){a(t)})}).fetch(this.options),Galaxy.frame=this.frame=new o.default({collection:this.collection}),Galaxy.quotaMeter=this.quotaMeter=new s.default.UserQuotaMeter({model:Galaxy.user,el:this.$quoteMeter}),$(window).on("click",function(a){var t=$(a.target).closest("a[download]");1==t.length&&(0===$("iframe[id=download]").length&&$("body").append($("<iframe/>").attr("id","download").hide()),$("iframe[id=download]").attr("src",t.attr("href")),a.preventDefault())}).on("beforeunload",function(){var a="";if(t.collection.each(function(t){var e=t.get("onbeforeunload")&&t.get("onbeforeunload")();e&&(a+=e+" ")}),""!==a)return a})},render:function(){return this.$navbarBrandTitle.html("Galaxy "+(this.options.brand&&"/ "+this.options.brand||"")),this.$navbarBrandLink.attr("href",this.options.logo_url),this.$navbarBrandImage.attr("src",this.options.logo_src),this.quotaMeter.render(),this},_template:function(){return'<div id="masthead" class="navbar navbar-fixed-top navbar-inverse"><div class="navbar-header"><div class="navbar-tabs"/></div><div class="navbar-brand"><a class="navbar-brand-link"><img class="navbar-brand-image"/><span class="navbar-brand-title"/></a></div><div class="quota-meter-container"/><div class="navbar-icons"/></div>'}});a.default={View:l}});